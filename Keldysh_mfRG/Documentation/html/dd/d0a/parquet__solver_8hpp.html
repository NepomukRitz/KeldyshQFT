<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIAM-Keldysh-mfRG: parquet_solver.hpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SIAM-Keldysh-mfRG
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dd/d0a/parquet__solver_8hpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">parquet_solver.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string&gt;</code><br />
<code>#include &lt;deque&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d1/df8/master__parameters_8hpp_source.html">../parameters/master_parameters.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/dd1/flow__grid_8hpp_source.html">../grids/flow_grid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/d3b/state_8hpp_source.html">../correlation_functions/state.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d2d/vertex_8hpp_source.html">../correlation_functions/four_point/vertex.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d2d/selfenergy_8hpp_source.html">../correlation_functions/two_point/selfenergy.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/de4/hdf5__routines_8hpp_source.html">../utilities/hdf5_routines.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/de8/bubble__function_8hpp_source.html">../bubble/bubble_function.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d1d/loop_8hpp_source.html">../loop/loop.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d75/causality__FDT__checks_8hpp_source.html">../postprocessing/causality_FDT_checks.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d0d/perturbation__theory_8hpp_source.html">perturbation_theory.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d7b/anderson__acceleration_8hpp_source.html">../utilities/anderson_acceleration.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d3f/sanity__check_8hpp_source.html">../postprocessing/sanity_check.hpp</a>&quot;</code><br />
</div>
<p><a href="../../dd/d0a/parquet__solver_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1541a0b7d193f70577c5fab1efc216e1" id="r_a1541a0b7d193f70577c5fab1efc216e1"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a1541a0b7d193f70577c5fab1efc216e1"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a1541a0b7d193f70577c5fab1efc216e1">compute_BSE</a> (<a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE</a>, <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a>, <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda)</td></tr>
<tr class="separator:a1541a0b7d193f70577c5fab1efc216e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f702e04f1c5d26a95211570c003781" id="r_a97f702e04f1c5d26a95211570c003781"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a97f702e04f1c5d26a95211570c003781"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a97f702e04f1c5d26a95211570c003781">compute_BSE</a> (<a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">it_Lambda</a>)</td></tr>
<tr class="separator:a97f702e04f1c5d26a95211570c003781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a17567ec5d9df767870c3a7489f64a1" id="r_a1a17567ec5d9df767870c3a7489f64a1"><td class="memTemplParams" colspan="2">template&lt;char channel, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a1a17567ec5d9df767870c3a7489f64a1"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a1a17567ec5d9df767870c3a7489f64a1">compute_SDE_impl</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;Gamma, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_loop</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="separator:a1a17567ec5d9df767870c3a7489f64a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a975283a2a8d88b37c80ee3d2f39e68c3" id="r_a975283a2a8d88b37c80ee3d2f39e68c3"><td class="memTemplParams" colspan="2">template&lt;char channel, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a975283a2a8d88b37c80ee3d2f39e68c3"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a975283a2a8d88b37c80ee3d2f39e68c3">compute_SDE_impl_v1</a> (<a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="separator:a975283a2a8d88b37c80ee3d2f39e68c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e421b1e2c3e3c8fbaa9fe1600a2ef54" id="r_a7e421b1e2c3e3c8fbaa9fe1600a2ef54"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a7e421b1e2c3e3c8fbaa9fe1600a2ef54"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a7e421b1e2c3e3c8fbaa9fe1600a2ef54">compute_SDE_v1</a> (<a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="separator:a7e421b1e2c3e3c8fbaa9fe1600a2ef54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe5b9519474c166967ed13d6791538b9" id="r_afe5b9519474c166967ed13d6791538b9"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:afe5b9519474c166967ed13d6791538b9"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#afe5b9519474c166967ed13d6791538b9">compute_SDE_impl_v2</a> (<a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a>, <a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="separator:afe5b9519474c166967ed13d6791538b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ab14a76538cdb69001c01f9ebf492ca" id="r_a5ab14a76538cdb69001c01f9ebf492ca"><td class="memTemplParams" colspan="2">template&lt;char channel, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a5ab14a76538cdb69001c01f9ebf492ca"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a5ab14a76538cdb69001c01f9ebf492ca">check_selfconsistency_of_K1K2</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;Gamma, double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="separator:a5ab14a76538cdb69001c01f9ebf492ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a947824a1a735bc2e9db735348ac9dd2c" id="r_a947824a1a735bc2e9db735348ac9dd2c"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../d9/db9/classbool.html">bool</a> version, <a class="el" href="../../d9/db9/classbool.html">bool</a> is_differentiated_vertex, <a class="el" href="../../d9/db9/classbool.html">bool</a> is_differentiated_SE, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a947824a1a735bc2e9db735348ac9dd2c"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a947824a1a735bc2e9db735348ac9dd2c">compute_SDE_impl_v3</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> char channel, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_differentiated_vertex</a> &gt; &amp;Gamma, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_loop</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="memdesc:a947824a1a735bc2e9db735348ac9dd2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the SDE by closing the loop over K1a+K2a or K1p+K2p.  <br /></td></tr>
<tr class="separator:a947824a1a735bc2e9db735348ac9dd2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac50fa9495cb7f051e0b03aefd35993c4" id="r_ac50fa9495cb7f051e0b03aefd35993c4"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:ac50fa9495cb7f051e0b03aefd35993c4"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ac50fa9495cb7f051e0b03aefd35993c4">compute_SDE_v3</a> (<a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="separator:ac50fa9495cb7f051e0b03aefd35993c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa738db4c50d72d9475911cf0dfce2bad" id="r_aa738db4c50d72d9475911cf0dfce2bad"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:aa738db4c50d72d9475911cf0dfce2bad"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aa738db4c50d72d9475911cf0dfce2bad">compute_SDE_v2</a> (<a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="separator:aa738db4c50d72d9475911cf0dfce2bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ef507c1d49fff7991752cab04374824" id="r_a9ef507c1d49fff7991752cab04374824"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a9ef507c1d49fff7991752cab04374824"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a9ef507c1d49fff7991752cab04374824">compute_SDE</a> (<a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, int <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a>)</td></tr>
<tr class="separator:a9ef507c1d49fff7991752cab04374824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9258c4214b31ccef74aad6764dc4db5" id="r_ad9258c4214b31ccef74aad6764dc4db5"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:ad9258c4214b31ccef74aad6764dc4db5"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ad9258c4214b31ccef74aad6764dc4db5">compute_diff_SDE</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">true</a> &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dGamma</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dSigma</a>)</td></tr>
<tr class="separator:ad9258c4214b31ccef74aad6764dc4db5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997236aea73d9935839d4dc8c8fd06af" id="r_a997236aea73d9935839d4dc8c8fd06af"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a997236aea73d9935839d4dc8c8fd06af"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a997236aea73d9935839d4dc8c8fd06af">susceptibilities_postprocessing</a> (<a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi</a>, <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_diff</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config)</td></tr>
<tr class="separator:a997236aea73d9935839d4dc8c8fd06af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f8b92dc55360683f0e90bad965195a8" id="r_a7f8b92dc55360683f0e90bad965195a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f8b92dc55360683f0e90bad965195a8">parquet_checks</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> std::string filename)</td></tr>
<tr class="separator:a7f8b92dc55360683f0e90bad965195a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad1680ae03adc0f566df945376e95234" id="r_aad1680ae03adc0f566df945376e95234"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:aad1680ae03adc0f566df945376e95234"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aad1680ae03adc0f566df945376e95234">parquet_iteration</a> (<a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">it_Lambda</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a>)</td></tr>
<tr class="separator:aad1680ae03adc0f566df945376e95234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07f441b6693f6e2e8d958049ae06cb73" id="r_a07f441b6693f6e2e8d958049ae06cb73"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </td></tr>
<tr class="memitem:a07f441b6693f6e2e8d958049ae06cb73"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a07f441b6693f6e2e8d958049ae06cb73">parquet_solver</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> std::string filename, <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double Lambda, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">accuracy</a>=1e-6, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int Nmax=6, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d9/db9/classbool.html">bool</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">overwrite_old_results</a>=<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">true</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_ratio</a>=1.0, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d9/db9/classbool.html">bool</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">use_last_state_anyway</a>=<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a>)</td></tr>
<tr class="separator:a07f441b6693f6e2e8d958049ae06cb73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa85025687bc343bc18b36d929a335ef4" id="r_aa85025687bc343bc18b36d929a335ef4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa85025687bc343bc18b36d929a335ef4">run_parquet</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;config, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> std::vector&lt; double &gt; &amp;, int <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a>, <a class="el" href="../../d9/db9/classbool.html">bool</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">overwrite_old_results</a>)</td></tr>
<tr class="separator:aa85025687bc343bc18b36d929a335ef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ade72d4c0a25548ba8cb4c0dcd8950b65" id="r_ade72d4c0a25548ba8cb4c0dcd8950b65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ade72d4c0a25548ba8cb4c0dcd8950b65">SDE_counter</a> = 0</td></tr>
<tr class="separator:ade72d4c0a25548ba8cb4c0dcd8950b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a5ab14a76538cdb69001c01f9ebf492ca" name="a5ab14a76538cdb69001c01f9ebf492ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ab14a76538cdb69001c01f9ebf492ca">&#9670;&#160;</a></span>check_selfconsistency_of_K1K2()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;char channel, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> check_selfconsistency_of_K1K2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Gamma</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt;</td>          <td class="paramname"><span class="paramname"><em>G_bubble</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>is bubble_l.K1+K2_r identical to Gamma.K1+K2_r ?</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00346">346</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  346</span>                                                                                                                                        {</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a> (Lambda, config);                  <span class="comment">// bare vertex</span></div>
<div class="line"><span class="lineno">  349</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  350</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#afab5195e3ffff420d211040e5672fcbe">KELDYSH</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">not</a> <a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a209c004ba9b216412cae0ca89758f1a9">CONTOUR_BASIS</a>) <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>.initialize(-config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#ad9afaf64e087c69bc4f16e49c132b592">U</a> / 2.);         <span class="comment">// initialize bare vertex (Keldysh)</span></div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">else</span>         <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>.initialize(-config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#ad9afaf64e087c69bc4f16e49c132b592">U</a>);              <span class="comment">// initialize bare vertex (Matsubara)</span></div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">// compute the r bubble with full vertex on the left</span></div>
<div class="line"><span class="lineno">  354</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_r_irred,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  355</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a>.set_Ir(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  356</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  357</span>    <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, channel, <span class="keyword">false</span>, config);  <span class="comment">// full vertex on the left</span></div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (channel == <span class="charliteral">&#39;t&#39;</span>) {</div>
<div class="line"><span class="lineno">  359</span>        Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a5d8cc30ab164e0d65f110c36c64f8974">swap_vanishing_component_channel_a_and_t</a>();</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_r_irred,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a> (Lambda);</div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>.set_Ir(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  363</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  364</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <span class="charliteral">&#39;a&#39;</span>, <span class="keyword">false</span>, config);  <span class="comment">// full vertex on the left</span></div>
<div class="line"><span class="lineno">  365</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a> += <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>;</div>
<div class="line"><span class="lineno">  366</span>    }</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  369</span>    <span class="comment">//utils::print(&quot;For channel r = &quot;, channel, &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  370</span>    <span class="comment">//utils::print(&quot;difference in bubble_l.K1r and Gamma.K1r: \t&quot;, (bubble_l.get_rvertex(channel).K1 - Gamma.get_rvertex(channel).K1).get_vec().max_norm() / Gamma.get_rvertex(channel).K1.get_vec().max_norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  371</span>    <span class="comment">//utils::print(&quot;difference in bubble_l.K2r and Gamma.K2r: \t&quot;, (bubble_l.get_rvertex(channel).K2 - Gamma.get_rvertex(channel).K2).get_vec().max_norm() / Gamma.get_rvertex(channel).K2.get_vec().max_norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>}</div>
<div class="ttc" id="abubble__corrections_8hpp_html_aff27784f97591f505f77ff0065ab57af"><div class="ttname"><a href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">correctionFunctionBubble_REG3_Matsubara_PHS_diff</a></div><div class="ttdeci">auto correctionFunctionBubble_REG3_Matsubara_PHS_diff(double w, double vmax, double Lambda, const double Delta)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">bubble_corrections.hpp:295</a></div></div>
<div class="ttc" id="abubble__function_8hpp_html_af33e47ff22bc507b4226169779a87c95"><div class="ttname"><a href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a></div><div class="ttdeci">void bubble_function(vertexType_result &amp;dgamma, const vertexType_left &amp;vertex1, const vertexType_right &amp;vertex2, const Bubble_Object &amp;Pi, const char channel, const fRG_config &amp;config, const std::array&lt; bool, 3 &gt; tobecomputed={true, true, true})</div><div class="ttdef"><b>Definition</b> <a href="../../de/de8/bubble__function_8hpp_source.html#l01046">bubble_function.hpp:1046</a></div></div>
<div class="ttc" id="aclassGeneralVertex_html"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html">GeneralVertex</a></div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l00455">vertex.hpp:455</a></div></div>
<div class="ttc" id="aclassGeneralVertex_html_a5d8cc30ab164e0d65f110c36c64f8974"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#a5d8cc30ab164e0d65f110c36c64f8974">GeneralVertex::swap_vanishing_component_channel_a_and_t</a></div><div class="ttdeci">void swap_vanishing_component_channel_a_and_t() const</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l01071">vertex.hpp:1071</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_a209c004ba9b216412cae0ca89758f1a9"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#a209c004ba9b216412cae0ca89758f1a9">CONTOUR_BASIS</a></div><div class="ttdeci">#define CONTOUR_BASIS</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00020">master_parameters.hpp:20</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_afab5195e3ffff420d211040e5672fcbe"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#afab5195e3ffff420d211040e5672fcbe">KELDYSH</a></div><div class="ttdeci">constexpr bool KELDYSH</div><div class="ttdoc">Set flags used in code; DO NOT TOUCH!!!///.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00137">master_parameters.hpp:137</a></div></div>
<div class="ttc" id="astructfRG__config_html_ad9afaf64e087c69bc4f16e49c132b592"><div class="ttname"><a href="../../da/da0/structfRG__config.html#ad9afaf64e087c69bc4f16e49c132b592">fRG_config::U</a></div><div class="ttdeci">double U</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00665">data_structures.hpp:665</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/de8/bubble__function_8hpp_source.html#l01046">bubble_function()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00020">CONTOUR_BASIS</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00137">KELDYSH</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l01071">GeneralVertex&lt; Q, symmtype, differentiated &gt;::swap_vanishing_component_channel_a_and_t()</a>, and <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00665">fRG_config::U</a>.</p>

</div>
</div>
<a id="a97f702e04f1c5d26a95211570c003781" name="a97f702e04f1c5d26a95211570c003781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f702e04f1c5d26a95211570c003781">&#9670;&#160;</a></span>compute_BSE() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> compute_BSE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Gamma_BSE</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int</td>          <td class="paramname"><span class="paramname"><em>it_Lambda</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper for the above function, with only the symmetrized result Gamma_BSE returned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Gamma_BSE</td><td>: Vertex computed as the lhs of the BSE </td></tr>
    <tr><td class="paramname">state_in</td><td>: Input state for which to check the BSE </td></tr>
    <tr><td class="paramname">Lambda</td><td>: Flow parameter Lambda at which input state was computed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00073">73</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                                                                                                                 {</div>
<div class="line"><span class="lineno">   74</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a> (Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a> (Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_function" href="#a1541a0b7d193f70577c5fab1efc216e1">compute_BSE</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda);</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">write_state</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">write_state</a>) {</div>
<div class="line"><span class="lineno">   81</span>        <a class="code hl_class" href="../../d7/d97/classState.html">State&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_L</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config, Lambda);</div>
<div class="line"><span class="lineno">   82</span>        <a class="code hl_class" href="../../d7/d97/classState.html">State&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_R</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config, Lambda);</div>
<div class="line"><span class="lineno">   83</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#afcbe2c8a768f64e576f593516262d476">add_state_to_hdf</a>(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Parquet_GammaL&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">it_Lambda</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_L</a>); <span class="comment">// save input into 0-th layer of hdf5 file</span></div>
<div class="line"><span class="lineno">   84</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#afcbe2c8a768f64e576f593516262d476">add_state_to_hdf</a>(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Parquet_GammaR&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">it_Lambda</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_R</a>); <span class="comment">// save input into 0-th layer of hdf5 file</span></div>
<div class="line"><span class="lineno">   85</span>    }</div>
<div class="line"><span class="lineno">   86</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   87</span>}</div>
<div class="ttc" id="aclassState_html"><div class="ttname"><a href="../../d7/d97/classState.html">State</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d3b/state_8hpp_source.html#l00023">state.hpp:23</a></div></div>
<div class="ttc" id="ahdf5__routines_8hpp_html_afcbe2c8a768f64e576f593516262d476"><div class="ttname"><a href="../../d5/de4/hdf5__routines_8hpp.html#afcbe2c8a768f64e576f593516262d476">add_state_to_hdf</a></div><div class="ttdeci">void add_state_to_hdf(const H5std_string FILE_NAME, int Lambda_it, const State&lt; Q, diff &gt; &amp;state_in, const bool is_converged=false, const bool verbose=true)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/de4/hdf5__routines_8hpp_source.html#l00872">hdf5_routines.hpp:872</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_a1b384aea75d8da97c90c700d40dc19d2"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a></div><div class="ttdeci">std::string data_dir</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00159">master_parameters.hpp:159</a></div></div>
<div class="ttc" id="aparquet__solver_8hpp_html_a1541a0b7d193f70577c5fab1efc216e1"><div class="ttname"><a href="#a1541a0b7d193f70577c5fab1efc216e1">compute_BSE</a></div><div class="ttdeci">void compute_BSE(Vertex&lt; Q, false &gt; &amp;Gamma_BSE, Vertex&lt; Q, false &gt; &amp;Gamma_BSE_L, Vertex&lt; Q, false &gt; &amp;Gamma_BSE_R, const State&lt; Q &gt; &amp;state_in, const double Lambda)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0a/parquet__solver_8hpp_source.html#l00028">parquet_solver.hpp:28</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de4/hdf5__routines_8hpp_source.html#l00872">add_state_to_hdf()</a>, <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00028">compute_BSE()</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, and <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00159">data_dir</a>.</p>

</div>
</div>
<a id="a1541a0b7d193f70577c5fab1efc216e1" name="a1541a0b7d193f70577c5fab1efc216e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1541a0b7d193f70577c5fab1efc216e1">&#9670;&#160;</a></span>compute_BSE() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> compute_BSE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Gamma_BSE</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Gamma_BSE_L</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Gamma_BSE_R</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Insert the vertex of input "state" into the rhs of the (symmetrized) Bethe-Salpeter equation and compute the lhs. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Gamma_BSE</td><td>: Vertex computed as the lhs of the BSE </td></tr>
    <tr><td class="paramname">Gamma_BSE_L</td><td>: Vertex computed as the lhs of the BSE, with Ir on the left and full Gamma on the right </td></tr>
    <tr><td class="paramname">Gamma_BSE_R</td><td>: Vertex computed as the lhs of the BSE, with Ir on the right and full Gamma on the left </td></tr>
    <tr><td class="paramname">state_in</td><td>: Input state for which to check the BSE </td></tr>
    <tr><td class="paramname">Lambda</td><td>: Flow parameter Lambda at which input state was computed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00028">28</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   29</span>                                                                {</div>
<div class="line"><span class="lineno">   30</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> Gamma = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.<a class="code hl_variable" href="../../d2/d4a/classGeneralVertex.html#a2b9b73449a3d78f260cb929b0be99977">vertex</a>;  <span class="comment">// full vertex</span></div>
<div class="line"><span class="lineno">   31</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_r_irred,false&gt;</a> Ir(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex.half1());     <span class="comment">// irreducible vertex</span></div>
<div class="line"><span class="lineno">   32</span>    Ir.set_Ir(<span class="keyword">true</span>);            <span class="comment">// (irreducible in the channel of the bubble in which it is evaluated)</span></div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_class" href="../../d2/d34/classPropagator.html">Propagator&lt;Q&gt;</a> G (Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <span class="charliteral">&#39;g&#39;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config); <span class="comment">// full propagator</span></div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>    <span class="comment">// compute the BSE by inserting I_r on the left and the full Gamma on the right</span></div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a> : <span class="stringliteral">&quot;apt&quot;</span>)</div>
<div class="line"><span class="lineno">   38</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a>, Ir, Gamma, G, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    <span class="comment">// compute the BSE by inserting the full Gamma on the left and I_r on the right</span></div>
<div class="line"><span class="lineno">   41</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a> : <span class="stringliteral">&quot;apt&quot;</span>)</div>
<div class="line"><span class="lineno">   43</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a>, Gamma, Ir, G, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a8e29bcd96e548a3249a0a93917debc8b">SBE_DECOMPOSITION</a>) {</div>
<div class="line"><span class="lineno">   46</span>        <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>: {<span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;p&#39;</span>, <span class="charliteral">&#39;t&#39;</span>}) {</div>
<div class="line"><span class="lineno">   47</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a>.get_rvertex(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>).K2 = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a>.get_rvertex(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>).K2;</div>
<div class="line"><span class="lineno">   48</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a971bae9902862f2a2e1379520ee2d2bf">DEBUG_SYMMETRIES</a>) <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a>.get_rvertex(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>).K2b= <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a>.get_rvertex(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>).K2b;</div>
<div class="line"><span class="lineno">   49</span>        }</div>
<div class="line"><span class="lineno">   50</span>    }</div>
<div class="line"><span class="lineno">   51</span>    <span class="comment">//for (char r : {&#39;a&#39;, &#39;p&#39;, &#39;t&#39;})</span></div>
<div class="line"><span class="lineno">   52</span>    <span class="comment">//    Gamma_BSE_L.get_rvertex(r).K1 = state_in.vertex.get_rvertex(r).K1;</span></div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a>) * 0.5; <span class="comment">// symmetrize the BSE</span></div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_diff</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_R</a> - <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_L</a>;</div>
<div class="line"><span class="lineno">   57</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">max_diff_K1</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_diff</a>.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a66e3aa65eda2c853832d6a3942ec69e8">norm_K1</a>(0) / <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE</a>.norm_K1(0);</div>
<div class="line"><span class="lineno">   58</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">max_diff_K2</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_diff</a>.norm_K2(0) / <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE</a>.norm_K2(0);</div>
<div class="line"><span class="lineno">   59</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">max_diff_K3</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE_diff</a>.norm_K3(0) / <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_BSE</a>.norm_K3(0);</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot; deviation between left and right bubble in BSE: \n\t K1: \t&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">max_diff_K1</a>, <span class="stringliteral">&quot;\n\t K2: \t&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">max_diff_K2</a>, <span class="stringliteral">&quot;\n\t K3: \t&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">max_diff_K3</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>}</div>
<div class="ttc" id="aclassGeneralVertex_html_a2b9b73449a3d78f260cb929b0be99977"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#a2b9b73449a3d78f260cb929b0be99977">GeneralVertex::vertex</a></div><div class="ttdeci">fullvert&lt; Q &gt; vertex</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l00456">vertex.hpp:456</a></div></div>
<div class="ttc" id="aclassGeneralVertex_html_a66e3aa65eda2c853832d6a3942ec69e8"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#a66e3aa65eda2c853832d6a3942ec69e8">GeneralVertex::norm_K1</a></div><div class="ttdeci">double norm_K1(int i)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l01014">vertex.hpp:1014</a></div></div>
<div class="ttc" id="aclassPropagator_html"><div class="ttname"><a href="../../d2/d34/classPropagator.html">Propagator</a></div><div class="ttdef"><b>Definition</b> <a href="../../d5/df7/propagator_8hpp_source.html#l00035">propagator.hpp:35</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_a8e29bcd96e548a3249a0a93917debc8b"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#a8e29bcd96e548a3249a0a93917debc8b">SBE_DECOMPOSITION</a></div><div class="ttdeci">#define SBE_DECOMPOSITION</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00035">master_parameters.hpp:35</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_a971bae9902862f2a2e1379520ee2d2bf"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#a971bae9902862f2a2e1379520ee2d2bf">DEBUG_SYMMETRIES</a></div><div class="ttdeci">#define DEBUG_SYMMETRIES</div><div class="ttdoc">0 for false; 1 for true. Performs computations without use of symmetries if true. Useful for debuggin...</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00011">master_parameters.hpp:11</a></div></div>
<div class="ttc" id="anamespaceutils_html_ad566cc1586ac4598d5823caa71620eb5"><div class="ttname"><a href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a></div><div class="ttdeci">void print(T s, bool endline)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d3f/util_8hpp_source.html#l00025">util.hpp:25</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/de8/bubble__function_8hpp_source.html#l01046">bubble_function()</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00011">DEBUG_SYMMETRIES</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l01014">GeneralVertex&lt; Q, symmtype, differentiated &gt;::norm_K1()</a>, <a class="el" href="../../d0/d3f/util_8hpp_source.html#l00025">utils::print()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00035">SBE_DECOMPOSITION</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l01029">GeneralVertex&lt; Q, symmtype, differentiated &gt;::set_Ir()</a>, and <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l00456">GeneralVertex&lt; Q, symmtype, differentiated &gt;::vertex</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00073">compute_BSE()</a>, <a class="el" href="../../d5/d94/parquet__solver_8c_09_09_source.html#l00003">parquet_checks()</a>, and <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00635">parquet_iteration()</a>.</p>

</div>
</div>
<a id="ad9258c4214b31ccef74aad6764dc4db5" name="ad9258c4214b31ccef74aad6764dc4db5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9258c4214b31ccef74aad6764dc4db5">&#9670;&#160;</a></span>compute_diff_SDE()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; compute_diff_SDE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">true</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>dGamma</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>dSigma</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00494">494</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  494</span>                                                                                                                    {</div>
<div class="line"><span class="lineno">  495</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Lambda = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.Lambda;</div>
<div class="line"><span class="lineno">  496</span>    <a class="code hl_class" href="../../d2/d34/classPropagator.html">Propagator&lt;Q&gt;</a> G(Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <span class="charliteral">&#39;g&#39;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  497</span>    <a class="code hl_class" href="../../d2/d34/classPropagator.html">Propagator&lt;Q&gt;</a><a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dG</a>(Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dSigma</a>, <span class="charliteral">&#39;k&#39;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a_1</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;0, false, true&gt;</a>(<span class="charliteral">&#39;a&#39;</span>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex,<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dG</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  500</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_1</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;0, false, true&gt;</a>(<span class="charliteral">&#39;p&#39;</span>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex,<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dG</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a_2</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;0, true, true&gt;</a>(<span class="charliteral">&#39;a&#39;</span>, Lambda,          <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dGamma</a>, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  503</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_2</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;0, true, true&gt;</a>(<span class="charliteral">&#39;p&#39;</span>, Lambda,          <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dGamma</a>, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dSigma_SDE</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a_1</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_1</a></div>
<div class="line"><span class="lineno">  506</span>                              + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a_2</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_2</a></div>
<div class="line"><span class="lineno">  507</span>                              ) * 0.5;</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  510</span>        <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_1_v2</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;1, false, true&gt;</a>(<span class="charliteral">&#39;p&#39;</span>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex,<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dG</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  511</span>        <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_t_1</a>    = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;1, false, true&gt;</a>(<span class="charliteral">&#39;t&#39;</span>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex,<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dG</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>        <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_2_v2</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;1, true, true&gt;</a>(<span class="charliteral">&#39;p&#39;</span>, Lambda,          <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dGamma</a>, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  514</span>        <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_t_2</a>    = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;1, true, true&gt;</a>(<span class="charliteral">&#39;t&#39;</span>, Lambda,          <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dGamma</a>, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>        std::string filename = <a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;diffSDE_in_different_channels.h5&quot;</span>;</div>
<div class="line"><span class="lineno">  518</span>        H5::H5File <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a> = H5::H5File(filename, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">H5F_ACC_TRUNC</a>);</div>
<div class="line"><span class="lineno">  519</span>        <a class="code hl_function" href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;Sigma_SDE_a_1&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a_1</a>.Sigma.get_vec(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  520</span>        <a class="code hl_function" href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;Sigma_SDE_p_1&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_1</a>.Sigma.get_vec(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  521</span>        <a class="code hl_function" href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;Sigma_SDE_p_1_v2&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_1_v2</a>.Sigma.get_vec(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  522</span>        <a class="code hl_function" href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;Sigma_SDE_t_1&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_t_1</a>.Sigma.get_vec(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>        <a class="code hl_function" href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;Sigma_SDE_a_2&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a_2</a>.Sigma.get_vec(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  525</span>        <a class="code hl_function" href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;Sigma_SDE_p_2&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_2</a>.Sigma.get_vec(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  526</span>        <a class="code hl_function" href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;Sigma_SDE_p_2_v2&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p_2_v2</a>.Sigma.get_vec(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  527</span>        <a class="code hl_function" href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;Sigma_SDE_t_2&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_t_2</a>.Sigma.get_vec(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>.close();</div>
<div class="line"><span class="lineno">  530</span>    }</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>    <span class="comment">//dSigma_SDE.check_symmetries();</span></div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">dSigma_SDE</a>;</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>}</div>
<div class="ttc" id="aclassSelfEnergy_html"><div class="ttname"><a href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2d/selfenergy_8hpp_source.html#l00022">selfenergy.hpp:22</a></div></div>
<div class="ttc" id="ar__vertex_8hpp_html_a2337339bdea1a060b1205e7bcba3bb20"><div class="ttname"><a href="../../d3/d22/r__vertex_8hpp.html#a2337339bdea1a060b1205e7bcba3bb20">write_to_hdf</a></div><div class="ttdeci">void write_to_hdf(H5object &amp;group, const H5std_string &amp;dataset_name, const multidimensional::multiarray&lt; Q, depth &gt; &amp;data, const bool data_set_exists)</div><div class="ttdoc">Write multiarray to HDF group/file.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/de4/hdf5__routines_8hpp_source.html#l00425">hdf5_routines.hpp:425</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00159">data_dir</a>, and <a class="el" href="../../d5/de4/hdf5__routines_8hpp_source.html#l00425">write_to_hdf()</a>.</p>

</div>
</div>
<a id="a9ef507c1d49fff7991752cab04374824" name="a9ef507c1d49fff7991752cab04374824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ef507c1d49fff7991752cab04374824">&#9670;&#160;</a></span>compute_SDE()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> compute_SDE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sigma_SDE</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>version</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pick your favorite version:</p>
<p>Compute the Hartree term</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00462">462</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  462</span>                                                                                                       {</div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a> == 1) {</div>
<div class="line"><span class="lineno">  465</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_v1&lt;Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  466</span>        <span class="comment">//SelfEnergy&lt;Q&gt; Sigma_compare = Sigma_SDE;</span></div>
<div class="line"><span class="lineno">  467</span>        <span class="comment">//compute_SDE_v3&lt;Q&gt;(Sigma_compare, state_in, Lambda, config);</span></div>
<div class="line"><span class="lineno">  468</span>        <span class="comment">//utils::print(&quot;rel. dev. bw. v1 and v3: \t&quot;, (Sigma_SDE - Sigma_compare).norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  469</span>    }</div>
<div class="line"><span class="lineno">  470</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a> == 2) {</div>
<div class="line"><span class="lineno">  471</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_v2&lt;Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  472</span>    }</div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  474</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_v3&lt;Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  475</span>    }</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">not</a> <a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#ac209459b6113297c093b5c50febc47ad">PARTICLE_HOLE_SYMMETRY</a>){    <span class="comment">// In this case, we have to update the Hartree term as well.</span></div>
<div class="line"><span class="lineno">  479</span>        <a class="code hl_class" href="../../d2/d75/classHartree__Solver.html">Hartree_Solver</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">hartree_term</a> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  480</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">hartree</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">hartree_term</a>.compute_Hartree_term_oneshot();</div>
<div class="line"><span class="lineno">  481</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>.initialize(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">hartree</a>, 0.);</div>
<div class="line"><span class="lineno">  482</span>    }</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  484</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>.initialize(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config.U / 2., 0.);</div>
<div class="line"><span class="lineno">  485</span>    }</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>    <a class="code hl_variable" href="#ade72d4c0a25548ba8cb4c0dcd8950b65">SDE_counter</a> ++;</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>}</div>
<div class="ttc" id="aclassHartree__Solver_html"><div class="ttname"><a href="../../d2/d75/classHartree__Solver.html">Hartree_Solver</a></div><div class="ttdoc">Class which determines the Hartree-term for the self-energy self-consistently in units of glb_U given...</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db3/hartree__term_8hpp_source.html#l00017">hartree_term.hpp:17</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_ac209459b6113297c093b5c50febc47ad"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#ac209459b6113297c093b5c50febc47ad">PARTICLE_HOLE_SYMMETRY</a></div><div class="ttdeci">constexpr bool PARTICLE_HOLE_SYMMETRY</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00148">master_parameters.hpp:148</a></div></div>
<div class="ttc" id="aparquet__solver_8hpp_html_ade72d4c0a25548ba8cb4c0dcd8950b65"><div class="ttname"><a href="#ade72d4c0a25548ba8cb4c0dcd8950b65">SDE_counter</a></div><div class="ttdeci">int SDE_counter</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0a/parquet__solver_8hpp_source.html#l00065">parquet_solver.hpp:65</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00148">PARTICLE_HOLE_SYMMETRY</a>, and <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00065">SDE_counter</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d94/parquet__solver_8c_09_09_source.html#l00003">parquet_checks()</a>, and <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00635">parquet_iteration()</a>.</p>

</div>
</div>
<a id="a1a17567ec5d9df767870c3a7489f64a1" name="a1a17567ec5d9df767870c3a7489f64a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a17567ec5d9df767870c3a7489f64a1">&#9670;&#160;</a></span>compute_SDE_impl()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;char channel, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; compute_SDE_impl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Gamma</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>G_bubble</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>G_loop</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>compute the (non-differentiated) SDE by forming a bubble in channel r --&gt; 0.5*(B_r(Gamma_0, Gamma)+B_r(Gamma, Gamma_0)) and close the loop over the result </p>
<p>make sure that integrand only contains K1r + K2r + K2br</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00092">92</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   92</span>                                                                                                                                                                          {</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a> (Lambda, config);                  <span class="comment">// bare vertex</span></div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#afab5195e3ffff420d211040e5672fcbe">KELDYSH</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">not</a> <a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a209c004ba9b216412cae0ca89758f1a9">CONTOUR_BASIS</a>) <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>.initialize(-config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#ad9afaf64e087c69bc4f16e49c132b592">U</a> / 2.);         <span class="comment">// initialize bare vertex (Keldysh)</span></div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">else</span>         <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>.initialize(-config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#ad9afaf64e087c69bc4f16e49c132b592">U</a>);              <span class="comment">// initialize bare vertex (Matsubara)</span></div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>    <span class="comment">// compute the r-bubble with full vertex on the right</span></div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_full,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  102</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  103</span>    <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, channel, <span class="keyword">false</span>, config);  <span class="comment">// full vertex on the right</span></div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>        <span class="comment">// compute the r bubble with full vertex on the left</span></div>
<div class="line"><span class="lineno">  108</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_full,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, channel, <span class="keyword">false</span>, config);  <span class="comment">// full vertex on the left</span></div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (channel == <span class="charliteral">&#39;t&#39;</span>) {</div>
<div class="line"><span class="lineno">  112</span>        Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a5d8cc30ab164e0d65f110c36c64f8974">swap_vanishing_component_channel_a_and_t</a>();</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_full,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r_other</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  115</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r_other</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  116</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r_other</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <span class="charliteral">&#39;a&#39;</span>, <span class="keyword">false</span>, config);  <span class="comment">// full vertex on the right</span></div>
<div class="line"><span class="lineno">  117</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r</a> += <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r_other</a>;</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_full,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  120</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  121</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <span class="charliteral">&#39;a&#39;</span>, <span class="keyword">false</span>, config);  <span class="comment">// full vertex on the left</span></div>
<div class="line"><span class="lineno">  122</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a> += <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>;</div>
<div class="line"><span class="lineno">  123</span>    }</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (channel == <span class="charliteral">&#39;a&#39;</span>) {</div>
<div class="line"><span class="lineno">  125</span>        Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a5d8cc30ab164e0d65f110c36c64f8974">swap_vanishing_component_channel_a_and_t</a>();</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_full,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r_other</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  128</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r_other</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  129</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r_other</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <span class="charliteral">&#39;t&#39;</span>, <span class="keyword">false</span>, config);  <span class="comment">// full vertex on the right</span></div>
<div class="line"><span class="lineno">  130</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r</a> += <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r_other</a>;</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_full,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  133</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  134</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>, <span class="charliteral">&#39;t&#39;</span>, <span class="keyword">false</span>, config);  <span class="comment">// full vertex on the left</span></div>
<div class="line"><span class="lineno">  135</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a> += <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l_other</a>;</div>
<div class="line"><span class="lineno">  136</span>    }</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">// if bubble_l.K1+K2_r identical to Gamma.K1+K2_r ?</span></div>
<div class="line"><span class="lineno">  139</span>    <span class="comment">//utils::print(&quot;For channel r = &quot;, channel, &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  140</span>    <span class="comment">//utils::print(&quot;difference in bubble_l.K1r and Gamma.K1r: \t&quot;, (bubble_l.get_rvertex(channel).K1 - Gamma.get_rvertex(channel).K1).get_vec().max_norm() / Gamma.get_rvertex(channel).K1.get_vec().max_norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  141</span>    <span class="comment">//utils::print(&quot;difference in bubble_l.K2r and Gamma.K2r: \t&quot;, (bubble_l.get_rvertex(channel).K2 - Gamma.get_rvertex(channel).K2).get_vec().max_norm() / Gamma.get_rvertex(channel).K2.get_vec().max_norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_full,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_r</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble_l</a>) * 0.5;  <span class="comment">// symmetrize the two versions of the a bubble</span></div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  146</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble</a>.<a class="code hl_variable" href="../../d2/d4a/classGeneralVertex.html#adb8112bdc5f8e012552d215c2a670eef">vanishing_component_gamma0</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>: {<span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;p&#39;</span>, <span class="charliteral">&#39;t&#39;</span>}) {</div>
<div class="line"><span class="lineno">  148</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2">k3_sbe</a>);</div>
<div class="line"><span class="lineno">  149</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a>);     <span class="comment">// I know, this is zero anyway.</span></div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">if</span> (channel != <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>) {</div>
<div class="line"><span class="lineno">  151</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>);</div>
<div class="line"><span class="lineno">  152</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a>);</div>
<div class="line"><span class="lineno">  153</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a>);</div>
<div class="line"><span class="lineno">  154</span>        }</div>
<div class="line"><span class="lineno">  155</span>    }</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="comment">// compute the self-energy via SDE using the bubble</span></div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_bubble</a>.selfenergy.Sigma.frequencies);</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">loop&lt;false,channel == 't' ? 1 : 0&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">bubble</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_loop</a>);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>    <span class="comment">//if (channel == &#39;a&#39;) {</span></div>
<div class="line"><span class="lineno">  162</span>    <span class="comment">//    State&lt;Q, false&gt; Psi_a_l(bubble_l, Sigma_SDE, Lambda);</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">//    State&lt;Q, false&gt; Psi_a_r(bubble_r, Sigma_SDE, Lambda);</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="comment">//    add_state_to_hdf(data_dir + &quot;Psi_SDE_a_l.h5&quot;, SDE_counter + 1, Psi_a_l, true);</span></div>
<div class="line"><span class="lineno">  165</span>    <span class="comment">//    add_state_to_hdf(data_dir + &quot;Psi_SDE_a_r.h5&quot;, SDE_counter + 1, Psi_a_r, true);</span></div>
<div class="line"><span class="lineno">  166</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  167</span>    <span class="comment">//else if (channel == &#39;p&#39;) {</span></div>
<div class="line"><span class="lineno">  168</span>    <span class="comment">//    State&lt;Q, false&gt; Psi_p_l(bubble_l, Sigma_SDE, Lambda);</span></div>
<div class="line"><span class="lineno">  169</span>    <span class="comment">//    State&lt;Q, false&gt; Psi_p_r(bubble_r, Sigma_SDE, Lambda);</span></div>
<div class="line"><span class="lineno">  170</span>    <span class="comment">//    add_state_to_hdf(data_dir + &quot;Psi_SDE_p_l.h5&quot;, SDE_counter + 1, Psi_p_l, true);</span></div>
<div class="line"><span class="lineno">  171</span>    <span class="comment">//    add_state_to_hdf(data_dir + &quot;Psi_SDE_p_r.h5&quot;, SDE_counter + 1, Psi_p_r, true);</span></div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">//utils::print(&quot;Check causality of Sigma_SDE_&quot;, channel, &quot;: \n&quot;);</span></div>
<div class="line"><span class="lineno">  174</span>    <span class="comment">//check_SE_causality(Sigma_SDE);</span></div>
<div class="line"><span class="lineno">  175</span>    <span class="comment">//compare_with_FDTs(bubble, Lambda, 0, &quot;SDE_bubble_&quot; + std::to_string(channel));</span></div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>;</div>
<div class="line"><span class="lineno">  178</span>}</div>
<div class="ttc" id="aclassGeneralVertex_html_adb8112bdc5f8e012552d215c2a670eef"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#adb8112bdc5f8e012552d215c2a670eef">GeneralVertex::vanishing_component_gamma0</a></div><div class="ttdeci">bool vanishing_component_gamma0</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l01061">vertex.hpp:1061</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2">k3_sbe</a></div><div class="ttdeci">@ k3_sbe</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a></div><div class="ttdeci">@ k3</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a></div><div class="ttdeci">@ k1</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a></div><div class="ttdeci">@ k2b</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a></div><div class="ttdeci">@ k2</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/de8/bubble__function_8hpp_source.html#l01046">bubble_function()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00020">CONTOUR_BASIS</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k1</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k2</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k2b</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k3</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k3_sbe</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00137">KELDYSH</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l01071">GeneralVertex&lt; Q, symmtype, differentiated &gt;::swap_vanishing_component_channel_a_and_t()</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00665">fRG_config::U</a>, and <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l01061">GeneralVertex&lt; Q, symmtype, differentiated &gt;::vanishing_component_gamma0</a>.</p>

</div>
</div>
<a id="a975283a2a8d88b37c80ee3d2f39e68c3" name="a975283a2a8d88b37c80ee3d2f39e68c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a975283a2a8d88b37c80ee3d2f39e68c3">&#9670;&#160;</a></span>compute_SDE_impl_v1()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;char channel, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> compute_SDE_impl_v1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sigma_SDE</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>prepare vertex  for computing 0.5 * [L_i( B_r(_0, _0 + _r) + B_r(_0 + _r, _0), G)] using compute_SDE_impl&lt;channel&gt;(...)</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00182">182</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  182</span>                                                                                                                            {</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    <a class="code hl_class" href="../../d2/d34/classPropagator.html">Propagator&lt;Q&gt;</a> G (Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <span class="charliteral">&#39;g&#39;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);   <span class="comment">// full propagator</span></div>
<div class="line"><span class="lineno">  186</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_only_Gamma0_and_gamma_r</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.<a class="code hl_variable" href="../../d2/d4a/classGeneralVertex.html#a2b9b73449a3d78f260cb929b0be99977">vertex</a>;</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>: {<span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;p&#39;</span>, <span class="charliteral">&#39;t&#39;</span>}) {</div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordflow">if</span> (channel != <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>) {</div>
<div class="line"><span class="lineno">  190</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_only_Gamma0_and_gamma_r</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>);</div>
<div class="line"><span class="lineno">  191</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_only_Gamma0_and_gamma_r</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a>);</div>
<div class="line"><span class="lineno">  192</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_only_Gamma0_and_gamma_r</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a>);</div>
<div class="line"><span class="lineno">  193</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_only_Gamma0_and_gamma_r</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a>);</div>
<div class="line"><span class="lineno">  194</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_only_Gamma0_and_gamma_r</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2">k3_sbe</a>);</div>
<div class="line"><span class="lineno">  195</span>        }</div>
<div class="line"><span class="lineno">  196</span>    }</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl&lt;channel,Q&gt;</a>(Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_only_Gamma0_and_gamma_r</a>, G, G, config);</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k1</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k2</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k2b</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k3</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k3_sbe</a>, and <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l00456">GeneralVertex&lt; Q, symmtype, differentiated &gt;::vertex</a>.</p>

</div>
</div>
<a id="afe5b9519474c166967ed13d6791538b9" name="afe5b9519474c166967ed13d6791538b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe5b9519474c166967ed13d6791538b9">&#9670;&#160;</a></span>compute_SDE_impl_v2()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> compute_SDE_impl_v2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sigma_SDE</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sigma_SDE_a</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sigma_SDE_p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Insert the self-energy of input "state" into the rhs of the (symmetrized) Schwinger-Dyson equation and compute the lhs. Original implementation of SDE corresponds to --&gt; 0.5*[compute_SDE_impl('a', ...)+compute_SDE_impl('p', ...)] </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sigma_SDE</td><td>: Self-energy computed as the lhs of the BSE </td></tr>
    <tr><td class="paramname">Sigma_SDE_a</td><td>: self-energy computed from an a bubble (symmetrized w.r.t full vertex on the left/right) </td></tr>
    <tr><td class="paramname">Sigma_SDE_p</td><td>: self-energy computed from a p bubble (symmetrized w.r.t full vertex on the left/right) </td></tr>
    <tr><td class="paramname">state_in</td><td>: Input state for which to check the SDE </td></tr>
    <tr><td class="paramname">Lambda</td><td>: Flow parameter Lambda at which input state was computed </td></tr>
  </table>
  </dd>
</dl>
<p>alternative to below code (does the same stuff in more compact code):</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00239">239</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  240</span>                                                                                          {</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">write_state</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  243</span>    <a class="code hl_class" href="../../d2/d34/classPropagator.html">Propagator&lt;Q&gt;</a> G (Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <span class="charliteral">&#39;g&#39;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);   <span class="comment">// full propagator</span></div>
<div class="line"><span class="lineno">  244</span>    <span class="comment">//Vertex&lt;Q,false&gt; Gamma_0 (Lambda);                  // bare vertex</span></div>
<div class="line"><span class="lineno">  245</span>    <span class="comment">//Gamma_0.set_frequency_grid(state_in.vertex);</span></div>
<div class="line"><span class="lineno">  246</span>    <span class="comment">//if (KELDYSH and not CONTOUR_BASIS) Gamma_0.initialize(-config.U / 2.);         // initialize bare vertex (Keldysh)</span></div>
<div class="line"><span class="lineno">  247</span>    <span class="comment">//else         Gamma_0.initialize(-config.U);              // initialize bare vertex (Matsubara)</span></div>
<div class="line"><span class="lineno">  248</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl&lt;'a',Q&gt;</a>(Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex, G, G, config);</div>
<div class="line"><span class="lineno">  249</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl&lt;'p',Q&gt;</a>(Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex, G, G, config);</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    <span class="comment">//SelfEnergy&lt;Q&gt; Sigma_SDE_t = compute_SDE_impl&lt;&#39;t&#39;,Q&gt;(Lambda, state_in.vertex, G, G);</span></div>
<div class="line"><span class="lineno">  252</span>    <span class="comment">//utils::print(&quot;deviation between a and t version: &quot;, (Sigma_SDE_a - Sigma_SDE_t).norm() / Sigma_SDE_a.norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a> = 0.5 * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>);</div>
<div class="line"><span class="lineno">  256</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  257</span><span class="comment">    Vertex&lt;Q,false&gt; Gamma_0 (Lambda);                  // bare vertex</span></div>
<div class="line"><span class="lineno">  258</span><span class="comment">    Gamma_0.set_frequency_grid(state_in.vertex);</span></div>
<div class="line"><span class="lineno">  259</span><span class="comment">    if (KELDYSH and not CONTOUR_BASIS) Gamma_0.initialize(-config.U / 2.);         // initialize bare vertex (Keldysh)</span></div>
<div class="line"><span class="lineno">  260</span><span class="comment">    else         Gamma_0.initialize(-config.U);              // initialize bare vertex (Matsubara)</span></div>
<div class="line"><span class="lineno">  261</span><span class="comment">    Propagator&lt;Q&gt; G (Lambda, state_in.selfenergy, &#39;g&#39;);   // full propagator</span></div>
<div class="line"><span class="lineno">  262</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  263</span><span class="comment">    //G.save_propagator_values(data_dir + &quot;parquetPropagator.h5&quot;, G.selfenergy.Sigma.frequencies.primary_grid.get_all_frequencies());</span></div>
<div class="line"><span class="lineno">  264</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  265</span><span class="comment">    // compute the a bubble with full vertex on the right</span></div>
<div class="line"><span class="lineno">  266</span><span class="comment">    GeneralVertex&lt;Q,symmetric_r_irred,false&gt; bubble_a_r (Lambda);</span></div>
<div class="line"><span class="lineno">  267</span><span class="comment">    bubble_a_r.set_Ir(true);</span></div>
<div class="line"><span class="lineno">  268</span><span class="comment">    bubble_a_r.set_frequency_grid(state_in.vertex);</span></div>
<div class="line"><span class="lineno">  269</span><span class="comment">    bubble_function(bubble_a_r, Gamma_0, state_in.vertex, G, G, &#39;a&#39;, false, config);  // full vertex on the right</span></div>
<div class="line"><span class="lineno">  270</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  271</span><span class="comment">    // compute the a bubble with full vertex on the left</span></div>
<div class="line"><span class="lineno">  272</span><span class="comment">    GeneralVertex&lt;Q,symmetric_r_irred,false&gt; bubble_a_l (Lambda);</span></div>
<div class="line"><span class="lineno">  273</span><span class="comment">    bubble_a_l.set_Ir(true);</span></div>
<div class="line"><span class="lineno">  274</span><span class="comment">    bubble_a_l.set_frequency_grid(state_in.vertex);</span></div>
<div class="line"><span class="lineno">  275</span><span class="comment">    bubble_function(bubble_a_l, state_in.vertex, Gamma_0, G, G, &#39;a&#39;, false, config);  // full vertex on the left</span></div>
<div class="line"><span class="lineno">  276</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  277</span><span class="comment">    GeneralVertex&lt;Q,symmetric_r_irred,false&gt; bubble_a = (bubble_a_r + bubble_a_l) * 0.5;  // symmetrize the two versions of the a bubble</span></div>
<div class="line"><span class="lineno">  278</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  279</span><span class="comment">    // compute the self-energy via SDE using the a bubble</span></div>
<div class="line"><span class="lineno">  280</span><span class="comment">    Sigma_SDE_a.initialize(config.U / 2., 0.); /// Note: Only valid for the particle-hole symmetric_full case</span></div>
<div class="line"><span class="lineno">  281</span><span class="comment">    //bubble_a.avertex().K2 *= 0.;</span></div>
<div class="line"><span class="lineno">  282</span><span class="comment">    loop&lt;false,0&gt;(Sigma_SDE_a, bubble_a, G);</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">    utils::print(&quot;Check causality of Sigma_SDE_a: \n&quot;);</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">    check_SE_causality(Sigma_SDE_a);</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">    compare_with_FDTs(bubble_a, state_in.Lambda, SDE_counter, &quot;SDE_bubble_a_&quot; + std::to_string(SDE_counter));</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  287</span><span class="comment">    // compute the p bubble with full vertex on the right</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">    GeneralVertex&lt;Q,symmetric_r_irred,false&gt; bubble_p_r (Lambda);</span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">    bubble_p_r.set_Ir(true);</span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">    bubble_p_r.set_frequency_grid(state_in.vertex);</span></div>
<div class="line"><span class="lineno">  291</span><span class="comment">    bubble_function(bubble_p_r, Gamma_0, state_in.vertex, G, G, &#39;p&#39;, false, config);  // full vertex on the right</span></div>
<div class="line"><span class="lineno">  292</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  293</span><span class="comment">    // compute the p bubble with full vertex on the left</span></div>
<div class="line"><span class="lineno">  294</span><span class="comment">    GeneralVertex&lt;Q,symmetric_r_irred,false&gt; bubble_p_l (Lambda);</span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">    bubble_p_l.set_Ir(true);</span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">    bubble_p_l.set_frequency_grid(state_in.vertex);</span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">    bubble_function(bubble_p_l, state_in.vertex, Gamma_0, G, G, &#39;p&#39;, false, config);  // full vertex on the left</span></div>
<div class="line"><span class="lineno">  298</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  299</span><span class="comment">    GeneralVertex&lt;Q,symmetric_r_irred,false&gt; bubble_p = (bubble_p_r + bubble_p_l) * 0.5;  // symmetrize the two versions of the p bubble</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  301</span><span class="comment">    // compute the self-energy via SDE using the p bubble</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">    Sigma_SDE_p.initialize(glb_U / 2., 0.); /// Note: Only valid for the particle-hole symmetric_full case</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">    //bubble_p.pvertex().K2 *= 0.;</span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">    loop&lt;false,0&gt;(Sigma_SDE_p, bubble_p, G);</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">    utils::print(&quot;Check causality of Sigma_SDE_p: \n&quot;);</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">    check_SE_causality(Sigma_SDE_p);</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">    compare_with_FDTs(bubble_p, state_in.Lambda, SDE_counter, &quot;SDE_bubble_p_&quot; + std::to_string(SDE_counter));</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  309</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  310</span><span class="comment">    // symmetrize the contributions computed via a/p bubble</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">    Sigma_SDE = (Sigma_SDE_a + Sigma_SDE_p) * 0.5;</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">    utils::print(&quot;Check causality of Sigma_SDE: \n&quot;);</span></div>
<div class="line"><span class="lineno">  313</span><span class="comment">    check_SE_causality(Sigma_SDE);</span></div>
<div class="line"><span class="lineno">  314</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  315</span><span class="comment">    //utils::print(&quot; ---&gt; difference between K1a-left and -right: &quot;, (bubble_a_l - bubble_a_r).avertex().K1.get_vec().max_norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  316</span><span class="comment">    //utils::print(&quot; ---&gt; difference between K1p-left and -right: &quot;, (bubble_p_l - bubble_p_r).pvertex().K1.get_vec().max_norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  317</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  318</span><span class="comment">    if (write_state) {</span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">        std::string filename = data_dir + &quot;SDE_iteration&quot; + std::to_string(SDE_counter);</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">        H5::H5File file_out = H5::H5File(filename, H5F_ACC_TRUNC);</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">        write_to_hdf(file_out, &quot;Sigma_SDE_a&quot;, Sigma_SDE_a.Sigma.get_vec(), false);</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">        write_to_hdf(file_out, &quot;Sigma_SDE_p&quot;, Sigma_SDE_p.Sigma.get_vec(), false);</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">        write_to_hdf(file_out, &quot;Sigma_SDE&quot;, Sigma_SDE.Sigma.get_vec(), false);</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">        file_out.close();</span></div>
<div class="line"><span class="lineno">  325</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  326</span><span class="comment">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">        State&lt;Q&gt; Psi_a(Vertex&lt;Q,false&gt;(bubble_a.half1()), Sigma_SDE_a, Lambda);</span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">        State&lt;Q&gt; Psi_a_l(Vertex&lt;Q,false&gt;(bubble_a_l.half1()), Sigma_SDE_a, Lambda);</span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">        State&lt;Q&gt; Psi_a_r(Vertex&lt;Q,false&gt;(bubble_a_r.half1()), Sigma_SDE_a, Lambda);</span></div>
<div class="line"><span class="lineno">  330</span><span class="comment">        State&lt;Q&gt; Psi_p(Vertex&lt;Q,false&gt;(bubble_p.half1()), Sigma_SDE_p, Lambda);</span></div>
<div class="line"><span class="lineno">  331</span><span class="comment">        State&lt;Q&gt; Psi_p_l(Vertex&lt;Q,false&gt;(bubble_p_l.half1()), Sigma_SDE_p, Lambda);</span></div>
<div class="line"><span class="lineno">  332</span><span class="comment">        State&lt;Q&gt; Psi_p_r(Vertex&lt;Q,false&gt;(bubble_p_r.half1()), Sigma_SDE_p, Lambda);</span></div>
<div class="line"><span class="lineno">  333</span><span class="comment">        add_state_to_hdf(data_dir + &quot;Psi_SDE_a.h5&quot;, SDE_counter + 1, Psi_a, true);</span></div>
<div class="line"><span class="lineno">  334</span><span class="comment">        add_state_to_hdf(data_dir + &quot;Psi_SDE_p.h5&quot;, SDE_counter + 1, Psi_p, true);</span></div>
<div class="line"><span class="lineno">  335</span><span class="comment">        add_state_to_hdf(data_dir + &quot;Psi_SDE_a_l.h5&quot;, SDE_counter + 1, Psi_a_l, true);</span></div>
<div class="line"><span class="lineno">  336</span><span class="comment">        add_state_to_hdf(data_dir + &quot;Psi_SDE_a_r.h5&quot;, SDE_counter + 1, Psi_a_r, true);</span></div>
<div class="line"><span class="lineno">  337</span><span class="comment">        add_state_to_hdf(data_dir + &quot;Psi_SDE_p_l.h5&quot;, SDE_counter + 1, Psi_p_l, true);</span></div>
<div class="line"><span class="lineno">  338</span><span class="comment">        add_state_to_hdf(data_dir + &quot;Psi_SDE_p_r.h5&quot;, SDE_counter + 1, Psi_p_r, true);</span></div>
<div class="line"><span class="lineno">  339</span><span class="comment">#endif</span></div>
<div class="line"><span class="lineno">  340</span><span class="comment">    }</span></div>
<div class="line"><span class="lineno">  341</span><span class="comment">    SDE_counter++;</span></div>
<div class="line"><span class="lineno">  342</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno">  343</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00444">compute_SDE_v2()</a>.</p>

</div>
</div>
<a id="a947824a1a735bc2e9db735348ac9dd2c" name="a947824a1a735bc2e9db735348ac9dd2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a947824a1a735bc2e9db735348ac9dd2c">&#9670;&#160;</a></span>compute_SDE_impl_v3()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../d9/db9/classbool.html">bool</a> version, <a class="el" href="../../d9/db9/classbool.html">bool</a> is_differentiated_vertex, <a class="el" href="../../d9/db9/classbool.html">bool</a> is_differentiated_SE, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; compute_SDE_impl_v3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> char</td>          <td class="paramname"><span class="paramname"><em>channel</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_differentiated_vertex</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Gamma</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>G_loop</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the SDE by closing the loop over K1a+K2a or K1p+K2p. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00377">377</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  377</span>                                                                                                                                                                                    {</div>
<div class="line"><span class="lineno">  378</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">assert</a>((<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a> == 0 <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> (channel == <span class="charliteral">&#39;a&#39;</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">or</a> channel == <span class="charliteral">&#39;p&#39;</span>)) <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">or</a> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a> == 1 <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> (channel == <span class="charliteral">&#39;t&#39;</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">or</a> channel == <span class="charliteral">&#39;p&#39;</span>)));</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="comment">//check_selfconsistency_of_K1K2&lt;&#39;a&#39;,Q&gt;(Gamma, Lambda, G_loop, config);</span></div>
<div class="line"><span class="lineno">  381</span>    <span class="comment">//check_selfconsistency_of_K1K2&lt;&#39;p&#39;,Q&gt;(Gamma, Lambda, G_loop, config);</span></div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,non_symmetric_diffleft,is_differentiated_vertex&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>(Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a914996279b86330de5331fb018eb3f60">half1</a>(), Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a914996279b86330de5331fb018eb3f60">half1</a>(), Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#abb8396f63f5f6ea6c66371d9075bdc28">get_vertex_nondiff</a>());</div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>: {<span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;p&#39;</span>, <span class="charliteral">&#39;t&#39;</span>}) {</div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a> != channel) {</div>
<div class="line"><span class="lineno">  386</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>);</div>
<div class="line"><span class="lineno">  387</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a>);</div>
<div class="line"><span class="lineno">  388</span>        }</div>
<div class="line"><span class="lineno">  389</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  390</span>            <span class="comment">//Gamma_temp_onlyK2.get_rvertex(r).K2 *= 0.5;</span></div>
<div class="line"><span class="lineno">  391</span>            <span class="comment">//if constexpr (is_differentiated_vertex) {Gamma_temp_onlyK2.get_vertex_nondiff().get_rvertex(r).K2 *= 0.5;}</span></div>
<div class="line"><span class="lineno">  392</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a971bae9902862f2a2e1379520ee2d2bf">DEBUG_SYMMETRIES</a>) {</div>
<div class="line"><span class="lineno">  393</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>.get_rvertex(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>).K2b *= 0.5;</div>
<div class="line"><span class="lineno">  394</span>                <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_differentiated_vertex</a>) {<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>.get_vertex_nondiff().get_rvertex(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>).K2b *= 0.5;}</div>
<div class="line"><span class="lineno">  395</span>            }</div>
<div class="line"><span class="lineno">  396</span>        }</div>
<div class="line"><span class="lineno">  397</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a>);</div>
<div class="line"><span class="lineno">  398</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a>);</div>
<div class="line"><span class="lineno">  399</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>.set_to_zero_in_integrand(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2">k3_sbe</a>);</div>
<div class="line"><span class="lineno">  400</span>    }</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>    <span class="comment">// compute the self-energy via SDE using the Gamma_temp_onlyK2</span></div>
<div class="line"><span class="lineno">  403</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_loop</a>.selfenergy.Sigma.frequencies);</div>
<div class="line"><span class="lineno">  404</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">loop&lt;false,version&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_temp_onlyK2</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">G_loop</a>);</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>;</div>
<div class="line"><span class="lineno">  408</span>}</div>
<div class="ttc" id="aclassGeneralVertex_html_a914996279b86330de5331fb018eb3f60"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#a914996279b86330de5331fb018eb3f60">GeneralVertex::half1</a></div><div class="ttdeci">fullvert&lt; Q &gt; &amp; half1()</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l00857">vertex.hpp:857</a></div></div>
<div class="ttc" id="aclassGeneralVertex_html_abb8396f63f5f6ea6c66371d9075bdc28"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#abb8396f63f5f6ea6c66371d9075bdc28">GeneralVertex::get_vertex_nondiff</a></div><div class="ttdeci">const vertex_nondiff_t &amp; get_vertex_nondiff() const</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l00861">vertex.hpp:861</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00011">DEBUG_SYMMETRIES</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l00861">GeneralVertex&lt; Q, symmtype, differentiated &gt;::get_vertex_nondiff()</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l00857">GeneralVertex&lt; Q, symmtype, differentiated &gt;::half1()</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k1</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k2</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k2b</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k3</a>, and <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k3_sbe</a>.</p>

</div>
</div>
<a id="a7e421b1e2c3e3c8fbaa9fe1600a2ef54" name="a7e421b1e2c3e3c8fbaa9fe1600a2ef54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e421b1e2c3e3c8fbaa9fe1600a2ef54">&#9670;&#160;</a></span>compute_SDE_v1()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> compute_SDE_v1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sigma_SDE</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>compute the (non-differentiated) SDE by splitting up the full vertex in  = R + _a + _p + _t form the bubble in the 'natural' channels and close the loop accordingly i.e.  = L_0( B_a(_0, _0), G) + L_0( B_a(_0, _a), G) + L_0( B_p(_0, _p), G) + L_1( B_t(_0, _t), G) where L_i stands for a loop with version i and B_r for a bubble in channel r (everything with non-differentiated full propagators G) </p>
<p>Problem: To read out certain Keldysh components we use the transformations T1 and T2 (exchange symmetry) This switches between the channels a and t ==&gt; We cannot split up the a- and the t-channel Rather, we would need to compute the intermediate bubble both in the a- and the t-channel In Matsubara the symmetry tables for the updown spin-component don't contain these transformations that transform between different channels</p>
<p>TODO(micro-optimization): write SDE in the way that Fabian likes:</p>
<p>Compute B(Gamma0, gamma_t)^upup directly and store it at the location where we actually store updown. Then let the loop read out the upup Komponent from this place. (There should be no issues with the symmetries.)</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00207">207</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span>                                                                                                                       {</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  213</span>    <a class="code hl_class" href="../../d7/d97/classState.html">State&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Psi_0</a> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda);                  <span class="comment">// bare vertex with self-energy copied from state_in</span></div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Psi_0</a>.initialize();</div>
<div class="line"><span class="lineno">  215</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Psi_0</a>.selfenergy = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy;</div>
<div class="line"><span class="lineno">  216</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_0</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy;</div>
<div class="line"><span class="lineno">  217</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_aplus0</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy;</div>
<div class="line"><span class="lineno">  218</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_pplus0</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy;</div>
<div class="line"><span class="lineno">  219</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_tplus0</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy;</div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v1&lt;'a',Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Psi_0</a>, Lambda, config);</div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v1&lt;'a',Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_aplus0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, config);</div>
<div class="line"><span class="lineno">  222</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v1&lt;'p',Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_pplus0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, config);</div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v1&lt;'t',Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_tplus0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, config); </div>
<div class="line"><span class="lineno">  225</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_aplus0</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_pplus0</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_tplus0</a> - 2. * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_0</a>;</div>
<div class="line"><span class="lineno">  226</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>.</p>

</div>
</div>
<a id="aa738db4c50d72d9475911cf0dfce2bad" name="aa738db4c50d72d9475911cf0dfce2bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa738db4c50d72d9475911cf0dfce2bad">&#9670;&#160;</a></span>compute_SDE_v2()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> compute_SDE_v2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sigma_SDE</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper for the above function, with only the total (symmetrized) result Sigma_SDE returned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sigma_SDE</td><td>: Self-energy computed as the lhs of the BSE </td></tr>
    <tr><td class="paramname">state_in</td><td>: Input state for which to check the SDE </td></tr>
    <tr><td class="paramname">Lambda</td><td>: Flow parameter Lambda at which input state was computed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00444">444</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  444</span>                                                                                                                       {</div>
<div class="line"><span class="lineno">  445</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy.Sigma.frequencies);</div>
<div class="line"><span class="lineno">  446</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy.Sigma.frequencies);</div>
<div class="line"><span class="lineno">  447</span>    <a class="code hl_function" href="#afe5b9519474c166967ed13d6791538b9">compute_SDE_impl_v2</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, config);</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;difference bw SDE_a and SDE_p: \n&quot;</span>);</div>
<div class="line"><span class="lineno">  450</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;\t&quot;</span>, (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a> - <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>).norm() / <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>.norm(), <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>    <span class="comment">//State&lt;Q,false&gt; Psi_a = state_in;</span></div>
<div class="line"><span class="lineno">  453</span>    <span class="comment">//State&lt;Q,false&gt; Psi_p = state_in;</span></div>
<div class="line"><span class="lineno">  454</span>    <span class="comment">//Psi_a.selfenergy = Sigma_SDE_a;</span></div>
<div class="line"><span class="lineno">  455</span>    <span class="comment">//Psi_p.selfenergy = Sigma_SDE_p;</span></div>
<div class="line"><span class="lineno">  456</span>    <span class="comment">//add_state_to_hdf(data_dir + &quot;Psi_SDE_a.h5&quot;, SDE_counter + 1, Psi_a, true);</span></div>
<div class="line"><span class="lineno">  457</span>    <span class="comment">//add_state_to_hdf(data_dir + &quot;Psi_SDE_p.h5&quot;, SDE_counter + 1, Psi_p, true);</span></div>
<div class="line"><span class="lineno">  458</span>}</div>
<div class="ttc" id="aparquet__solver_8hpp_html_afe5b9519474c166967ed13d6791538b9"><div class="ttname"><a href="#afe5b9519474c166967ed13d6791538b9">compute_SDE_impl_v2</a></div><div class="ttdeci">void compute_SDE_impl_v2(SelfEnergy&lt; Q &gt; &amp;Sigma_SDE, SelfEnergy&lt; Q &gt; &amp;Sigma_SDE_a, SelfEnergy&lt; Q &gt; &amp;Sigma_SDE_p, const State&lt; Q &gt; &amp;state_in, const double Lambda, const fRG_config &amp;config)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0a/parquet__solver_8hpp_source.html#l00239">parquet_solver.hpp:239</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00239">compute_SDE_impl_v2()</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, and <a class="el" href="../../d0/d3f/util_8hpp_source.html#l00025">utils::print()</a>.</p>

</div>
</div>
<a id="ac50fa9495cb7f051e0b03aefd35993c4" name="ac50fa9495cb7f051e0b03aefd35993c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac50fa9495cb7f051e0b03aefd35993c4">&#9670;&#160;</a></span>compute_SDE_v3()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> compute_SDE_v3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/df6/classSelfEnergy.html">SelfEnergy</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sigma_SDE</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Save results via a- and p-channel separately:</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00412">412</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  412</span>                                                                                                                       {</div>
<div class="line"><span class="lineno">  413</span>    <a class="code hl_class" href="../../d2/d34/classPropagator.html">Propagator&lt;Q&gt;</a> G(Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.selfenergy, <span class="charliteral">&#39;g&#39;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config);</div>
<div class="line"><span class="lineno">  414</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;0, false, false&gt;</a>(<span class="charliteral">&#39;a&#39;</span>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex, G, config);</div>
<div class="line"><span class="lineno">  415</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;0, false, false&gt;</a>(<span class="charliteral">&#39;p&#39;</span>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex, G, config);</div>
<div class="line"><span class="lineno">  416</span>    <a class="code hl_class" href="../../d5/df6/classSelfEnergy.html">SelfEnergy&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_t</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">compute_SDE_impl_v3&lt;1, false, false&gt;</a>(<span class="charliteral">&#39;t&#39;</span>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex, G, config);</div>
<div class="line"><span class="lineno">  417</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>) * 0.5;</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;difference bw SDE_a and SDE_p: \n&quot;</span>);</div>
<div class="line"><span class="lineno">  420</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;\t&quot;</span>, (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_a</a> - <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>).norm() / <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_SDE_p</a>.norm(), <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  421</span>    <span class="comment">//utils::print(&quot;difference bw SDE_t and SDE_a: \n&quot;);</span></div>
<div class="line"><span class="lineno">  422</span>    <span class="comment">//utils::print(&quot;\t&quot;, (Sigma_SDE_a - Sigma_SDE_t).norm() / Sigma_SDE_t.norm(), &quot;\n&quot;);</span></div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  425</span>    <span class="comment">//State&lt;Q,false&gt; Psi_a = state_in;</span></div>
<div class="line"><span class="lineno">  426</span>    <span class="comment">//State&lt;Q,false&gt; Psi_p = state_in;</span></div>
<div class="line"><span class="lineno">  427</span>    <span class="comment">//State&lt;Q,false&gt; Psi_t = state_in;</span></div>
<div class="line"><span class="lineno">  428</span>    <span class="comment">//Psi_a.selfenergy = Sigma_SDE_a;</span></div>
<div class="line"><span class="lineno">  429</span>    <span class="comment">//Psi_p.selfenergy = Sigma_SDE_p;</span></div>
<div class="line"><span class="lineno">  430</span>    <span class="comment">//Psi_t.selfenergy = Sigma_SDE_t;</span></div>
<div class="line"><span class="lineno">  431</span>    <span class="comment">//add_state_to_hdf(data_dir + &quot;Psi_SDE_a.h5&quot;, SDE_counter + 1, Psi_a, true);</span></div>
<div class="line"><span class="lineno">  432</span>    <span class="comment">//add_state_to_hdf(data_dir + &quot;Psi_SDE_p.h5&quot;, SDE_counter + 1, Psi_p, true);</span></div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">//add_state_to_hdf(data_dir + &quot;Psi_SDE_t.h5&quot;, SDE_counter + 1, Psi_t, true);</span></div>
<div class="line"><span class="lineno">  434</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, and <a class="el" href="../../d0/d3f/util_8hpp_source.html#l00025">utils::print()</a>.</p>

</div>
</div>
<a id="a7f8b92dc55360683f0e90bad965195a8" name="a7f8b92dc55360683f0e90bad965195a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f8b92dc55360683f0e90bad965195a8">&#9670;&#160;</a></span>parquet_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> parquet_checks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> std::string</td>          <td class="paramname"><span class="paramname"><em>filename</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parquet checks for the state in HDF5 file &lt;filename&gt;. For each Lambda step, compute vertex and self-energy by inserting the fRG result into the BSE/SDE and compare to the fRG results. Save norms of fRG/parquet results and differences as vectors into an HDF5 file, and also save the state object resulting from the parquet equations. </p>

</div>
</div>
<a id="aad1680ae03adc0f566df945376e95234" name="aad1680ae03adc0f566df945376e95234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad1680ae03adc0f566df945376e95234">&#9670;&#160;</a></span>parquet_iteration()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> parquet_iteration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_out</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int</td>          <td class="paramname"><span class="paramname"><em>it_Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int</td>          <td class="paramname"><span class="paramname"><em>version</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>One iteration of the parquet solver: Compute both the Bethe-Salpeter and the Schwinger-Dyson equation for given input. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state_out</td><td>: Lhs of the BSE and SDE. </td></tr>
    <tr><td class="paramname">state_in</td><td>: Input to the rhs of the BSE and SDE </td></tr>
    <tr><td class="paramname">Lambda</td><td>: Lambda value at which to compute the parquet equations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00635">635</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  635</span>                                                                                                                                   {</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;Compute BSE:\n&quot;</span>);</div>
<div class="line"><span class="lineno">  638</span>    <a class="code hl_function" href="#a1541a0b7d193f70577c5fab1efc216e1">compute_BSE</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>.vertex, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">it_Lambda</a>);                    <span class="comment">// compute the gamma_r&#39;s via the BSE</span></div>
<div class="line"><span class="lineno">  639</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#afab5195e3ffff420d211040e5672fcbe">KELDYSH</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">not</a> <a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a209c004ba9b216412cae0ca89758f1a9">CONTOUR_BASIS</a>) <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>.vertex.initialize(-<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config.U/2.);     <span class="comment">// add the irreducible vertex</span></div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordflow">else</span>         <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>.vertex.initialize(-<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.config.U);        <span class="comment">// add the irreducible vertex</span></div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;Compute SDE:\n&quot;</span>);</div>
<div class="line"><span class="lineno">  643</span>    <a class="code hl_function" href="#a9ef507c1d49fff7991752cab04374824">compute_SDE</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>.selfenergy, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a>);  <span class="comment">// compute the self-energy via the SDE</span></div>
<div class="line"><span class="lineno">  644</span>    <span class="comment">//state_out.selfenergy = state_in.selfenergy; // uncomment if you don&#39;t wanna update selfenergy</span></div>
<div class="line"><span class="lineno">  645</span>}</div>
<div class="ttc" id="aparquet__solver_8hpp_html_a9ef507c1d49fff7991752cab04374824"><div class="ttname"><a href="#a9ef507c1d49fff7991752cab04374824">compute_SDE</a></div><div class="ttdeci">void compute_SDE(SelfEnergy&lt; Q &gt; &amp;Sigma_SDE, const State&lt; Q &gt; &amp;state_in, const double Lambda, int version)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0a/parquet__solver_8hpp_source.html#l00462">parquet_solver.hpp:462</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00028">compute_BSE()</a>, <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00462">compute_SDE()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00020">CONTOUR_BASIS</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00137">KELDYSH</a>, and <a class="el" href="../../d0/d3f/util_8hpp_source.html#l00025">utils::print()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00659">parquet_solver()</a>.</p>

</div>
</div>
<a id="a07f441b6693f6e2e8d958049ae06cb73" name="a07f441b6693f6e2e8d958049ae06cb73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07f441b6693f6e2e8d958049ae06cb73">&#9670;&#160;</a></span>parquet_solver()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> parquet_solver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> std::string</td>          <td class="paramname"><span class="paramname"><em>filename</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int</td>          <td class="paramname"><span class="paramname"><em>version</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>accuracy</em><span class="paramdefsep"> = </span><span class="paramdefval">1e-6</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int</td>          <td class="paramname"><span class="paramname"><em>Nmax</em><span class="paramdefsep"> = </span><span class="paramdefval">6</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d9/db9/classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>overwrite_old_results</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">true</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>mixing_ratio</em><span class="paramdefsep"> = </span><span class="paramdefval">1.0</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d9/db9/classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>use_last_state_anyway</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a></span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Iterate the parquet equations for a given input state until convergence. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>: File name for result </td></tr>
    <tr><td class="paramname">state_in</td><td>: Input state used as initial input to the parquet equations (e.g. SOPT) </td></tr>
    <tr><td class="paramname">Lambda</td><td>: Lambda value at which to iterate the parquet equations </td></tr>
    <tr><td class="paramname">accuracy</td><td>: Desired relative accuracy used as convergence criterion for both vertex and selfenergy (default: 0.001) </td></tr>
    <tr><td class="paramname">Nmax</td><td>: Maximal number of parquet iterations, used as a break condition in case convergence cannot be reached (default: 50) </td></tr>
    <tr><td class="paramname">mixing_ratio</td><td>mixing ratio in [0.1 - 0.5] for stabilizing the parquet iteration </td></tr>
  </table>
  </dd>
</dl>
<p>for testing:</p>
<p>for testing:</p>
<p>mixing of old and new state:</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00659">659</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  660</span>                                                                                                                                                                                {</div>
<div class="line"><span class="lineno">  661</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_minimum</a> = 0.01; <span class="comment">// minimal mixing factor; tiny mixing factors guarantee &quot;convergence&quot; for anything and make the result totally useless.</span></div>
<div class="line"><span class="lineno">  662</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">assert</a>((<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_ratio</a> &gt;= <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_minimum</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_ratio</a> &lt;= 0.5) <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">or</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_ratio</a> == 1.0);</div>
<div class="line"><span class="lineno">  663</span>    <a class="code hl_variable" href="#ade72d4c0a25548ba8cb4c0dcd8950b65">SDE_counter</a> = 0;</div>
<div class="line"><span class="lineno">  664</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;\t --- Start parquet solver ---\n&quot;</span>);</div>
<div class="line"><span class="lineno">  665</span>    <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;Results get stored in &quot;</span>, filename, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  666</span>    std::deque&lt;State&lt;Q&gt;&gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">rhs_evals</a>;</div>
<div class="line"><span class="lineno">  667</span>    std::deque&lt;State&lt;Q&gt;&gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">iteration_steps</a>;</div>
<div class="line"><span class="lineno">  668</span>    std::deque&lt;double&gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_deviation_history</a>;</div>
<div class="line"><span class="lineno">  669</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Nmax_history</a> = 5;</div>
<div class="line"><span class="lineno">  670</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">n_States_for_AndersonAcceleration</a> = 4;</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">overwrite_old_results</a>) {</div>
<div class="line"><span class="lineno">  673</span>        <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;Start from scratch.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  674</span>    }</div>
<div class="line"><span class="lineno">  675</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  676</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_it</a> = -1;</div>
<div class="line"><span class="lineno">  677</span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_converged</a> = <a class="code hl_function" href="../../d5/d4f/hdf5__routines_8c_09_09.html#a0f3795e3b03f3c010cc3befa1c153054">check_convergence_hdf</a>(filename, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_it</a>);</div>
<div class="line"><span class="lineno">  678</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_converged</a> || (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">use_last_state_anyway</a> &amp;&amp; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_it</a>)) { <span class="comment">// load last result and break if result is converged already or if we are happy with any parquet</span></div>
<div class="line"><span class="lineno">  679</span>            <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;Loading &quot;</span>, (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">use_last_state_anyway</a>? <span class="stringliteral">&quot;un&quot;</span>:<span class="stringliteral">&quot;&quot;</span>), <span class="stringliteral">&quot; converged parquet result from file (Lambda_it = &quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_it</a>, <span class="stringliteral">&quot;) \n&quot;</span>);</div>
<div class="line"><span class="lineno">  680</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a> = <a class="code hl_function" href="../../d5/d4f/hdf5__routines_8c_09_09.html#aa0ab8d27e7ed5ce3762582c2416a9b45">read_state_from_hdf</a>(filename, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_it</a>);</div>
<div class="line"><span class="lineno">  681</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  682</span>        }</div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_it</a> &gt;= 0) {</div>
<div class="line"><span class="lineno">  684</span>            <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;Loading non-converged parquet result from file (Lambda_it = &quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_it</a>, <span class="stringliteral">&quot;) \n&quot;</span>);</div>
<div class="line"><span class="lineno">  685</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a> = <a class="code hl_function" href="../../d5/d4f/hdf5__routines_8c_09_09.html#aa0ab8d27e7ed5ce3762582c2416a9b45">read_state_from_hdf</a>(filename, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_it</a>);</div>
<div class="line"><span class="lineno">  686</span>        }</div>
<div class="line"><span class="lineno">  687</span>    }</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_adaptive</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_ratio</a>;</div>
<div class="line"><span class="lineno">  690</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">trigger_adaptation</a> = 5;</div>
<div class="line"><span class="lineno">  691</span>    <span class="comment">//write_state_to_hdf(filename, Lambda, Nmax + 1, state_in); // save input into 0-th layer of hdf5 file</span></div>
<div class="line"><span class="lineno">  692</span>    <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a>(filename, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">trigger_adaptation</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>); <span class="comment">// save input into 0-th layer of hdf5 file</span></div>
<div class="line"><span class="lineno">  693</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d4/dda/mpi__setup_8c_09_09.html#a191972e98e51a56d90e8e5f750496c7d">mpi_world_rank</a>() == 0) {</div>
<div class="line"><span class="lineno">  694</span>        H5::H5File <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a> = <a class="code hl_function" href="../../d5/d4f/hdf5__routines_8c_09_09.html#a924110dbdaccbbc744def3ca0838cb4c">open_hdf_file_readWrite</a>(filename);</div>
<div class="line"><span class="lineno">  695</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">write_to_hdf_LambdaLayer&lt;double&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;mixing_parameter&quot;</span>, std::vector&lt;double&gt;({<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_ratio</a>}), 0, Nmax + 1, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  696</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>.close();</div>
<div class="line"><span class="lineno">  697</span>    }</div>
<div class="line"><span class="lineno">  698</span>    <a class="code hl_class" href="../../d9/d2a/classvec.html">rvec</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambdas</a> (Nmax + 1);  <span class="comment">// auxiliary vector needed for hdf5 routines (empty since Lambda is constant)</span></div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno">  701</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">write_state</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  702</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">write_state</a>) {</div>
<div class="line"><span class="lineno">  703</span>        <span class="comment">//write_state_to_hdf(data_dir + &quot;Parquet_GammaL&quot;, Lambda, Nmax + 1,</span></div>
<div class="line"><span class="lineno">  704</span>        <span class="comment">//                   state_in); // save input into 0-th layer of hdf5 file</span></div>
<div class="line"><span class="lineno">  705</span>        <span class="comment">//write_state_to_hdf(data_dir + &quot;Parquet_GammaR&quot;, Lambda, Nmax + 1,</span></div>
<div class="line"><span class="lineno">  706</span>        <span class="comment">//                   state_in); // save input into 0-th layer of hdf5 file</span></div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a>(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Psi_SDE_a.h5&quot;</span>, Lambda, Nmax + 1, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  709</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a>(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Psi_SDE_p.h5&quot;</span>, Lambda, Nmax + 1, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  710</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a>(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Psi_SDE_a_l.h5&quot;</span>, Lambda, Nmax + 1, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  711</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a>(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Psi_SDE_a_r.h5&quot;</span>, Lambda, Nmax + 1, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  712</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a>(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Psi_SDE_p_l.h5&quot;</span>, Lambda, Nmax + 1, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  713</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a>(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Psi_SDE_p_r.h5&quot;</span>, Lambda, Nmax + 1, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  714</span>    }</div>
<div class="line"><span class="lineno">  715</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  716</span>    <a class="code hl_class" href="../../d7/d97/classState.html">State&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda);   <span class="comment">// lhs of the parquet equations</span></div>
<div class="line"><span class="lineno">  717</span>    <a class="code hl_class" href="../../d7/d97/classState.html">State&lt;Q&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_diff</a> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda);  <span class="comment">// difference between input and output of the parquet equations</span></div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordtype">int</span> iteration = 1;</div>
<div class="line"><span class="lineno">  720</span>    <span class="comment">// first check if converged, and also stop if maximal number of iterations is reached</span></div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_converged</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  722</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">unfinished</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">unfinished</a>) {</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  726</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  727</span>            <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q,symmetric_r_irred,false&gt;</a> Ir(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex.half1());     <span class="comment">// irreducible vertex</span></div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">symmetry_expand&lt;'a',false,true&gt;</a>();</div>
<div class="line"><span class="lineno">  730</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>.vertex.save_expanded(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Psi_&quot;</span>+ std::to_string(iteration) +<span class="stringliteral">&quot;_symmetry_expanded_for_a_left_&quot;</span>);</div>
<div class="line"><span class="lineno">  731</span>            Ir.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">symmetry_expand&lt;'a',true,true&gt;</a>();</div>
<div class="line"><span class="lineno">  732</span>            Ir.save_expanded(<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;Ir_&quot;</span> + std::to_string(iteration) + <span class="stringliteral">&quot;_symmetry_expanded_for_a_left_&quot;</span>);</div>
<div class="line"><span class="lineno">  733</span>            <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  734</span><span class="comment">            state_in.vertex.template symmetry_expand&lt;&#39;p&#39;,false,true&gt;();</span></div>
<div class="line"><span class="lineno">  735</span><span class="comment">            state_in.vertex.save_expanded(data_dir + &quot;Psi_&quot; + std::to_string(iteration) + &quot;_symmetry_expanded_for_p_left_&quot;);</span></div>
<div class="line"><span class="lineno">  736</span><span class="comment">            Ir.template symmetry_expand&lt;&#39;p&#39;,true,true&gt;();</span></div>
<div class="line"><span class="lineno">  737</span><span class="comment">            Ir.save_expanded(data_dir + &quot;Ir_&quot; + std::to_string(iteration) + &quot;_symmetry_expanded_for_p_left_&quot;);</span></div>
<div class="line"><span class="lineno">  738</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  739</span><span class="comment">            state_in.vertex.template symmetry_expand&lt;&#39;t&#39;,false,true&gt;();</span></div>
<div class="line"><span class="lineno">  740</span><span class="comment">            state_in.vertex.save_expanded(data_dir + &quot;Psi_&quot; + std::to_string(iteration) + &quot;_symmetry_expanded_for_t_left_&quot;);</span></div>
<div class="line"><span class="lineno">  741</span><span class="comment">            Ir.template symmetry_expand&lt;&#39;t&#39;,true,true&gt;();</span></div>
<div class="line"><span class="lineno">  742</span><span class="comment">            Ir.save_expanded(data_dir + &quot;Ir_&quot; + std::to_string(iteration) + &quot;_symmetry_expanded_for_t_left_&quot;);</span></div>
<div class="line"><span class="lineno">  743</span><span class="comment">            */</span></div>
<div class="line"><span class="lineno">  744</span>        }</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t_start</a> = <a class="code hl_function" href="../../d6/d84/namespaceutils.html#a4ae6ae93d2caa1fda9be0ce8f6b339ee">utils::get_time</a>();</div>
<div class="line"><span class="lineno">  747</span>        <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;iteration &quot;</span>, iteration, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>        <a class="code hl_function" href="#aad1680ae03adc0f566df945376e95234">parquet_iteration</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>, Lambda, iteration, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a>);  <span class="comment">// compute lhs of parquet equations</span></div>
<div class="line"><span class="lineno">  751</span>        <span class="comment">//if (iteration == 1) {</span></div>
<div class="line"><span class="lineno">  752</span>        <span class="comment">//    for (char r : {&#39;a&#39;, &#39;p&#39;, &#39;t&#39;}) {</span></div>
<div class="line"><span class="lineno">  753</span>        <span class="comment">//        state_out.vertex.get_rvertex(r).K1 = state_in.vertex.get_rvertex(r).K1;</span></div>
<div class="line"><span class="lineno">  754</span>        <span class="comment">//    }</span></div>
<div class="line"><span class="lineno">  755</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  757</span><span class="preprocessor">#if USE_ANDERSON_ACCELERATION</span></div>
<div class="line"><span class="lineno">  758</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">rhs_evals</a>.push_back(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>);</div>
<div class="line"><span class="lineno">  759</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">iteration_steps</a>.push_back(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>);</div>
<div class="line"><span class="lineno">  760</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">rhs_evals</a>.size() &gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">n_States_for_AndersonAcceleration</a>) {</div>
<div class="line"><span class="lineno">  761</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">rhs_evals</a>.pop_front();</div>
<div class="line"><span class="lineno">  762</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">iteration_steps</a>.pop_front();</div>
<div class="line"><span class="lineno">  763</span>        }</div>
<div class="line"><span class="lineno">  764</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a> = <a class="code hl_function" href="../../d6/d7b/anderson__acceleration_8hpp.html#a88e79b4550a392a79d60d8bf6557461c">anderson_update</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">rhs_evals</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">iteration_steps</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_adaptive</a>);</div>
<div class="line"><span class="lineno">  765</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  766</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_ratio</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a> + (1-<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_ratio</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a>;</div>
<div class="line"><span class="lineno">  767</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  768</span>        <a class="code hl_function" href="../../d2/d3f/sanity__check_8hpp.html#a884fca24faf1e006b285fcce3ddd0299">sanity_check</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>);</div>
<div class="line"><span class="lineno">  769</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_diff</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a> - <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>;               <span class="comment">// compute the difference between lhs and input to rhs</span></div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>        <span class="comment">// compute relative differences between input and output w.r.t. output</span></div>
<div class="line"><span class="lineno">  772</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference_vertex</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_diff</a>.vertex.norm() / <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>.vertex.norm();</div>
<div class="line"><span class="lineno">  773</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference_selfenergy</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_diff</a>.selfenergy.rel_deviation_to(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>.selfenergy);</div>
<div class="line"><span class="lineno">  774</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference</a> = std::max(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference_selfenergy</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference_vertex</a>);</div>
<div class="line"><span class="lineno">  775</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_deviation_history</a>.push_back(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference</a>);</div>
<div class="line"><span class="lineno">  776</span>        <span class="keywordflow">if</span> (std::size(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_deviation_history</a>) &gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Nmax_history</a>) {<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_deviation_history</a>.pop_front();}</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>        <span class="comment">// check whether there is a tendency to convergence. If not: shrink mixing factor</span></div>
<div class="line"><span class="lineno">  779</span>        <span class="keywordflow">if</span> (iteration % <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">trigger_adaptation</a> == 0 &amp;&amp; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_adaptive</a> &gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_minimum</a> &amp;&amp; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_deviation_history</a>[0] &lt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_deviation_history</a>.back()) {</div>
<div class="line"><span class="lineno">  780</span>            <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;MIXING NOT CAREFUL ENOUGH!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  781</span>            <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_deviation_history</a>[0], <span class="stringliteral">&quot;\t &lt; \t&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_deviation_history</a>.back(), <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  782</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_adaptive</a> = std::max(0.6*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_adaptive</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_minimum</a>);</div>
<div class="line"><span class="lineno">  783</span>            <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;New mixing parameter:\t&quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_adaptive</a>, <span class="stringliteral">&quot;\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>        }</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>        <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;relative difference vertex:     &quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference_vertex</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  788</span>        <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;relative difference selfenergy: &quot;</span>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference_selfenergy</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  789</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_converged</a> = !(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference_vertex</a> &gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">accuracy</a> || <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">relative_difference_selfenergy</a> &gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">accuracy</a>);</div>
<div class="line"><span class="lineno">  790</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">unfinished</a> = !<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_converged</a> &amp;&amp; iteration &lt; Nmax;</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#afcbe2c8a768f64e576f593516262d476">add_state_to_hdf</a>(filename, iteration%<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">trigger_adaptation</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_converged</a>);  <span class="comment">// store result into file</span></div>
<div class="line"><span class="lineno">  793</span>        <span class="comment">//write_state_to_hdf(filename, Lambda, 1, state_in, false, is_converged); // save input into 0-th layer of hdf5 file</span></div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d4/dda/mpi__setup_8c_09_09.html#a191972e98e51a56d90e8e5f750496c7d">mpi_world_rank</a>() == 0) {</div>
<div class="line"><span class="lineno">  795</span>            H5::H5File <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a> = <a class="code hl_function" href="../../d5/d4f/hdf5__routines_8c_09_09.html#a924110dbdaccbbc744def3ca0838cb4c">open_hdf_file_readWrite</a>(filename);</div>
<div class="line"><span class="lineno">  796</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">write_to_hdf_LambdaLayer&lt;double&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>, <span class="stringliteral">&quot;mixing_parameter&quot;</span>, std::vector&lt;double&gt;({<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">mixing_adaptive</a>}), iteration%<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">trigger_adaptation</a>, Nmax + 1, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  797</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">file_out</a>.close();</div>
<div class="line"><span class="lineno">  798</span>        }</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_in</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state_out</a>;  <span class="comment">// use output as input for next iteration</span></div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>        <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;Time needed for parquet iteration: &quot;</span>);</div>
<div class="line"><span class="lineno">  803</span>        <a class="code hl_function" href="../../d6/d84/namespaceutils.html#a4ae6ae93d2caa1fda9be0ce8f6b339ee">utils::get_time</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t_start</a>);</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>        ++iteration;</div>
<div class="line"><span class="lineno">  806</span>    }</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">is_converged</a>;</div>
<div class="line"><span class="lineno">  808</span>}</div>
<div class="ttc" id="aanderson__acceleration_8hpp_html_a88e79b4550a392a79d60d8bf6557461c"><div class="ttname"><a href="../../d6/d7b/anderson__acceleration_8hpp.html#a88e79b4550a392a79d60d8bf6557461c">anderson_update</a></div><div class="ttdeci">State&lt; Q, diff &gt; anderson_update(const std::deque&lt; State&lt; Q, diff &gt; &gt; &amp;rhs_evals, const std::deque&lt; State&lt; Q, diff &gt; &gt; &amp;iteration_steps, double zeta=1.0)</div><div class="ttdoc">Perform an anderson mixing update.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d7b/anderson__acceleration_8hpp_source.html#l00057">anderson_acceleration.hpp:57</a></div></div>
<div class="ttc" id="aclassvec_html"><div class="ttname"><a href="../../d9/d2a/classvec.html">vec&lt; double &gt;</a></div></div>
<div class="ttc" id="ahdf5__routines_8c_09_09_html_a0f3795e3b03f3c010cc3befa1c153054"><div class="ttname"><a href="../../d5/d4f/hdf5__routines_8c_09_09.html#a0f3795e3b03f3c010cc3befa1c153054">check_convergence_hdf</a></div><div class="ttdeci">bool check_convergence_hdf(const H5std_string &amp;filename, int &amp;Lambda_it)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4f/hdf5__routines_8c_09_09_source.html#l00194">hdf5_routines.c++:194</a></div></div>
<div class="ttc" id="ahdf5__routines_8c_09_09_html_a924110dbdaccbbc744def3ca0838cb4c"><div class="ttname"><a href="../../d5/d4f/hdf5__routines_8c_09_09.html#a924110dbdaccbbc744def3ca0838cb4c">open_hdf_file_readWrite</a></div><div class="ttdeci">H5::H5File open_hdf_file_readWrite(const std::string &amp;filename)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4f/hdf5__routines_8c_09_09_source.html#l00021">hdf5_routines.c++:21</a></div></div>
<div class="ttc" id="ahdf5__routines_8c_09_09_html_aa0ab8d27e7ed5ce3762582c2416a9b45"><div class="ttname"><a href="../../d5/d4f/hdf5__routines_8c_09_09.html#aa0ab8d27e7ed5ce3762582c2416a9b45">read_state_from_hdf</a></div><div class="ttdeci">State&lt; state_datatype, false &gt; read_state_from_hdf(const H5std_string &amp;filename, const int Lambda_it)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4f/hdf5__routines_8c_09_09_source.html#l00061">hdf5_routines.c++:61</a></div></div>
<div class="ttc" id="ahdf5__routines_8hpp_html_ab7f115126010e4b017eb9e12cd1c29d9"><div class="ttname"><a href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a></div><div class="ttdeci">void write_state_to_hdf(const H5std_string FILE_NAME, double Lambda_i, const int Lambda_size, const State&lt; Q, diff &gt; &amp;state_in, const bool verbose=true, const bool is_converged=false)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/de4/hdf5__routines_8hpp_source.html#l00846">hdf5_routines.hpp:846</a></div></div>
<div class="ttc" id="ampi__setup_8c_09_09_html_a191972e98e51a56d90e8e5f750496c7d"><div class="ttname"><a href="../../d4/dda/mpi__setup_8c_09_09.html#a191972e98e51a56d90e8e5f750496c7d">mpi_world_rank</a></div><div class="ttdeci">int mpi_world_rank()</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dda/mpi__setup_8c_09_09_source.html#l00003">mpi_setup.c++:3</a></div></div>
<div class="ttc" id="anamespaceutils_html_a4ae6ae93d2caa1fda9be0ce8f6b339ee"><div class="ttname"><a href="../../d6/d84/namespaceutils.html#a4ae6ae93d2caa1fda9be0ce8f6b339ee">utils::get_time</a></div><div class="ttdeci">double get_time()</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d35/util_8c_09_09_source.html#l00021">util.c++:21</a></div></div>
<div class="ttc" id="aparquet__solver_8hpp_html_aad1680ae03adc0f566df945376e95234"><div class="ttname"><a href="#aad1680ae03adc0f566df945376e95234">parquet_iteration</a></div><div class="ttdeci">void parquet_iteration(State&lt; Q &gt; &amp;state_out, const State&lt; Q &gt; &amp;state_in, const double Lambda, const int it_Lambda, const int version)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0a/parquet__solver_8hpp_source.html#l00635">parquet_solver.hpp:635</a></div></div>
<div class="ttc" id="asanity__check_8hpp_html_a884fca24faf1e006b285fcce3ddd0299"><div class="ttname"><a href="../../d2/d3f/sanity__check_8hpp.html#a884fca24faf1e006b285fcce3ddd0299">sanity_check</a></div><div class="ttdeci">void sanity_check(const State&lt; Q &gt; &amp;state)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d3f/sanity__check_8hpp_source.html#l00010">sanity_check.hpp:10</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de4/hdf5__routines_8hpp_source.html#l00872">add_state_to_hdf()</a>, <a class="el" href="../../d6/d7b/anderson__acceleration_8hpp_source.html#l00057">anderson_update()</a>, <a class="el" href="../../d5/d4f/hdf5__routines_8c_09_09_source.html#l00194">check_convergence_hdf()</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00159">data_dir</a>, <a class="el" href="../../d6/d35/util_8c_09_09_source.html#l00021">utils::get_time()</a>, <a class="el" href="../../d4/dda/mpi__setup_8c_09_09_source.html#l00003">mpi_world_rank()</a>, <a class="el" href="../../d5/d4f/hdf5__routines_8c_09_09_source.html#l00021">open_hdf_file_readWrite()</a>, <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00635">parquet_iteration()</a>, <a class="el" href="../../d0/d3f/util_8hpp_source.html#l00025">utils::print()</a>, <a class="el" href="../../d5/d4f/hdf5__routines_8c_09_09_source.html#l00061">read_state_from_hdf()</a>, <a class="el" href="../../d2/d3f/sanity__check_8hpp_source.html#l00010">sanity_check()</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l01115">GeneralVertex&lt; Q, symmtype, differentiated &gt;::save_expanded()</a>, <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00065">SDE_counter</a>, and <a class="el" href="../../d5/de4/hdf5__routines_8hpp_source.html#l00846">write_state_to_hdf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d94/parquet__solver_8c_09_09_source.html#l00106">run_parquet()</a>.</p>

</div>
</div>
<a id="aa85025687bc343bc18b36d929a335ef4" name="aa85025687bc343bc18b36d929a335ef4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa85025687bc343bc18b36d929a335ef4">&#9670;&#160;</a></span>run_parquet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> run_parquet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>U_NRG_list</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> int</td>          <td class="paramname"><span class="paramname"><em>version</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d9/db9/classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>overwrite_old_results</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run the parquet solver, given a set of parameters. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>Config struct which holds all necessary parameters </td></tr>
    <tr><td class="paramname">U_NRG_list</td><td>List of values for U/ for which to run a calculation </td></tr>
    <tr><td class="paramname">version</td><td>Version of the implementation of the Schwinger-Dyson equation to be used. Recommendation: 1 </td></tr>
    <tr><td class="paramname">overwrite_old_results</td><td>Determines whether existing results for the given parameters shall be overwritten or not. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d94/parquet__solver_8c_09_09_source.html#l00106">106</a> of file <a class="el" href="../../d5/d94/parquet__solver_8c_09_09_source.html">parquet_solver.c++</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>                                                                                                                                    {</div>
<div class="line"><span class="lineno">  107</span>    <span class="keyword">const</span> std::vector&lt;double&gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_checkpoints</a> = <a class="code hl_function" href="../../d4/d5e/namespaceflowgrid.html#ab85047ef8b48a23fc3b5683801788952">flowgrid::get_Lambda_checkpoints</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">U_NRG_list</a>, config);</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> Lambda : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Lambda_checkpoints</a>) {</div>
<div class="line"><span class="lineno">  110</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t_start</a> = <a class="code hl_function" href="../../d6/d84/namespaceutils.html#a4ae6ae93d2caa1fda9be0ce8f6b339ee">utils::get_time</a>();</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>        <a class="code hl_class" href="../../d7/d97/classState.html">State&lt;state_datatype&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  113</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state</a>.initialize();</div>
<div class="line"><span class="lineno">  114</span>        <a class="code hl_function" href="../../d5/d0d/perturbation__theory_8hpp.html#a7ac208e8f3c934c5b68264609f81acd4">sopt_state</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state</a>);</div>
<div class="line"><span class="lineno">  115</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Delta = (config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#a424d2ec952ccad62dca3f2333a614541">Gamma</a> + Lambda) * 0.5;</div>
<div class="line"><span class="lineno">  116</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">U_over_Delta</a> = config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#ad9afaf64e087c69bc4f16e49c132b592">U</a> / Delta;</div>
<div class="line"><span class="lineno">  117</span>        <span class="keyword">const</span> std::string <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">parquet_filename_pre</a> = <a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#a1b384aea75d8da97c90c700d40dc19d2">data_dir</a> + <span class="stringliteral">&quot;parquetInit4_U_over_Delta=&quot;</span> + std::to_string(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">U_over_Delta</a>) + <span class="stringliteral">&quot;_T=&quot;</span> + std::to_string(config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#a650ac47628d97c0bd647de9aef8a7504">T</a>) + <span class="stringliteral">&quot;_eVg=&quot;</span> + std::to_string(config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#a4a612c073aced64bd84466bbb875ff3f">epsilon</a>+config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#ad9afaf64e087c69bc4f16e49c132b592">U</a>*0.5) + <span class="stringliteral">&quot;_n1=&quot;</span> + std::to_string(<a class="code hl_variable" href="../../d3/d3c/frequency__parameters_8hpp.html#a53beecdaf61aae67af4961c402376dc6">nBOS</a>) + <span class="stringliteral">&quot;_n2=&quot;</span> + std::to_string(<a class="code hl_variable" href="../../d3/d3c/frequency__parameters_8hpp.html#a18fa2894433252528682ce7deae641c1">nBOS2</a>) + <span class="stringliteral">&quot;_n3=&quot;</span> + std::to_string(<a class="code hl_variable" href="../../d3/d3c/frequency__parameters_8hpp.html#acf74a969ffcb98c08a18e0341b82d0dd">nBOS3</a>) + <span class="stringliteral">&quot;_version&quot;</span> + std::to_string(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a>);</div>
<div class="line"><span class="lineno">  118</span>        <span class="keyword">const</span> std::string <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">parquet_filename_all</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">parquet_filename_pre</a> + <span class="stringliteral">&quot;.h5&quot;</span>;</div>
<div class="line"><span class="lineno">  119</span>        <span class="keyword">const</span> std::string <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">parquet_filename_fin</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">parquet_filename_pre</a> + <span class="stringliteral">&quot;_final.h5&quot;</span>;</div>
<div class="line"><span class="lineno">  120</span><span class="comment">//state = read_state_from_hdf(parquet_filename, 30);</span></div>
<div class="line"><span class="lineno">  121</span>        <a class="code hl_function" href="#a07f441b6693f6e2e8d958049ae06cb73">parquet_solver</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">parquet_filename_all</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state</a>, Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">version</a>, 1e-6, 100, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">overwrite_old_results</a>, 1.);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>        <a class="code hl_function" href="../../d5/de4/hdf5__routines_8hpp.html#ab7f115126010e4b017eb9e12cd1c29d9">write_state_to_hdf</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">parquet_filename_fin</a>, Lambda, 1, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state</a>); <span class="comment">// save input into 0-th layer of hdf5 file</span></div>
<div class="line"><span class="lineno">  124</span>        <span class="comment">//state.vertex.template symmetry_expand&lt;&#39;a&#39;,true,true&gt;();</span></div>
<div class="line"><span class="lineno">  125</span>        <span class="comment">//state.vertex.save_expanded(data_dir + &quot;ParquetSolution_U_over_Delta=&quot; + std::to_string(U_over_Delta) + &quot;_symmetry_expanded_for_a_left_&quot;);</span></div>
<div class="line"><span class="lineno">  126</span>        <span class="comment">//state.vertex.template symmetry_expand&lt;&#39;p&#39;,true,true&gt;();</span></div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">//state.vertex.save_expanded(data_dir + &quot;ParquetSolution_U_over_Delta=&quot; + std::to_string(U_over_Delta) + &quot;_symmetry_expanded_for_p_left_&quot;);</span></div>
<div class="line"><span class="lineno">  128</span>        <span class="comment">//state.vertex.template symmetry_expand&lt;&#39;t&#39;,true,true&gt;();</span></div>
<div class="line"><span class="lineno">  129</span>        <span class="comment">//state.vertex.save_expanded(data_dir + &quot;ParquetSolution_U_over_Delta=&quot; + std::to_string(U_over_Delta) + &quot;_symmetry_expanded_for_t_left_&quot;)</span></div>
<div class="line"><span class="lineno">  130</span>        <span class="comment">// ;</span></div>
<div class="line"><span class="lineno">  131</span>        <a class="code hl_function" href="../../d6/d84/namespaceutils.html#ad566cc1586ac4598d5823caa71620eb5">utils::print</a>(<span class="stringliteral">&quot;CPU hours for parquet run: \t &quot;</span>);</div>
<div class="line"><span class="lineno">  132</span>        <a class="code hl_function" href="../../d6/d84/namespaceutils.html#a5020e8df3fe9af5189eb7170db07439f">utils::get_cpu_hours</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t_start</a>);</div>
<div class="line"><span class="lineno">  133</span>    }</div>
<div class="line"><span class="lineno">  134</span>}</div>
<div class="ttc" id="afrequency__parameters_8hpp_html_a18fa2894433252528682ce7deae641c1"><div class="ttname"><a href="../../d3/d3c/frequency__parameters_8hpp.html#a18fa2894433252528682ce7deae641c1">nBOS2</a></div><div class="ttdeci">constexpr int nBOS2</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3c/frequency__parameters_8hpp_source.html#l00037">frequency_parameters.hpp:37</a></div></div>
<div class="ttc" id="afrequency__parameters_8hpp_html_a53beecdaf61aae67af4961c402376dc6"><div class="ttname"><a href="../../d3/d3c/frequency__parameters_8hpp.html#a53beecdaf61aae67af4961c402376dc6">nBOS</a></div><div class="ttdeci">constexpr int nBOS</div><div class="ttdoc">determines whether frequency grids are shifted by hartree+epsilon (depending on channel) -&gt; many samp...</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3c/frequency__parameters_8hpp_source.html#l00035">frequency_parameters.hpp:35</a></div></div>
<div class="ttc" id="afrequency__parameters_8hpp_html_acf74a969ffcb98c08a18e0341b82d0dd"><div class="ttname"><a href="../../d3/d3c/frequency__parameters_8hpp.html#acf74a969ffcb98c08a18e0341b82d0dd">nBOS3</a></div><div class="ttdeci">constexpr int nBOS3</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3c/frequency__parameters_8hpp_source.html#l00039">frequency_parameters.hpp:39</a></div></div>
<div class="ttc" id="anamespaceflowgrid_html_ab85047ef8b48a23fc3b5683801788952"><div class="ttname"><a href="../../d4/d5e/namespaceflowgrid.html#ab85047ef8b48a23fc3b5683801788952">flowgrid::get_Lambda_checkpoints</a></div><div class="ttdeci">rvec get_Lambda_checkpoints(const std::vector&lt; double &gt; &amp;Us, const fRG_config &amp;config)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d8d/flow__grid_8c_09_09_source.html#l00014">flow_grid.c++:14</a></div></div>
<div class="ttc" id="anamespaceutils_html_a5020e8df3fe9af5189eb7170db07439f"><div class="ttname"><a href="../../d6/d84/namespaceutils.html#a5020e8df3fe9af5189eb7170db07439f">utils::get_cpu_hours</a></div><div class="ttdeci">void get_cpu_hours(double t0)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d35/util_8c_09_09_source.html#l00048">util.c++:48</a></div></div>
<div class="ttc" id="aparquet__solver_8hpp_html_a07f441b6693f6e2e8d958049ae06cb73"><div class="ttname"><a href="#a07f441b6693f6e2e8d958049ae06cb73">parquet_solver</a></div><div class="ttdeci">bool parquet_solver(const std::string filename, State&lt; Q &gt; &amp;state_in, const double Lambda, const int version, const double accuracy=1e-6, const int Nmax=6, const bool overwrite_old_results=true, const double mixing_ratio=1.0, const bool use_last_state_anyway=false)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0a/parquet__solver_8hpp_source.html#l00659">parquet_solver.hpp:659</a></div></div>
<div class="ttc" id="aperturbation__theory_8hpp_html_a7ac208e8f3c934c5b68264609f81acd4"><div class="ttname"><a href="../../d5/d0d/perturbation__theory_8hpp.html#a7ac208e8f3c934c5b68264609f81acd4">sopt_state</a></div><div class="ttdeci">void sopt_state(State&lt; Q &gt; &amp;Psi, const bool diff=false)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d0d/perturbation__theory_8hpp_source.html#l00156">perturbation_theory.hpp:156</a></div></div>
<div class="ttc" id="astructfRG__config_html_a424d2ec952ccad62dca3f2333a614541"><div class="ttname"><a href="../../da/da0/structfRG__config.html#a424d2ec952ccad62dca3f2333a614541">fRG_config::Gamma</a></div><div class="ttdeci">double Gamma</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00667">data_structures.hpp:667</a></div></div>
<div class="ttc" id="astructfRG__config_html_a4a612c073aced64bd84466bbb875ff3f"><div class="ttname"><a href="../../da/da0/structfRG__config.html#a4a612c073aced64bd84466bbb875ff3f">fRG_config::epsilon</a></div><div class="ttdeci">double epsilon</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00668">data_structures.hpp:668</a></div></div>
<div class="ttc" id="astructfRG__config_html_a650ac47628d97c0bd647de9aef8a7504"><div class="ttname"><a href="../../da/da0/structfRG__config.html#a650ac47628d97c0bd647de9aef8a7504">fRG_config::T</a></div><div class="ttdeci">double T</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00666">data_structures.hpp:666</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00159">data_dir</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00668">fRG_config::epsilon</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00667">fRG_config::Gamma</a>, <a class="el" href="../../d6/d35/util_8c_09_09_source.html#l00048">utils::get_cpu_hours()</a>, <a class="el" href="../../d6/d8d/flow__grid_8c_09_09_source.html#l00014">flowgrid::get_Lambda_checkpoints()</a>, <a class="el" href="../../d6/d35/util_8c_09_09_source.html#l00021">utils::get_time()</a>, <a class="el" href="../../d3/d3c/frequency__parameters_8hpp_source.html#l00035">nBOS</a>, <a class="el" href="../../d3/d3c/frequency__parameters_8hpp_source.html#l00037">nBOS2</a>, <a class="el" href="../../d3/d3c/frequency__parameters_8hpp_source.html#l00039">nBOS3</a>, <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00659">parquet_solver()</a>, <a class="el" href="../../d0/d3f/util_8hpp_source.html#l00025">utils::print()</a>, <a class="el" href="../../d5/d0d/perturbation__theory_8hpp_source.html#l00156">sopt_state()</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00666">fRG_config::T</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00665">fRG_config::U</a>, and <a class="el" href="../../d5/de4/hdf5__routines_8hpp_source.html#l00846">write_state_to_hdf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d0a/main_8cpp_source.html#l00024">main()</a>.</p>

</div>
</div>
<a id="a997236aea73d9935839d4dc8c8fd06af" name="a997236aea73d9935839d4dc8c8fd06af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a997236aea73d9935839d4dc8c8fd06af">&#9670;&#160;</a></span>susceptibilities_postprocessing()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">void</a> susceptibilities_postprocessing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>chi</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d2d/vertex_8hpp.html#a6fe6fa5dc5814b2f7b53f9d7af277c62">Vertex</a>&lt; Q, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">false</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>chi_diff</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d97/classState.html">State</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>state</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>Lambda</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../da/da0/structfRG__config.html">fRG_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the susceptibilities chi_r in channel r from the full vertex, and the differences to the flowing susceptibilities (K1r of the input vertex). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chi_a</td><td>: Post-processed susceptibility in all three channels </td></tr>
    <tr><td class="paramname">chi_diff</td><td>: Differences between flowing and post-processed susceptibility in each channel </td></tr>
    <tr><td class="paramname">state</td><td>: Input state from which susceptibilities are computed </td></tr>
    <tr><td class="paramname">Lambda</td><td>: Flow parameter Lambda at which bubbles are evaluated </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00549">549</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  550</span>                                                                                                           {</div>
<div class="line"><span class="lineno">  551</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> Gamma = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state</a>.<a class="code hl_variable" href="../../d2/d4a/classGeneralVertex.html#a2b9b73449a3d78f260cb929b0be99977">vertex</a>;  <span class="comment">// full vertex (just a redefinition</span></div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>    <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a> (Lambda, config);                     <span class="comment">// bare vertex</span></div>
<div class="line"><span class="lineno">  554</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  555</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>.initialize(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">not</a> <a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a209c004ba9b216412cae0ca89758f1a9">CONTOUR_BASIS</a> ? -config.<a class="code hl_variable" href="../../da/da0/structfRG__config.html#ad9afaf64e087c69bc4f16e49c132b592">U</a> / 2. : -config.U);             <span class="comment">// initialize bare vertex</span></div>
<div class="line"><span class="lineno">  556</span>    <a class="code hl_class" href="../../d2/d34/classPropagator.html">Propagator&lt;Q&gt;</a> G (Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">state</a>.selfenergy, <span class="charliteral">&#39;g&#39;</span>, config);   <span class="comment">// full propagator</span></div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>    <span class="comment">// compute susceptibilities in all three channels</span></div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a> : <span class="stringliteral">&quot;apt&quot;</span>) {</div>
<div class="line"><span class="lineno">  560</span>        <span class="comment">// contribution from the bare bubble</span></div>
<div class="line"><span class="lineno">  561</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_0</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  562</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_0</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  563</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, G, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <span class="keyword">false</span>, config);</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>        <span class="comment">// temporary vertex with full vertex on the right (first: compute half1)</span></div>
<div class="line"><span class="lineno">  566</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma_half1</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  567</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma_half1</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  568</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma_half1</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, Gamma, G, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <span class="keyword">false</span>, config);</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>        <span class="comment">// temporary vertex with full vertex on the left (first: compute half1)</span></div>
<div class="line"><span class="lineno">  571</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0_half1</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  572</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0_half1</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  573</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0_half1</a>, Gamma, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, G, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <span class="keyword">false</span>, config);</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>        <span class="comment">// construct non-symmetric_full vertices out of the two half1 vertices above</span></div>
<div class="line"><span class="lineno">  576</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q, non_symmetric_diffleft,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  577</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma</a>.half1() = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma_half1</a>.half1();</div>
<div class="line"><span class="lineno">  578</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma</a>.half2() = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0_half1</a>.half1();</div>
<div class="line"><span class="lineno">  579</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma</a>.set_only_same_channel(<span class="keyword">true</span>);  <span class="comment">// left/right bubble need to be in the same channel</span></div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">GeneralVertex&lt;Q, non_symmetric_diffright,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  582</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0</a>.half1() = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0_half1</a>.half1();</div>
<div class="line"><span class="lineno">  583</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0</a>.half2() = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma_half1</a>.half1();</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>        <span class="comment">// contribution from the full vertex, with temporary vertex on the left</span></div>
<div class="line"><span class="lineno">  586</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_L</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  587</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_L</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  588</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_L</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma0_Gamma</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, G, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <span class="keyword">false</span>, config);</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>        <span class="comment">// contribution from the full vertex, with temporary vertex on the right</span></div>
<div class="line"><span class="lineno">  591</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_R</a> (Lambda, config);</div>
<div class="line"><span class="lineno">  592</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_R</a>.set_frequency_grid(Gamma);</div>
<div class="line"><span class="lineno">  593</span>        <a class="code hl_function" href="../../de/de8/bubble__function_8hpp.html#af33e47ff22bc507b4226169779a87c95">bubble_function</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_R</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_0</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gamma_Gamma0</a>, G, G, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>, <span class="keyword">false</span>, config);</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>        <span class="comment">// symmetrize left/right contributions</span></div>
<div class="line"><span class="lineno">  596</span>        <a class="code hl_class" href="../../d2/d4a/classGeneralVertex.html">Vertex&lt;Q,false&gt;</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_tot</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_0</a> + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_L</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_R</a>) * 0.5;</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>        <span class="keywordflow">switch</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">r</a>) {</div>
<div class="line"><span class="lineno">  599</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><span class="lineno">  600</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi</a>.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a791568d8a7b0cacf00079d69ec765bae">avertex</a>().K1 = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_tot</a>.avertex().K1;</div>
<div class="line"><span class="lineno">  601</span>                <span class="comment">// compute difference between K1 from input state and post-processed susceptibility</span></div>
<div class="line"><span class="lineno">  602</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_diff</a>.avertex().K1 = Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a791568d8a7b0cacf00079d69ec765bae">avertex</a>().K1 - <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi</a>.avertex().K1;</div>
<div class="line"><span class="lineno">  603</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  604</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line"><span class="lineno">  605</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi</a>.pvertex().K1 = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_tot</a>.pvertex().K1;</div>
<div class="line"><span class="lineno">  606</span>                <span class="comment">// compute difference between K1 from input state and post-processed susceptibility</span></div>
<div class="line"><span class="lineno">  607</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_diff</a>.pvertex().K1 = Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#abec34975a70ef37a932b85ec566fc52b">pvertex</a>().K1 - <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi</a>.pvertex().K1;</div>
<div class="line"><span class="lineno">  608</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  609</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div>
<div class="line"><span class="lineno">  610</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi</a>.tvertex().K1 = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_tot</a>.tvertex().K1;</div>
<div class="line"><span class="lineno">  611</span>                <span class="comment">// compute difference between K1 from input state and post-processed susceptibility</span></div>
<div class="line"><span class="lineno">  612</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi_diff</a>.tvertex().K1 = Gamma.<a class="code hl_function" href="../../d2/d4a/classGeneralVertex.html#a80b79fecedc9c2fb3f7e115dfc658b78">tvertex</a>().K1 - <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">chi</a>.tvertex().K1;</div>
<div class="line"><span class="lineno">  613</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  614</span>            <span class="keywordflow">default</span>:;</div>
<div class="line"><span class="lineno">  615</span>        }</div>
<div class="line"><span class="lineno">  616</span>    }</div>
<div class="line"><span class="lineno">  617</span>}</div>
<div class="ttc" id="aclassGeneralVertex_html_a791568d8a7b0cacf00079d69ec765bae"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#a791568d8a7b0cacf00079d69ec765bae">GeneralVertex::avertex</a></div><div class="ttdeci">rvert&lt; Q &gt; &amp; avertex()</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l00864">vertex.hpp:864</a></div></div>
<div class="ttc" id="aclassGeneralVertex_html_a80b79fecedc9c2fb3f7e115dfc658b78"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#a80b79fecedc9c2fb3f7e115dfc658b78">GeneralVertex::tvertex</a></div><div class="ttdeci">rvert&lt; Q &gt; &amp; tvertex()</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l00866">vertex.hpp:866</a></div></div>
<div class="ttc" id="aclassGeneralVertex_html_abec34975a70ef37a932b85ec566fc52b"><div class="ttname"><a href="../../d2/d4a/classGeneralVertex.html#abec34975a70ef37a932b85ec566fc52b">GeneralVertex::pvertex</a></div><div class="ttdeci">rvert&lt; Q &gt; &amp; pvertex()</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d2d/vertex_8hpp_source.html#l00865">vertex.hpp:865</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l00864">GeneralVertex&lt; Q, symmtype, differentiated &gt;::avertex()</a>, <a class="el" href="../../de/de8/bubble__function_8hpp_source.html#l01046">bubble_function()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00020">CONTOUR_BASIS</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l00865">GeneralVertex&lt; Q, symmtype, differentiated &gt;::pvertex()</a>, <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l00866">GeneralVertex&lt; Q, symmtype, differentiated &gt;::tvertex()</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00665">fRG_config::U</a>, and <a class="el" href="../../d1/d2d/vertex_8hpp_source.html#l00456">GeneralVertex&lt; Q, symmtype, differentiated &gt;::vertex</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d94/parquet__solver_8c_09_09_source.html#l00003">parquet_checks()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ade72d4c0a25548ba8cb4c0dcd8950b65" name="ade72d4c0a25548ba8cb4c0dcd8950b65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade72d4c0a25548ba8cb4c0dcd8950b65">&#9670;&#160;</a></span>SDE_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SDE_counter = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00065">65</a> of file <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html">parquet_solver.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00462">compute_SDE()</a>, and <a class="el" href="../../dd/d0a/parquet__solver_8hpp_source.html#l00659">parquet_solver()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_a52d1cf80d7db40ef5e5f9f8a0f1d837.html">perturbation_theory_and_parquet</a></li><li class="navelem"><a class="el" href="../../dd/d0a/parquet__solver_8hpp.html">parquet_solver.hpp</a></li>
    <li class="footer">Generated on Tue May 7 2024 12:59:24 for SIAM-Keldysh-mfRG by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
