<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.10.0" xml:lang="en-US">
  <compounddef id="dd/d0a/parquet__solver_8hpp" kind="file" language="C++">
    <compoundname>parquet_solver.hpp</compoundname>
    <includes local="no">string</includes>
    <includes local="no">deque</includes>
    <includes refid="d1/df8/master__parameters_8hpp" local="yes">../parameters/master_parameters.hpp</includes>
    <includes refid="d5/dd1/flow__grid_8hpp" local="yes">../grids/flow_grid.hpp</includes>
    <includes refid="da/d3b/state_8hpp" local="yes">../correlation_functions/state.hpp</includes>
    <includes refid="d1/d2d/vertex_8hpp" local="yes">../correlation_functions/four_point/vertex.hpp</includes>
    <includes refid="d6/d2d/selfenergy_8hpp" local="yes">../correlation_functions/two_point/selfenergy.hpp</includes>
    <includes refid="d5/de4/hdf5__routines_8hpp" local="yes">../utilities/hdf5_routines.hpp</includes>
    <includes refid="de/de8/bubble__function_8hpp" local="yes">../bubble/bubble_function.hpp</includes>
    <includes refid="d8/d1d/loop_8hpp" local="yes">../loop/loop.hpp</includes>
    <includes refid="d1/d75/causality__FDT__checks_8hpp" local="yes">../postprocessing/causality_FDT_checks.hpp</includes>
    <includes refid="d5/d0d/perturbation__theory_8hpp" local="yes">perturbation_theory.hpp</includes>
    <includes refid="d6/d7b/anderson__acceleration_8hpp" local="yes">../utilities/anderson_acceleration.hpp</includes>
    <includes refid="d2/d3f/sanity__check_8hpp" local="yes">../postprocessing/sanity_check.hpp</includes>
    <includedby refid="d5/d21/flow_8hpp" local="yes">flow.hpp</includedby>
    <includedby refid="df/d0a/main_8cpp" local="yes">main.cpp</includedby>
    <includedby refid="dd/d00/main__postproc_8cpp" local="yes">main_postproc.cpp</includedby>
    <includedby refid="d5/d94/parquet__solver_8c_09_09" local="yes">parquet_solver.c++</includedby>
    <includedby refid="d8/dea/right__hand__sides_8hpp" local="yes">right_hand_sides.hpp</includedby>
    <incdepgraph>
      <node id="73">
        <label>bubble_corrections.hpp</label>
        <link refid="dd/dea/bubble__corrections_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="72">
        <label>../asymptotic_corrections/correction_functions.hpp</label>
        <link refid="d2/df0/correction__functions_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="73" relation="include">
        </childnode>
        <childnode refid="74" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
      </node>
      <node id="74">
        <label>loop_corrections.hpp</label>
        <link refid="d0/d0e/loop__corrections_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="73" relation="include">
        </childnode>
      </node>
      <node id="75">
        <label>bubble.hpp</label>
        <link refid="d0/dac/bubble_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="72" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
      </node>
      <node id="71">
        <label>../bubble/bubble_function.hpp</label>
        <link refid="de/de8/bubble__function_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="72" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="75" relation="include">
        </childnode>
        <childnode refid="76" relation="include">
        </childnode>
      </node>
      <node id="76">
        <label>integrand.hpp</label>
        <link refid="df/d83/integrand_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="72" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="75" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
      </node>
      <node id="37">
        <label>r_vertex.hpp</label>
        <link refid="d3/d22/r__vertex_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
      </node>
      <node id="35">
        <label>four_point/vertex.hpp</label>
        <link refid="d1/d2d/vertex_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
      </node>
      <node id="50">
        <label>../n_point/data_buffer.hpp</label>
        <link refid="dc/d80/data__buffer_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
        <childnode refid="56" relation="include">
        </childnode>
      </node>
      <node id="51">
        <label>data_container.hpp</label>
        <link refid="da/dbc/data__container_8hpp"/>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
      </node>
      <node id="34">
        <label>../correlation_functions/state.hpp</label>
        <link refid="da/d3b/state_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="62" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="69" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="61">
        <label>two_point/propagator.hpp</label>
        <link refid="d5/df7/propagator_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
      </node>
      <node id="57">
        <label>two_point/selfenergy.hpp</label>
        <link refid="d6/d2d/selfenergy_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="58" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>../data_structures.hpp</label>
        <link refid="d7/d59/data__structures_8hpp"/>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>../grids/flow_grid.hpp</label>
        <link refid="d5/dd1/flow__grid_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="39">
        <label>../grids/frequency_grid.hpp</label>
        <link refid="d5/d39/frequency__grid_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
      </node>
      <node id="63">
        <label>../integrator/integrator.hpp</label>
        <link refid="dd/d1f/integrator_8hpp"/>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="64" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="65" relation="include">
        </childnode>
        <childnode refid="66" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
      </node>
      <node id="66">
        <label>integrator_NR.hpp</label>
        <link refid="da/db4/integrator__NR_8hpp"/>
        <childnode refid="67" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="65">
        <label>old_integrators.hpp</label>
        <link refid="d7/d65/old__integrators_8hpp"/>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="52">
        <label>../../interpolations/InterpolatorLinOrSloppy.hpp</label>
        <link refid="d3/d17/InterpolatorLinOrSloppy_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
      </node>
      <node id="53">
        <label>../../interpolations/InterpolatorSpline1D.hpp</label>
        <link refid="d1/d52/InterpolatorSpline1D_8hpp"/>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="55">
        <label>../../interpolations/InterpolatorSpline2D.hpp</label>
        <link refid="d6/d91/InterpolatorSpline2D_8hpp"/>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="56">
        <label>../../interpolations/InterpolatorSpline3D.hpp</label>
        <link refid="dd/dcc/InterpolatorSpline3D_8hpp"/>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="78">
        <label>integrandSE.hpp</label>
        <link refid="de/d65/integrandSE_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="72" relation="include">
        </childnode>
        <childnode refid="70" relation="include">
        </childnode>
      </node>
      <node id="77">
        <label>../loop/loop.hpp</label>
        <link refid="d8/d1d/loop_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="72" relation="include">
        </childnode>
        <childnode refid="78" relation="include">
        </childnode>
        <childnode refid="70" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>../multidimensional/multiarray.hpp</label>
        <link refid="df/da4/multiarray_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="84">
        <label>../multidimensional/ranged_view.hpp</label>
        <link refid="dd/df3/ranged__view_8hpp"/>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>frequency_parameters.hpp</label>
        <link refid="d3/d3c/frequency__parameters_8hpp"/>
      </node>
      <node id="4">
        <label>../parameters/master_parameters.hpp</label>
        <link refid="d1/df8/master__parameters_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>technical_parameters.hpp</label>
        <link refid="d9/d3a/technical__parameters_8hpp"/>
      </node>
      <node id="62">
        <label>../perturbation_theory_and_parquet/hartree_term.hpp</label>
        <link refid="d1/db3/hartree__term_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="68" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>parquet_solver.hpp</label>
        <link refid="dd/d0a/parquet__solver_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="70" relation="include">
        </childnode>
        <childnode refid="71" relation="include">
        </childnode>
        <childnode refid="77" relation="include">
        </childnode>
        <childnode refid="79" relation="include">
        </childnode>
        <childnode refid="80" relation="include">
        </childnode>
        <childnode refid="81" relation="include">
        </childnode>
        <childnode refid="82" relation="include">
        </childnode>
      </node>
      <node id="80">
        <label>perturbation_theory.hpp</label>
        <link refid="d5/d0d/perturbation__theory_8hpp"/>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="71" relation="include">
        </childnode>
        <childnode refid="77" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="70" relation="include">
        </childnode>
      </node>
      <node id="83">
        <label>KramersKronig.hpp</label>
        <link refid="d1/db3/KramersKronig_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="84" relation="include">
        </childnode>
      </node>
      <node id="79">
        <label>../postprocessing/causality_FDT_checks.hpp</label>
        <link refid="d1/d75/causality__FDT__checks_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="70" relation="include">
        </childnode>
      </node>
      <node id="85">
        <label>postprocessing.hpp</label>
        <link refid="d4/d81/postprocessing_8hpp"/>
        <childnode refid="70" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="83" relation="include">
        </childnode>
        <childnode refid="71" relation="include">
        </childnode>
      </node>
      <node id="82">
        <label>../postprocessing/sanity_check.hpp</label>
        <link refid="d2/d3f/sanity__check_8hpp"/>
        <childnode refid="83" relation="include">
        </childnode>
        <childnode refid="85" relation="include">
        </childnode>
        <childnode refid="79" relation="include">
        </childnode>
      </node>
      <node id="38">
        <label>../../symmetries/Keldysh_symmetries.hpp</label>
        <link refid="d2/d1a/Keldysh__symmetries_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="41">
        <label>../../symmetries/internal_symmetries.hpp</label>
        <link refid="d1/dfd/internal__symmetries_8hpp"/>
      </node>
      <node id="43">
        <label>../../symmetries/symmetry_table.hpp</label>
        <link refid="d3/d77/symmetry__table_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="42">
        <label>../../symmetries/symmetry_transformations.hpp</label>
        <link refid="db/d7d/symmetry__transformations_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="81">
        <label>../utilities/anderson_acceleration.hpp</label>
        <link refid="d6/d7b/anderson__acceleration_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
      </node>
      <node id="70">
        <label>../utilities/hdf5_routines.hpp</label>
        <link refid="d5/de4/hdf5__routines_8hpp"/>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>../utilities/math_utils.hpp</label>
        <link refid="de/dbb/math__utils_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="44">
        <label>../../utilities/minimizer.hpp</label>
        <link refid="d4/d21/minimizer_8hpp"/>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>mpi_setup.hpp</label>
        <link refid="db/de0/mpi__setup_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
      </node>
      <node id="23">
        <label>runtime_error.hpp</label>
        <link refid="d1/d64/runtime__error_8hpp"/>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>../utilities/template_utils.hpp</label>
        <link refid="dd/de3/template__utils_8hpp"/>
      </node>
      <node id="25">
        <label>util.hpp</label>
        <link refid="d0/d3f/util_8hpp"/>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
      </node>
      <node id="59">
        <label>../../utilities/write_data2file.hpp</label>
        <link refid="d8/d74/write__data2file_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="60" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>Eigen/Dense</label>
      </node>
      <node id="40">
        <label>H5Cpp.h</label>
      </node>
      <node id="33">
        <label>algorithm</label>
      </node>
      <node id="7">
        <label>array</label>
      </node>
      <node id="29">
        <label>bits/stdc++.h</label>
      </node>
      <node id="69">
        <label>boost/numeric/odeint.hpp</label>
      </node>
      <node id="15">
        <label>cassert</label>
      </node>
      <node id="27">
        <label>chrono</label>
      </node>
      <node id="5">
        <label>cmath</label>
      </node>
      <node id="12">
        <label>complex</label>
      </node>
      <node id="54">
        <label>cstdio</label>
      </node>
      <node id="3">
        <label>deque</label>
      </node>
      <node id="20">
        <label>exception</label>
      </node>
      <node id="60">
        <label>fstream</label>
      </node>
      <node id="14">
        <label>functional</label>
      </node>
      <node id="46">
        <label>gsl/gsl_errno.h</label>
      </node>
      <node id="64">
        <label>gsl/gsl_integration.h</label>
      </node>
      <node id="47">
        <label>gsl/gsl_math.h</label>
      </node>
      <node id="48">
        <label>gsl/gsl_min.h</label>
      </node>
      <node id="49">
        <label>gsl/gsl_multimin.h</label>
      </node>
      <node id="13">
        <label>initializer_list</label>
      </node>
      <node id="21">
        <label>iostream</label>
      </node>
      <node id="67">
        <label>limits</label>
      </node>
      <node id="32">
        <label>mpi.h</label>
      </node>
      <node id="16">
        <label>numeric</label>
      </node>
      <node id="58">
        <label>omp.h</label>
      </node>
      <node id="24">
        <label>stdexcept</label>
      </node>
      <node id="45">
        <label>stdio.h</label>
      </node>
      <node id="2">
        <label>string</label>
      </node>
      <node id="30">
        <label>sys/stat.h</label>
      </node>
      <node id="26">
        <label>sys/time.h</label>
      </node>
      <node id="36">
        <label>type_traits</label>
      </node>
      <node id="28">
        <label>unistd.h</label>
      </node>
      <node id="68">
        <label>utility</label>
      </node>
      <node id="6">
        <label>vector</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="3">
        <label>main.cpp</label>
        <link refid="df/d0a/main_8cpp"/>
      </node>
      <node id="2">
        <label>flow.hpp</label>
        <link refid="d5/d21/flow_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>right_hand_sides.hpp</label>
        <link refid="d8/dea/right__hand__sides_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>parquet_solver.c++</label>
        <link refid="d5/d94/parquet__solver_8c_09_09"/>
      </node>
      <node id="1">
        <label>parquet_solver.hpp</label>
        <link refid="dd/d0a/parquet__solver_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>main_postproc.cpp</label>
        <link refid="dd/d00/main__postproc_8cpp"/>
      </node>
    </invincdepgraph>
    <sectiondef kind="var">
      <memberdef kind="variable" id="dd/d0a/parquet__solver_8hpp_1ade72d4c0a25548ba8cb4c0dcd8950b65" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int SDE_counter</definition>
        <argsstring></argsstring>
        <name>SDE_counter</name>
        <initializer>= 0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="65" column="12" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="65" bodyend="-1"/>
        <referencedby refid="dd/d0a/parquet__solver_8hpp_1a9ef507c1d49fff7991752cab04374824" compoundref="dd/d0a/parquet__solver_8hpp" startline="462" endline="490">compute_SDE</referencedby>
        <referencedby refid="dd/d0a/parquet__solver_8hpp_1a07f441b6693f6e2e8d958049ae06cb73" compoundref="dd/d0a/parquet__solver_8hpp" startline="659" endline="808">parquet_solver</referencedby>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a1541a0b7d193f70577c5fab1efc216e1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void compute_BSE</definition>
        <argsstring>(Vertex&lt; Q, false &gt; &amp;Gamma_BSE, Vertex&lt; Q, false &gt; &amp;Gamma_BSE_L, Vertex&lt; Q, false &gt; &amp;Gamma_BSE_R, const State&lt; Q &gt; &amp;state_in, const double Lambda)</argsstring>
        <name>compute_BSE</name>
        <param>
          <type><ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref> &gt; &amp;</type>
          <declname>Gamma_BSE</declname>
        </param>
        <param>
          <type><ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref> &gt; &amp;</type>
          <declname>Gamma_BSE_L</declname>
        </param>
        <param>
          <type><ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref> &gt; &amp;</type>
          <declname>Gamma_BSE_R</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Insert the vertex of input &quot;state&quot; into the rhs of the (symmetrized) Bethe-Salpeter equation and compute the lhs. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>Gamma_BSE</parametername>
</parameternamelist>
<parameterdescription>
<para>: Vertex computed as the lhs of the BSE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Gamma_BSE_L</parametername>
</parameternamelist>
<parameterdescription>
<para>: Vertex computed as the lhs of the BSE, with Ir on the left and full Gamma on the right </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Gamma_BSE_R</parametername>
</parameternamelist>
<parameterdescription>
<para>: Vertex computed as the lhs of the BSE, with Ir on the right and full Gamma on the left </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>state_in</parametername>
</parameternamelist>
<parameterdescription>
<para>: Input state for which to check the BSE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Lambda</parametername>
</parameternamelist>
<parameterdescription>
<para>: Flow parameter Lambda at which input state was computed </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="28" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="28" bodyend="62"/>
        <references refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" compoundref="de/de8/bubble__function_8hpp" startline="1046" endline="1071">bubble_function</references>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1a971bae9902862f2a2e1379520ee2d2bf" compoundref="d1/df8/master__parameters_8hpp" startline="11">DEBUG_SYMMETRIES</references>
        <references refid="d2/d4a/classGeneralVertex_1a66e3aa65eda2c853832d6a3942ec69e8" compoundref="d1/d2d/vertex_8hpp" startline="1014" endline="1014">GeneralVertex&lt; Q, symmtype, differentiated &gt;::norm_K1</references>
        <references refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" compoundref="d0/d3f/util_8hpp" startline="25" endline="38">utils::print</references>
        <references refid="d1/df8/master__parameters_8hpp_1a8e29bcd96e548a3249a0a93917debc8b" compoundref="d1/df8/master__parameters_8hpp" startline="35">SBE_DECOMPOSITION</references>
        <references refid="d2/d4a/classGeneralVertex_1aed8132ff4fc8418ee884d39035153e9e" compoundref="d1/d2d/vertex_8hpp" startline="1029" endline="1032">GeneralVertex&lt; Q, symmtype, differentiated &gt;::set_Ir</references>
        <references refid="d2/d4a/classGeneralVertex_1a2b9b73449a3d78f260cb929b0be99977" compoundref="d1/d2d/vertex_8hpp" startline="456">GeneralVertex&lt; Q, symmtype, differentiated &gt;::vertex</references>
        <referencedby refid="dd/d0a/parquet__solver_8hpp_1a97f702e04f1c5d26a95211570c003781" compoundref="dd/d0a/parquet__solver_8hpp" startline="73" endline="87">compute_BSE</referencedby>
        <referencedby refid="d5/d94/parquet__solver_8c_09_09_1a9abfea4a26adefdf395729c7604b5842" compoundref="d5/d94/parquet__solver_8c_09_09" startline="3" endline="97">parquet_checks</referencedby>
        <referencedby refid="dd/d0a/parquet__solver_8hpp_1aad1680ae03adc0f566df945376e95234" compoundref="dd/d0a/parquet__solver_8hpp" startline="635" endline="645">parquet_iteration</referencedby>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a97f702e04f1c5d26a95211570c003781" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void compute_BSE</definition>
        <argsstring>(Vertex&lt; Q, false &gt; &amp;Gamma_BSE, const State&lt; Q &gt; &amp;state_in, const double Lambda, const int it_Lambda)</argsstring>
        <name>compute_BSE</name>
        <param>
          <type><ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref> &gt; &amp;</type>
          <declname>Gamma_BSE</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> int</type>
          <declname>it_Lambda</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Wrapper for the above function, with only the symmetrized result Gamma_BSE returned. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>Gamma_BSE</parametername>
</parameternamelist>
<parameterdescription>
<para>: Vertex computed as the lhs of the BSE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>state_in</parametername>
</parameternamelist>
<parameterdescription>
<para>: Input state for which to check the BSE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Lambda</parametername>
</parameternamelist>
<parameterdescription>
<para>: Flow parameter Lambda at which input state was computed </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="73" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="73" bodyend="87"/>
        <references refid="d5/de4/hdf5__routines_8hpp_1afcbe2c8a768f64e576f593516262d476" compoundref="d5/de4/hdf5__routines_8hpp" startline="872" endline="895">add_state_to_hdf</references>
        <references refid="dd/d0a/parquet__solver_8hpp_1a1541a0b7d193f70577c5fab1efc216e1" compoundref="dd/d0a/parquet__solver_8hpp" startline="28" endline="62">compute_BSE</references>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" compoundref="d1/df8/master__parameters_8hpp" startline="159">data_dir</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a1a17567ec5d9df767870c3a7489f64a1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>char</type>
            <declname>channel</declname>
            <defname>channel</defname>
          </param>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt;</type>
        <definition>SelfEnergy&lt; Q &gt; compute_SDE_impl</definition>
        <argsstring>(const double Lambda, const Vertex&lt; Q, false &gt; &amp;Gamma, const Propagator&lt; Q &gt; &amp;G_bubble, const Propagator&lt; Q &gt; &amp;G_loop, const fRG_config &amp;config)</argsstring>
        <name>compute_SDE_impl</name>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref> &gt; &amp;</type>
          <declname>Gamma</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d2/d34/classPropagator" kindref="compound">Propagator</ref>&lt; Q &gt; &amp;</type>
          <declname>G_bubble</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d2/d34/classPropagator" kindref="compound">Propagator</ref>&lt; Q &gt; &amp;</type>
          <declname>G_loop</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>compute the (non-differentiated) SDE by forming a bubble in channel r --&gt; 0.5*(B_r(Gamma_0, Gamma)+B_r(Gamma, Gamma_0)) and close the loop over the result </para>
        </detaileddescription>
        <inbodydescription>
<para>make sure that integrand only contains K1r + K2r + K2br</para>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="92" column="12" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="92" bodyend="178"/>
        <references refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" compoundref="de/de8/bubble__function_8hpp" startline="1046" endline="1071">bubble_function</references>
        <references refid="d1/df8/master__parameters_8hpp_1a209c004ba9b216412cae0ca89758f1a9" compoundref="d1/df8/master__parameters_8hpp" startline="20">CONTOUR_BASIS</references>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e" compoundref="d7/d59/data__structures_8hpp" startline="480">k1</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb" compoundref="d7/d59/data__structures_8hpp" startline="480">k2</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021" compoundref="d7/d59/data__structures_8hpp" startline="480">k2b</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90" compoundref="d7/d59/data__structures_8hpp" startline="480">k3</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2" compoundref="d7/d59/data__structures_8hpp" startline="480">k3_sbe</references>
        <references refid="d1/df8/master__parameters_8hpp_1afab5195e3ffff420d211040e5672fcbe" compoundref="d1/df8/master__parameters_8hpp" startline="137">KELDYSH</references>
        <references refid="d2/d4a/classGeneralVertex_1a5d8cc30ab164e0d65f110c36c64f8974" compoundref="d1/d2d/vertex_8hpp" startline="1071" endline="1073">GeneralVertex&lt; Q, symmtype, differentiated &gt;::swap_vanishing_component_channel_a_and_t</references>
        <references refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" compoundref="d7/d59/data__structures_8hpp" startline="650">fRG_config::U</references>
        <references refid="d2/d4a/classGeneralVertex_1adb8112bdc5f8e012552d215c2a670eef" compoundref="d1/d2d/vertex_8hpp" startline="1061">GeneralVertex&lt; Q, symmtype, differentiated &gt;::vanishing_component_gamma0</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a975283a2a8d88b37c80ee3d2f39e68c3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>char</type>
            <declname>channel</declname>
            <defname>channel</defname>
          </param>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void compute_SDE_impl_v1</definition>
        <argsstring>(SelfEnergy&lt; Q &gt; &amp;Sigma_SDE, const State&lt; Q &gt; &amp;state_in, const double Lambda, const fRG_config &amp;config)</argsstring>
        <name>compute_SDE_impl_v1</name>
        <param>
          <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>Sigma_SDE</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
<para>prepare vertex  for computing 0.5 * [L_i( B_r(_0, _0 + _r) + B_r(_0 + _r, _0), G)] using compute_SDE_impl&lt;channel&gt;(...)</para>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="182" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="182" bodyend="200"/>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e" compoundref="d7/d59/data__structures_8hpp" startline="480">k1</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb" compoundref="d7/d59/data__structures_8hpp" startline="480">k2</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021" compoundref="d7/d59/data__structures_8hpp" startline="480">k2b</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90" compoundref="d7/d59/data__structures_8hpp" startline="480">k3</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2" compoundref="d7/d59/data__structures_8hpp" startline="480">k3_sbe</references>
        <references refid="d2/d4a/classGeneralVertex_1a2b9b73449a3d78f260cb929b0be99977" compoundref="d1/d2d/vertex_8hpp" startline="456">GeneralVertex&lt; Q, symmtype, differentiated &gt;::vertex</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a7e421b1e2c3e3c8fbaa9fe1600a2ef54" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void compute_SDE_v1</definition>
        <argsstring>(SelfEnergy&lt; Q &gt; &amp;Sigma_SDE, const State&lt; Q &gt; &amp;state_in, const double Lambda, const fRG_config &amp;config)</argsstring>
        <name>compute_SDE_v1</name>
        <param>
          <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>Sigma_SDE</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>compute the (non-differentiated) SDE by splitting up the full vertex in  = R + _a + _p + _t form the bubble in the &apos;natural&apos; channels and close the loop accordingly i.e.  = L_0( B_a(_0, _0), G) + L_0( B_a(_0, _a), G) + L_0( B_p(_0, _p), G) + L_1( B_t(_0, _t), G) where L_i stands for a loop with version i and B_r for a bubble in channel r (everything with non-differentiated full propagators G) </para>
        </detaileddescription>
        <inbodydescription>
<para>Problem: To read out certain Keldysh components we use the transformations T1 and T2 (exchange symmetry) This switches between the channels a and t ==&gt; We cannot split up the a- and the t-channel Rather, we would need to compute the intermediate bubble both in the a- and the t-channel In Matsubara the symmetry tables for the updown spin-component don&apos;t contain these transformations that transform between different channels</para>
<para>TODO(micro-optimization): write SDE in the way that Fabian likes:</para>
<para>Compute B(Gamma0, gamma_t)^upup directly and store it at the location where we actually store updown. Then let the loop read out the upup Komponent from this place. (There should be no issues with the symmetries.)</para>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="207" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="207" bodyend="226"/>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1afe5b9519474c166967ed13d6791538b9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void compute_SDE_impl_v2</definition>
        <argsstring>(SelfEnergy&lt; Q &gt; &amp;Sigma_SDE, SelfEnergy&lt; Q &gt; &amp;Sigma_SDE_a, SelfEnergy&lt; Q &gt; &amp;Sigma_SDE_p, const State&lt; Q &gt; &amp;state_in, const double Lambda, const fRG_config &amp;config)</argsstring>
        <name>compute_SDE_impl_v2</name>
        <param>
          <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>Sigma_SDE</declname>
        </param>
        <param>
          <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>Sigma_SDE_a</declname>
        </param>
        <param>
          <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>Sigma_SDE_p</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Insert the self-energy of input &quot;state&quot; into the rhs of the (symmetrized) Schwinger-Dyson equation and compute the lhs. Original implementation of SDE corresponds to --&gt; 0.5*[compute_SDE_impl(&apos;a&apos;, ...)+compute_SDE_impl(&apos;p&apos;, ...)] <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>Sigma_SDE</parametername>
</parameternamelist>
<parameterdescription>
<para>: Self-energy computed as the lhs of the BSE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Sigma_SDE_a</parametername>
</parameternamelist>
<parameterdescription>
<para>: self-energy computed from an a bubble (symmetrized w.r.t full vertex on the left/right) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Sigma_SDE_p</parametername>
</parameternamelist>
<parameterdescription>
<para>: self-energy computed from a p bubble (symmetrized w.r.t full vertex on the left/right) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>state_in</parametername>
</parameternamelist>
<parameterdescription>
<para>: Input state for which to check the SDE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Lambda</parametername>
</parameternamelist>
<parameterdescription>
<para>: Flow parameter Lambda at which input state was computed </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
<para>alternative to below code (does the same stuff in more compact code):</para>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="239" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="239" bodyend="343"/>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <referencedby refid="dd/d0a/parquet__solver_8hpp_1aa738db4c50d72d9475911cf0dfce2bad" compoundref="dd/d0a/parquet__solver_8hpp" startline="444" endline="458">compute_SDE_v2</referencedby>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a5ab14a76538cdb69001c01f9ebf492ca" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>char</type>
            <declname>channel</declname>
            <defname>channel</defname>
          </param>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void check_selfconsistency_of_K1K2</definition>
        <argsstring>(const Vertex&lt; Q, false &gt; &amp;Gamma, double Lambda, const Propagator&lt; Q &gt; G_bubble, const fRG_config &amp;config)</argsstring>
        <name>check_selfconsistency_of_K1K2</name>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref> &gt; &amp;</type>
          <declname>Gamma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d2/d34/classPropagator" kindref="compound">Propagator</ref>&lt; Q &gt;</type>
          <declname>G_bubble</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
<para>is bubble_l.K1+K2_r identical to Gamma.K1+K2_r ?</para>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="346" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="346" bodyend="373"/>
        <references refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" compoundref="de/de8/bubble__function_8hpp" startline="1046" endline="1071">bubble_function</references>
        <references refid="d1/df8/master__parameters_8hpp_1a209c004ba9b216412cae0ca89758f1a9" compoundref="d1/df8/master__parameters_8hpp" startline="20">CONTOUR_BASIS</references>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1afab5195e3ffff420d211040e5672fcbe" compoundref="d1/df8/master__parameters_8hpp" startline="137">KELDYSH</references>
        <references refid="d2/d4a/classGeneralVertex_1a5d8cc30ab164e0d65f110c36c64f8974" compoundref="d1/d2d/vertex_8hpp" startline="1071" endline="1073">GeneralVertex&lt; Q, symmtype, differentiated &gt;::swap_vanishing_component_channel_a_and_t</references>
        <references refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" compoundref="d7/d59/data__structures_8hpp" startline="650">fRG_config::U</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a947824a1a735bc2e9db735348ac9dd2c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="d9/db9/classbool" kindref="compound">bool</ref></type>
            <declname>version</declname>
            <defname>version</defname>
          </param>
          <param>
            <type><ref refid="d9/db9/classbool" kindref="compound">bool</ref></type>
            <declname>is_differentiated_vertex</declname>
            <defname>is_differentiated_vertex</defname>
          </param>
          <param>
            <type><ref refid="d9/db9/classbool" kindref="compound">bool</ref></type>
            <declname>is_differentiated_SE</declname>
            <defname>is_differentiated_SE</defname>
          </param>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt;</type>
        <definition>SelfEnergy&lt; Q &gt; compute_SDE_impl_v3</definition>
        <argsstring>(const char channel, const double Lambda, const Vertex&lt; Q, is_differentiated_vertex &gt; &amp;Gamma, const Propagator&lt; Q &gt; &amp;G_loop, const fRG_config &amp;config)</argsstring>
        <name>compute_SDE_impl_v3</name>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> char</type>
          <declname>channel</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_differentiated_vertex</ref> &gt; &amp;</type>
          <declname>Gamma</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d2/d34/classPropagator" kindref="compound">Propagator</ref>&lt; Q &gt; &amp;</type>
          <declname>G_loop</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
<para>Compute the SDE by closing the loop over K1a+K2a or K1p+K2p. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="377" column="12" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="377" bodyend="408"/>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1a971bae9902862f2a2e1379520ee2d2bf" compoundref="d1/df8/master__parameters_8hpp" startline="11">DEBUG_SYMMETRIES</references>
        <references refid="d2/d4a/classGeneralVertex_1abb8396f63f5f6ea6c66371d9075bdc28" compoundref="d1/d2d/vertex_8hpp" startline="861" endline="861">GeneralVertex&lt; Q, symmtype, differentiated &gt;::get_vertex_nondiff</references>
        <references refid="d2/d4a/classGeneralVertex_1a914996279b86330de5331fb018eb3f60" compoundref="d1/d2d/vertex_8hpp" startline="857" endline="857">GeneralVertex&lt; Q, symmtype, differentiated &gt;::half1</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e" compoundref="d7/d59/data__structures_8hpp" startline="480">k1</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb" compoundref="d7/d59/data__structures_8hpp" startline="480">k2</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021" compoundref="d7/d59/data__structures_8hpp" startline="480">k2b</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90" compoundref="d7/d59/data__structures_8hpp" startline="480">k3</references>
        <references refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2" compoundref="d7/d59/data__structures_8hpp" startline="480">k3_sbe</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1ac50fa9495cb7f051e0b03aefd35993c4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void compute_SDE_v3</definition>
        <argsstring>(SelfEnergy&lt; Q &gt; &amp;Sigma_SDE, const State&lt; Q &gt; &amp;state_in, const double Lambda, const fRG_config &amp;config)</argsstring>
        <name>compute_SDE_v3</name>
        <param>
          <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>Sigma_SDE</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
<para>Save results via a- and p-channel separately:</para>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="412" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="412" bodyend="434"/>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" compoundref="d0/d3f/util_8hpp" startline="25" endline="38">utils::print</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1aa738db4c50d72d9475911cf0dfce2bad" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void compute_SDE_v2</definition>
        <argsstring>(SelfEnergy&lt; Q &gt; &amp;Sigma_SDE, const State&lt; Q &gt; &amp;state_in, const double Lambda, const fRG_config &amp;config)</argsstring>
        <name>compute_SDE_v2</name>
        <param>
          <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>Sigma_SDE</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Wrapper for the above function, with only the total (symmetrized) result Sigma_SDE returned. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>Sigma_SDE</parametername>
</parameternamelist>
<parameterdescription>
<para>: Self-energy computed as the lhs of the BSE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>state_in</parametername>
</parameternamelist>
<parameterdescription>
<para>: Input state for which to check the SDE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Lambda</parametername>
</parameternamelist>
<parameterdescription>
<para>: Flow parameter Lambda at which input state was computed </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="444" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="444" bodyend="458"/>
        <references refid="dd/d0a/parquet__solver_8hpp_1afe5b9519474c166967ed13d6791538b9" compoundref="dd/d0a/parquet__solver_8hpp" startline="239" endline="343">compute_SDE_impl_v2</references>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" compoundref="d0/d3f/util_8hpp" startline="25" endline="38">utils::print</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a9ef507c1d49fff7991752cab04374824" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void compute_SDE</definition>
        <argsstring>(SelfEnergy&lt; Q &gt; &amp;Sigma_SDE, const State&lt; Q &gt; &amp;state_in, const double Lambda, int version)</argsstring>
        <name>compute_SDE</name>
        <param>
          <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>Sigma_SDE</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type>int</type>
          <declname>version</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
<para>Pick your favorite version:</para>
<para>Compute the Hartree term</para>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="462" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="462" bodyend="490"/>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1ac209459b6113297c093b5c50febc47ad" compoundref="d1/df8/master__parameters_8hpp" startline="148">PARTICLE_HOLE_SYMMETRY</references>
        <references refid="dd/d0a/parquet__solver_8hpp_1ade72d4c0a25548ba8cb4c0dcd8950b65" compoundref="dd/d0a/parquet__solver_8hpp" startline="65">SDE_counter</references>
        <referencedby refid="d5/d94/parquet__solver_8c_09_09_1a9abfea4a26adefdf395729c7604b5842" compoundref="d5/d94/parquet__solver_8c_09_09" startline="3" endline="97">parquet_checks</referencedby>
        <referencedby refid="dd/d0a/parquet__solver_8hpp_1aad1680ae03adc0f566df945376e95234" compoundref="dd/d0a/parquet__solver_8hpp" startline="635" endline="645">parquet_iteration</referencedby>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1ad9258c4214b31ccef74aad6764dc4db5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt;</type>
        <definition>SelfEnergy&lt; Q &gt; compute_diff_SDE</definition>
        <argsstring>(const State&lt; Q &gt; &amp;state_in, const Vertex&lt; Q, true &gt; &amp;dGamma, const SelfEnergy&lt; Q &gt; &amp;dSigma)</argsstring>
        <name>compute_diff_SDE</name>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">true</ref> &gt; &amp;</type>
          <declname>dGamma</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy</ref>&lt; Q &gt; &amp;</type>
          <declname>dSigma</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="494" column="12" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="494" bodyend="535"/>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" compoundref="d1/df8/master__parameters_8hpp" startline="159">data_dir</references>
        <references refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" compoundref="d5/de4/hdf5__routines_8hpp" startline="425" endline="440">write_to_hdf</references>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a997236aea73d9935839d4dc8c8fd06af" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void susceptibilities_postprocessing</definition>
        <argsstring>(Vertex&lt; Q, false &gt; &amp;chi, Vertex&lt; Q, false &gt; &amp;chi_diff, const State&lt; Q &gt; &amp;state, const double Lambda, const fRG_config &amp;config)</argsstring>
        <name>susceptibilities_postprocessing</name>
        <param>
          <type><ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref> &gt; &amp;</type>
          <declname>chi</declname>
        </param>
        <param>
          <type><ref refid="d1/d2d/vertex_8hpp_1a6fe6fa5dc5814b2f7b53f9d7af277c62" kindref="member">Vertex</ref>&lt; Q, <ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref> &gt; &amp;</type>
          <declname>chi_diff</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Compute the susceptibilities chi_r in channel r from the full vertex, and the differences to the flowing susceptibilities (K1r of the input vertex). <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>chi_a</parametername>
</parameternamelist>
<parameterdescription>
<para>: Post-processed susceptibility in all three channels </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>chi_diff</parametername>
</parameternamelist>
<parameterdescription>
<para>: Differences between flowing and post-processed susceptibility in each channel </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>state</parametername>
</parameternamelist>
<parameterdescription>
<para>: Input state from which susceptibilities are computed </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Lambda</parametername>
</parameternamelist>
<parameterdescription>
<para>: Flow parameter Lambda at which bubbles are evaluated </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="549" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="549" bodyend="617"/>
        <references refid="d2/d4a/classGeneralVertex_1a791568d8a7b0cacf00079d69ec765bae" compoundref="d1/d2d/vertex_8hpp" startline="864" endline="864">GeneralVertex&lt; Q, symmtype, differentiated &gt;::avertex</references>
        <references refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" compoundref="de/de8/bubble__function_8hpp" startline="1046" endline="1071">bubble_function</references>
        <references refid="d1/df8/master__parameters_8hpp_1a209c004ba9b216412cae0ca89758f1a9" compoundref="d1/df8/master__parameters_8hpp" startline="20">CONTOUR_BASIS</references>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d2/d4a/classGeneralVertex_1abec34975a70ef37a932b85ec566fc52b" compoundref="d1/d2d/vertex_8hpp" startline="865" endline="865">GeneralVertex&lt; Q, symmtype, differentiated &gt;::pvertex</references>
        <references refid="d2/d4a/classGeneralVertex_1a80b79fecedc9c2fb3f7e115dfc658b78" compoundref="d1/d2d/vertex_8hpp" startline="866" endline="866">GeneralVertex&lt; Q, symmtype, differentiated &gt;::tvertex</references>
        <references refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" compoundref="d7/d59/data__structures_8hpp" startline="650">fRG_config::U</references>
        <references refid="d2/d4a/classGeneralVertex_1a2b9b73449a3d78f260cb929b0be99977" compoundref="d1/d2d/vertex_8hpp" startline="456">GeneralVertex&lt; Q, symmtype, differentiated &gt;::vertex</references>
        <referencedby refid="d5/d94/parquet__solver_8c_09_09_1a9abfea4a26adefdf395729c7604b5842" compoundref="d5/d94/parquet__solver_8c_09_09" startline="3" endline="97">parquet_checks</referencedby>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a7f8b92dc55360683f0e90bad965195a8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void parquet_checks</definition>
        <argsstring>(const std::string filename)</argsstring>
        <name>parquet_checks</name>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> std::string</type>
          <declname>filename</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Parquet checks for the state in HDF5 file &lt;filename&gt;. For each Lambda step, compute vertex and self-energy by inserting the fRG result into the BSE/SDE and compare to the fRG results. Save norms of fRG/parquet results and differences as vectors into an HDF5 file, and also save the state object resulting from the parquet equations. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="626" column="6" declfile="perturbation_theory_and_parquet/parquet_solver.hpp" declline="626" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1aad1680ae03adc0f566df945376e95234" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void parquet_iteration</definition>
        <argsstring>(State&lt; Q &gt; &amp;state_out, const State&lt; Q &gt; &amp;state_in, const double Lambda, const int it_Lambda, const int version)</argsstring>
        <name>parquet_iteration</name>
        <param>
          <type><ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_out</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> int</type>
          <declname>it_Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> int</type>
          <declname>version</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>One iteration of the parquet solver: Compute both the Bethe-Salpeter and the Schwinger-Dyson equation for given input. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>state_out</parametername>
</parameternamelist>
<parameterdescription>
<para>: Lhs of the BSE and SDE. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>state_in</parametername>
</parameternamelist>
<parameterdescription>
<para>: Input to the rhs of the BSE and SDE </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Lambda</parametername>
</parameternamelist>
<parameterdescription>
<para>: Lambda value at which to compute the parquet equations </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="635" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="635" bodyend="645"/>
        <references refid="dd/d0a/parquet__solver_8hpp_1a1541a0b7d193f70577c5fab1efc216e1" compoundref="dd/d0a/parquet__solver_8hpp" startline="28" endline="62">compute_BSE</references>
        <references refid="dd/d0a/parquet__solver_8hpp_1a9ef507c1d49fff7991752cab04374824" compoundref="dd/d0a/parquet__solver_8hpp" startline="462" endline="490">compute_SDE</references>
        <references refid="d1/df8/master__parameters_8hpp_1a209c004ba9b216412cae0ca89758f1a9" compoundref="d1/df8/master__parameters_8hpp" startline="20">CONTOUR_BASIS</references>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1afab5195e3ffff420d211040e5672fcbe" compoundref="d1/df8/master__parameters_8hpp" startline="137">KELDYSH</references>
        <references refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" compoundref="d0/d3f/util_8hpp" startline="25" endline="38">utils::print</references>
        <referencedby refid="dd/d0a/parquet__solver_8hpp_1a07f441b6693f6e2e8d958049ae06cb73" compoundref="dd/d0a/parquet__solver_8hpp" startline="659" endline="808">parquet_solver</referencedby>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1a07f441b6693f6e2e8d958049ae06cb73" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">typename</ref> Q</type>
          </param>
        </templateparamlist>
        <type><ref refid="d9/db9/classbool" kindref="compound">bool</ref></type>
        <definition>bool parquet_solver</definition>
        <argsstring>(const std::string filename, State&lt; Q &gt; &amp;state_in, const double Lambda, const int version, const double accuracy=1e-6, const int Nmax=6, const bool overwrite_old_results=true, const double mixing_ratio=1.0, const bool use_last_state_anyway=false)</argsstring>
        <name>parquet_solver</name>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> std::string</type>
          <declname>filename</declname>
        </param>
        <param>
          <type><ref refid="d7/d97/classState" kindref="compound">State</ref>&lt; Q &gt; &amp;</type>
          <declname>state_in</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>Lambda</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> int</type>
          <declname>version</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>accuracy</declname>
          <defval>1e-6</defval>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> int</type>
          <declname>Nmax</declname>
          <defval>6</defval>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d9/db9/classbool" kindref="compound">bool</ref></type>
          <declname>overwrite_old_results</declname>
          <defval><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">true</ref></defval>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> double</type>
          <declname>mixing_ratio</declname>
          <defval>1.0</defval>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="d9/db9/classbool" kindref="compound">bool</ref></type>
          <declname>use_last_state_anyway</declname>
          <defval><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">false</ref></defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Iterate the parquet equations for a given input state until convergence. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>filename</parametername>
</parameternamelist>
<parameterdescription>
<para>: File name for result </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>state_in</parametername>
</parameternamelist>
<parameterdescription>
<para>: Input state used as initial input to the parquet equations (e.g. SOPT) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Lambda</parametername>
</parameternamelist>
<parameterdescription>
<para>: Lambda value at which to iterate the parquet equations </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>accuracy</parametername>
</parameternamelist>
<parameterdescription>
<para>: Desired relative accuracy used as convergence criterion for both vertex and selfenergy (default: 0.001) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Nmax</parametername>
</parameternamelist>
<parameterdescription>
<para>: Maximal number of parquet iterations, used as a break condition in case convergence cannot be reached (default: 50) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>mixing_ratio</parametername>
</parameternamelist>
<parameterdescription>
<para>mixing ratio in [0.1 - 0.5] for stabilizing the parquet iteration </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
<para>for testing:</para>
<para>for testing:</para>
<para>mixing of old and new state:</para>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="659" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.hpp" bodystart="659" bodyend="808"/>
        <references refid="d5/de4/hdf5__routines_8hpp_1afcbe2c8a768f64e576f593516262d476" compoundref="d5/de4/hdf5__routines_8hpp" startline="872" endline="895">add_state_to_hdf</references>
        <references refid="d6/d7b/anderson__acceleration_8hpp_1a88e79b4550a392a79d60d8bf6557461c" compoundref="d6/d7b/anderson__acceleration_8hpp" startline="57" endline="125">anderson_update</references>
        <references refid="d5/d4f/hdf5__routines_8c_09_09_1a0f3795e3b03f3c010cc3befa1c153054" compoundref="d5/d4f/hdf5__routines_8c_09_09" startline="194" endline="213">check_convergence_hdf</references>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" compoundref="d1/df8/master__parameters_8hpp" startline="159">data_dir</references>
        <references refid="d6/d84/namespaceutils_1a4ae6ae93d2caa1fda9be0ce8f6b339ee" compoundref="d6/d35/util_8c_09_09" startline="21" endline="27">utils::get_time</references>
        <references refid="d4/dda/mpi__setup_8c_09_09_1a191972e98e51a56d90e8e5f750496c7d" compoundref="d4/dda/mpi__setup_8c_09_09" startline="3" endline="7">mpi_world_rank</references>
        <references refid="d5/d4f/hdf5__routines_8c_09_09_1a924110dbdaccbbc744def3ca0838cb4c" compoundref="d5/d4f/hdf5__routines_8c_09_09" startline="21" endline="30">open_hdf_file_readWrite</references>
        <references refid="dd/d0a/parquet__solver_8hpp_1aad1680ae03adc0f566df945376e95234" compoundref="dd/d0a/parquet__solver_8hpp" startline="635" endline="645">parquet_iteration</references>
        <references refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" compoundref="d0/d3f/util_8hpp" startline="25" endline="38">utils::print</references>
        <references refid="d5/d4f/hdf5__routines_8c_09_09_1aa0ab8d27e7ed5ce3762582c2416a9b45" compoundref="d5/d4f/hdf5__routines_8c_09_09" startline="61" endline="191">read_state_from_hdf</references>
        <references refid="d2/d3f/sanity__check_8hpp_1a884fca24faf1e006b285fcce3ddd0299" compoundref="d2/d3f/sanity__check_8hpp" startline="10" endline="23">sanity_check</references>
        <references refid="d2/d4a/classGeneralVertex_1aed220e3c9849b53e245e7062568b1b72" compoundref="d1/d2d/vertex_8hpp" startline="1115" endline="1119">GeneralVertex&lt; Q, symmtype, differentiated &gt;::save_expanded</references>
        <references refid="dd/d0a/parquet__solver_8hpp_1ade72d4c0a25548ba8cb4c0dcd8950b65" compoundref="dd/d0a/parquet__solver_8hpp" startline="65">SDE_counter</references>
        <references refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" compoundref="d5/de4/hdf5__routines_8hpp" startline="846" endline="858">write_state_to_hdf</references>
        <referencedby refid="d5/d94/parquet__solver_8c_09_09_1aaeb567e9e64243a1b424f89a13b5a425" compoundref="d5/d94/parquet__solver_8c_09_09" startline="106" endline="134">run_parquet</referencedby>
      </memberdef>
      <memberdef kind="function" id="dd/d0a/parquet__solver_8hpp_1aa85025687bc343bc18b36d929a335ef4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">void</ref></type>
        <definition>void run_parquet</definition>
        <argsstring>(const fRG_config &amp;config, const std::vector&lt; double &gt; &amp;, int version, bool overwrite_old_results)</argsstring>
        <name>run_parquet</name>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> <ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref> &amp;</type>
          <declname>config</declname>
        </param>
        <param>
          <type><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">const</ref> std::vector&lt; double &gt; &amp;</type>
          <declname>U_NRG_list</declname>
        </param>
        <param>
          <type>int</type>
          <declname>version</declname>
        </param>
        <param>
          <type><ref refid="d9/db9/classbool" kindref="compound">bool</ref></type>
          <declname>overwrite_old_results</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Run the parquet solver, given a set of parameters. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>config</parametername>
</parameternamelist>
<parameterdescription>
<para>Config struct which holds all necessary parameters </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>U_NRG_list</parametername>
</parameternamelist>
<parameterdescription>
<para>List of values for U/ for which to run a calculation </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>version</parametername>
</parameternamelist>
<parameterdescription>
<para>Version of the implementation of the Schwinger-Dyson equation to be used. Recommendation: 1 </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>overwrite_old_results</parametername>
</parameternamelist>
<parameterdescription>
<para>Determines whether existing results for the given parameters shall be overwritten or not. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="perturbation_theory_and_parquet/parquet_solver.hpp" line="811" column="6" bodyfile="perturbation_theory_and_parquet/parquet_solver.c++" bodystart="106" bodyend="134" declfile="perturbation_theory_and_parquet/parquet_solver.hpp" declline="811" declcolumn="6"/>
        <references refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" compoundref="dd/dea/bubble__corrections_8hpp" startline="295" endline="324">correctionFunctionBubble_REG3_Matsubara_PHS_diff</references>
        <references refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" compoundref="d1/df8/master__parameters_8hpp" startline="159">data_dir</references>
        <references refid="da/da0/structfRG__config_1a4a612c073aced64bd84466bbb875ff3f" compoundref="d7/d59/data__structures_8hpp" startline="653">fRG_config::epsilon</references>
        <references refid="da/da0/structfRG__config_1a424d2ec952ccad62dca3f2333a614541" compoundref="d7/d59/data__structures_8hpp" startline="652">fRG_config::Gamma</references>
        <references refid="d6/d84/namespaceutils_1a5020e8df3fe9af5189eb7170db07439f" compoundref="d6/d35/util_8c_09_09" startline="48" endline="61">utils::get_cpu_hours</references>
        <references refid="d4/d5e/namespaceflowgrid_1ab85047ef8b48a23fc3b5683801788952" compoundref="d6/d8d/flow__grid_8c_09_09" startline="14" endline="30">flowgrid::get_Lambda_checkpoints</references>
        <references refid="d6/d84/namespaceutils_1a4ae6ae93d2caa1fda9be0ce8f6b339ee" compoundref="d6/d35/util_8c_09_09" startline="21" endline="27">utils::get_time</references>
        <references refid="d3/d3c/frequency__parameters_8hpp_1a53beecdaf61aae67af4961c402376dc6" compoundref="d3/d3c/frequency__parameters_8hpp" startline="35">nBOS</references>
        <references refid="d3/d3c/frequency__parameters_8hpp_1a18fa2894433252528682ce7deae641c1" compoundref="d3/d3c/frequency__parameters_8hpp" startline="37">nBOS2</references>
        <references refid="d3/d3c/frequency__parameters_8hpp_1acf74a969ffcb98c08a18e0341b82d0dd" compoundref="d3/d3c/frequency__parameters_8hpp" startline="39">nBOS3</references>
        <references refid="dd/d0a/parquet__solver_8hpp_1a07f441b6693f6e2e8d958049ae06cb73" compoundref="dd/d0a/parquet__solver_8hpp" startline="659" endline="808">parquet_solver</references>
        <references refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" compoundref="d0/d3f/util_8hpp" startline="25" endline="38">utils::print</references>
        <references refid="d5/d0d/perturbation__theory_8hpp_1a7ac208e8f3c934c5b68264609f81acd4" compoundref="d5/d0d/perturbation__theory_8hpp" startline="156" endline="177">sopt_state</references>
        <references refid="da/da0/structfRG__config_1a650ac47628d97c0bd647de9aef8a7504" compoundref="d7/d59/data__structures_8hpp" startline="651">fRG_config::T</references>
        <references refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" compoundref="d7/d59/data__structures_8hpp" startline="650">fRG_config::U</references>
        <references refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" compoundref="d5/de4/hdf5__routines_8hpp" startline="846" endline="858">write_state_to_hdf</references>
        <referencedby refid="df/d0a/main_8cpp_1a7114aa2dd6837734db57667a298dfcc4" compoundref="df/d0a/main_8cpp" startline="24" endline="131">main</referencedby>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>KELDYSH_MFRG_TESTING_PARQUET_CHECKS_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>KELDYSH_MFRG_TESTING_PARQUET_CHECKS_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;deque&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d1/df8/master__parameters_8hpp" kindref="compound">../parameters/master_parameters.hpp</ref>&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>system<sp/>parameters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d5/dd1/flow__grid_8hpp" kindref="compound">../grids/flow_grid.hpp</ref>&quot;</highlight><highlight class="comment">//<sp/>flow<sp/>grid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="da/d3b/state_8hpp" kindref="compound">../correlation_functions/state.hpp</ref>&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>use<sp/>State<sp/>class</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d1/d2d/vertex_8hpp" kindref="compound">../correlation_functions/four_point/vertex.hpp</ref>&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>use<sp/>Vertex<sp/>class</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d6/d2d/selfenergy_8hpp" kindref="compound">../correlation_functions/two_point/selfenergy.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d5/de4/hdf5__routines_8hpp" kindref="compound">../utilities/hdf5_routines.hpp</ref>&quot;</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>read<sp/>data<sp/>from<sp/>HDF5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="de/de8/bubble__function_8hpp" kindref="compound">../bubble/bubble_function.hpp</ref>&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>bubble<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d8/d1d/loop_8hpp" kindref="compound">../loop/loop.hpp</ref>&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>loop<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d1/d75/causality__FDT__checks_8hpp" kindref="compound">../postprocessing/causality_FDT_checks.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d5/d0d/perturbation__theory_8hpp" kindref="compound">perturbation_theory.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d6/d7b/anderson__acceleration_8hpp" kindref="compound">../utilities/anderson_acceleration.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d2/d3f/sanity__check_8hpp" kindref="compound">../postprocessing/sanity_check.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="28" refid="dd/d0a/parquet__solver_8hpp_1a1541a0b7d193f70577c5fab1efc216e1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a1541a0b7d193f70577c5fab1efc216e1" kindref="member">compute_BSE</ref>(<ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE</ref>,<sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref>,<sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref>,</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda)<sp/>{</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/>Gamma<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.<ref refid="d2/d4a/classGeneralVertex_1a2b9b73449a3d78f260cb929b0be99977" kindref="member">vertex</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_r_irred,false&gt;</ref><sp/>Ir(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex.half1());<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>irreducible<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/>Ir.<ref refid="d2/d4a/classGeneralVertex_1aed8132ff4fc8418ee884d39035153e9e" kindref="member">set_Ir</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(irreducible<sp/>in<sp/>the<sp/>channel<sp/>of<sp/>the<sp/>bubble<sp/>in<sp/>which<sp/>it<sp/>is<sp/>evaluated)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>G<sp/>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/></highlight><highlight class="charliteral">&apos;g&apos;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);<sp/></highlight><highlight class="comment">//<sp/>full<sp/>propagator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>BSE<sp/>by<sp/>inserting<sp/>I_r<sp/>on<sp/>the<sp/>left<sp/>and<sp/>the<sp/>full<sp/>Gamma<sp/>on<sp/>the<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;apt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref>,<sp/>Ir,<sp/>Gamma,<sp/>G,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>BSE<sp/>by<sp/>inserting<sp/>the<sp/>full<sp/>Gamma<sp/>on<sp/>the<sp/>left<sp/>and<sp/>I_r<sp/>on<sp/>the<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;apt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref>,<sp/>Gamma,<sp/>Ir,<sp/>G,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(<ref refid="d1/df8/master__parameters_8hpp_1a8e29bcd96e548a3249a0a93917debc8b" kindref="member">SBE_DECOMPOSITION</ref>)<sp/>{</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>:<sp/>{</highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">})<sp/>{</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref>.get_rvertex(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>).K2<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref>.get_rvertex(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>).K2;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(<ref refid="d1/df8/master__parameters_8hpp_1a971bae9902862f2a2e1379520ee2d2bf" kindref="member">DEBUG_SYMMETRIES</ref>)<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref>.get_rvertex(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>).K2b=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref>.get_rvertex(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>).K2b;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>(char<sp/>r<sp/>:<sp/>{&apos;a&apos;,<sp/>&apos;p&apos;,<sp/>&apos;t&apos;})</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>Gamma_BSE_L.get_rvertex(r).K1<sp/>=<sp/>state_in.vertex.get_rvertex(r).K1;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE</ref><sp/>=<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref>)<sp/>*<sp/>0.5;<sp/></highlight><highlight class="comment">//<sp/>symmetrize<sp/>the<sp/>BSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_diff</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref><sp/>-<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref>;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">max_diff_K1</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_diff</ref>.<ref refid="d2/d4a/classGeneralVertex_1a66e3aa65eda2c853832d6a3942ec69e8" kindref="member">norm_K1</ref>(0)<sp/>/<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE</ref>.norm_K1(0);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">max_diff_K2</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_diff</ref>.norm_K2(0)<sp/>/<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE</ref>.norm_K2(0);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">max_diff_K3</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_diff</ref>.norm_K3(0)<sp/>/<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE</ref>.norm_K3(0);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;<sp/>deviation<sp/>between<sp/>left<sp/>and<sp/>right<sp/>bubble<sp/>in<sp/>BSE:<sp/>\n\t<sp/>K1:<sp/>\t&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">max_diff_K1</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\n\t<sp/>K2:<sp/>\t&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">max_diff_K2</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\n\t<sp/>K3:<sp/>\t&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">max_diff_K3</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal">}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="dd/d0a/parquet__solver_8hpp_1ade72d4c0a25548ba8cb4c0dcd8950b65" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1ade72d4c0a25548ba8cb4c0dcd8950b65" kindref="member">SDE_counter</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="73" refid="dd/d0a/parquet__solver_8hpp_1a97f702e04f1c5d26a95211570c003781" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a1541a0b7d193f70577c5fab1efc216e1" kindref="member">compute_BSE</ref>(<ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">it_Lambda</ref>)<sp/>{</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref><sp/>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref><sp/>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a1541a0b7d193f70577c5fab1efc216e1" kindref="member">compute_BSE</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda);</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>NDEBUG</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">write_state</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">write_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_L</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_L</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config,<sp/>Lambda);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_R</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_BSE_R</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config,<sp/>Lambda);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1afcbe2c8a768f64e576f593516262d476" kindref="member">add_state_to_hdf</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Parquet_GammaL&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">it_Lambda</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_L</ref>);<sp/></highlight><highlight class="comment">//<sp/>save<sp/>input<sp/>into<sp/>0-th<sp/>layer<sp/>of<sp/>hdf5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1afcbe2c8a768f64e576f593516262d476" kindref="member">add_state_to_hdf</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Parquet_GammaR&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">it_Lambda</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_R</ref>);<sp/></highlight><highlight class="comment">//<sp/>save<sp/>input<sp/>into<sp/>0-th<sp/>layer<sp/>of<sp/>hdf5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal">}</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>channel,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="92" refid="dd/d0a/parquet__solver_8hpp_1a1a17567ec5d9df767870c3a7489f64a1" refkind="member"><highlight class="normal"><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a1a17567ec5d9df767870c3a7489f64a1" kindref="member">compute_SDE_impl</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref>&amp;<sp/>Gamma,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_loop</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref><sp/>(Lambda,<sp/>config);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>bare<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d1/df8/master__parameters_8hpp_1afab5195e3ffff420d211040e5672fcbe" kindref="member">KELDYSH</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">and</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">not</ref><sp/><ref refid="d1/df8/master__parameters_8hpp_1a209c004ba9b216412cae0ca89758f1a9" kindref="member">CONTOUR_BASIS</ref>)<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>.initialize(-config.<ref refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" kindref="member">U</ref><sp/>/<sp/>2.);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>bare<sp/>vertex<sp/>(Keldysh)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>.initialize(-config.<ref refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" kindref="member">U</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>bare<sp/>vertex<sp/>(Matsubara)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>r-bubble<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_full,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/>channel,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>r<sp/>bubble<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_full,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/>channel,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gamma.<ref refid="d2/d4a/classGeneralVertex_1a5d8cc30ab164e0d65f110c36c64f8974" kindref="member">swap_vanishing_component_channel_a_and_t</ref>();</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_full,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r_other</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r_other</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r_other</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/></highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r</ref><sp/>+=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r_other</ref>;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_full,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/></highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref><sp/>+=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/></highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gamma.<ref refid="d2/d4a/classGeneralVertex_1a5d8cc30ab164e0d65f110c36c64f8974" kindref="member">swap_vanishing_component_channel_a_and_t</ref>();</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_full,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r_other</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r_other</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r_other</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r</ref><sp/>+=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r_other</ref>;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_full,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref><sp/>+=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>bubble_l.K1+K2_r<sp/>identical<sp/>to<sp/>Gamma.K1+K2_r<sp/>?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;For<sp/>channel<sp/>r<sp/>=<sp/>&quot;,<sp/>channel,<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;difference<sp/>in<sp/>bubble_l.K1r<sp/>and<sp/>Gamma.K1r:<sp/>\t&quot;,<sp/>(bubble_l.get_rvertex(channel).K1<sp/>-<sp/>Gamma.get_rvertex(channel).K1).get_vec().max_norm()<sp/>/<sp/>Gamma.get_rvertex(channel).K1.get_vec().max_norm(),<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;difference<sp/>in<sp/>bubble_l.K2r<sp/>and<sp/>Gamma.K2r:<sp/>\t&quot;,<sp/>(bubble_l.get_rvertex(channel).K2<sp/>-<sp/>Gamma.get_rvertex(channel).K2).get_vec().max_norm()<sp/>/<sp/>Gamma.get_rvertex(channel).K2.get_vec().max_norm(),<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_full,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble</ref><sp/>=<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_r</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref>)<sp/>*<sp/>0.5;<sp/><sp/></highlight><highlight class="comment">//<sp/>symmetrize<sp/>the<sp/>two<sp/>versions<sp/>of<sp/>the<sp/>a<sp/>bubble</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble</ref>.<ref refid="d2/d4a/classGeneralVertex_1adb8112bdc5f8e012552d215c2a670eef" kindref="member">vanishing_component_gamma0</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>:<sp/>{</highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">})<sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2" kindref="member">k3_sbe</ref>);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90" kindref="member">k3</ref>);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>I<sp/>know,<sp/>this<sp/>is<sp/>zero<sp/>anyway.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>!=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>)<sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e" kindref="member">k1</ref>);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb" kindref="member">k2</ref>);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021" kindref="member">k2b</ref>);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>self-energy<sp/>via<sp/>SDE<sp/>using<sp/>the<sp/>bubble</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>.selfenergy.Sigma.frequencies);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">loop&lt;false,channel == &apos;t&apos; ? 1 : 0&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_loop</ref>);</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>(channel<sp/>==<sp/>&apos;a&apos;)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>State&lt;Q,<sp/>false&gt;<sp/>Psi_a_l(bubble_l,<sp/>Sigma_SDE,<sp/>Lambda);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>State&lt;Q,<sp/>false&gt;<sp/>Psi_a_r(bubble_r,<sp/>Sigma_SDE,<sp/>Lambda);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_a_l.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_a_l,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_a_r.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_a_r,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//else<sp/>if<sp/>(channel<sp/>==<sp/>&apos;p&apos;)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>State&lt;Q,<sp/>false&gt;<sp/>Psi_p_l(bubble_l,<sp/>Sigma_SDE,<sp/>Lambda);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>State&lt;Q,<sp/>false&gt;<sp/>Psi_p_r(bubble_r,<sp/>Sigma_SDE,<sp/>Lambda);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_p_l.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_p_l,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_p_r.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_p_r,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;Check<sp/>causality<sp/>of<sp/>Sigma_SDE_&quot;,<sp/>channel,<sp/>&quot;:<sp/>\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//check_SE_causality(Sigma_SDE);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//compare_with_FDTs(bubble,<sp/>Lambda,<sp/>0,<sp/>&quot;SDE_bubble_&quot;<sp/>+<sp/>std::to_string(channel));</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>;</highlight></codeline>
<codeline lineno="178"><highlight class="normal">}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>channel,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="182" refid="dd/d0a/parquet__solver_8hpp_1a975283a2a8d88b37c80ee3d2f39e68c3" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a975283a2a8d88b37c80ee3d2f39e68c3" kindref="member">compute_SDE_impl_v1</ref>(<ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>G<sp/>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/></highlight><highlight class="charliteral">&apos;g&apos;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>propagator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_only_Gamma0_and_gamma_r</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.<ref refid="d2/d4a/classGeneralVertex_1a2b9b73449a3d78f260cb929b0be99977" kindref="member">vertex</ref>;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>:<sp/>{</highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">})<sp/>{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>!=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>)<sp/>{</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_only_Gamma0_and_gamma_r</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e" kindref="member">k1</ref>);</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_only_Gamma0_and_gamma_r</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb" kindref="member">k2</ref>);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_only_Gamma0_and_gamma_r</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021" kindref="member">k2b</ref>);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_only_Gamma0_and_gamma_r</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90" kindref="member">k3</ref>);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_only_Gamma0_and_gamma_r</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2" kindref="member">k3_sbe</ref>);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl&lt;channel,Q&gt;</ref>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_only_Gamma0_and_gamma_r</ref>,<sp/>G,<sp/>G,<sp/>config);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal">}</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="207" refid="dd/d0a/parquet__solver_8hpp_1a7e421b1e2c3e3c8fbaa9fe1600a2ef54" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a7e421b1e2c3e3c8fbaa9fe1600a2ef54" kindref="member">compute_SDE_v1</ref>(<ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Psi_0</ref><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>bare<sp/>vertex<sp/>with<sp/>self-energy<sp/>copied<sp/>from<sp/>state_in</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Psi_0</ref>.initialize();</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Psi_0</ref>.selfenergy<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_0</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_aplus0</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_pplus0</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_tplus0</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v1&lt;&apos;a&apos;,Q&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Psi_0</ref>,<sp/>Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v1&lt;&apos;a&apos;,Q&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_aplus0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v1&lt;&apos;p&apos;,Q&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_pplus0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v1&lt;&apos;t&apos;,Q&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_tplus0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/>config);<sp/></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_aplus0</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_pplus0</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_tplus0</ref><sp/>-<sp/>2.<sp/>*<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_0</ref>;</highlight></codeline>
<codeline lineno="226"><highlight class="normal">}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="239" refid="dd/d0a/parquet__solver_8hpp_1afe5b9519474c166967ed13d6791538b9" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1afe5b9519474c166967ed13d6791538b9" kindref="member">compute_SDE_impl_v2</ref>(<ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref>,<sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>,</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">write_state</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>G<sp/>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/></highlight><highlight class="charliteral">&apos;g&apos;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>propagator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Vertex&lt;Q,false&gt;<sp/>Gamma_0<sp/>(Lambda);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>bare<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Gamma_0.set_frequency_grid(state_in.vertex);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>(KELDYSH<sp/>and<sp/>not<sp/>CONTOUR_BASIS)<sp/>Gamma_0.initialize(-config.U<sp/>/<sp/>2.);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>initialize<sp/>bare<sp/>vertex<sp/>(Keldysh)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gamma_0.initialize(-config.U);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>initialize<sp/>bare<sp/>vertex<sp/>(Matsubara)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl&lt;&apos;a&apos;,Q&gt;</ref>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<sp/>G,<sp/>G,<sp/>config);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl&lt;&apos;p&apos;,Q&gt;</ref>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<sp/>G,<sp/>G,<sp/>config);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//SelfEnergy&lt;Q&gt;<sp/>Sigma_SDE_t<sp/>=<sp/>compute_SDE_impl&lt;&apos;t&apos;,Q&gt;(Lambda,<sp/>state_in.vertex,<sp/>G,<sp/>G);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;deviation<sp/>between<sp/>a<sp/>and<sp/>t<sp/>version:<sp/>&quot;,<sp/>(Sigma_SDE_a<sp/>-<sp/>Sigma_SDE_t).norm()<sp/>/<sp/>Sigma_SDE_a.norm(),<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref><sp/>=<sp/>0.5<sp/>*<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="257"><highlight class="comment"><sp/><sp/><sp/><sp/>Vertex&lt;Q,false&gt;<sp/>Gamma_0<sp/>(Lambda);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>bare<sp/>vertex</highlight></codeline>
<codeline lineno="258"><highlight class="comment"><sp/><sp/><sp/><sp/>Gamma_0.set_frequency_grid(state_in.vertex);</highlight></codeline>
<codeline lineno="259"><highlight class="comment"><sp/><sp/><sp/><sp/>if<sp/>(KELDYSH<sp/>and<sp/>not<sp/>CONTOUR_BASIS)<sp/>Gamma_0.initialize(-config.U<sp/>/<sp/>2.);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>initialize<sp/>bare<sp/>vertex<sp/>(Keldysh)</highlight></codeline>
<codeline lineno="260"><highlight class="comment"><sp/><sp/><sp/><sp/>else<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gamma_0.initialize(-config.U);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>initialize<sp/>bare<sp/>vertex<sp/>(Matsubara)</highlight></codeline>
<codeline lineno="261"><highlight class="comment"><sp/><sp/><sp/><sp/>Propagator&lt;Q&gt;<sp/>G<sp/>(Lambda,<sp/>state_in.selfenergy,<sp/>&apos;g&apos;);<sp/><sp/><sp/>//<sp/>full<sp/>propagator</highlight></codeline>
<codeline lineno="262"><highlight class="comment"></highlight></codeline>
<codeline lineno="263"><highlight class="comment"><sp/><sp/><sp/><sp/>//G.save_propagator_values(data_dir<sp/>+<sp/>&quot;parquetPropagator.h5&quot;,<sp/>G.selfenergy.Sigma.frequencies.primary_grid.get_all_frequencies());</highlight></codeline>
<codeline lineno="264"><highlight class="comment"></highlight></codeline>
<codeline lineno="265"><highlight class="comment"><sp/><sp/><sp/><sp/>//<sp/>compute<sp/>the<sp/>a<sp/>bubble<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight></codeline>
<codeline lineno="266"><highlight class="comment"><sp/><sp/><sp/><sp/>GeneralVertex&lt;Q,symmetric_r_irred,false&gt;<sp/>bubble_a_r<sp/>(Lambda);</highlight></codeline>
<codeline lineno="267"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_a_r.set_Ir(true);</highlight></codeline>
<codeline lineno="268"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_a_r.set_frequency_grid(state_in.vertex);</highlight></codeline>
<codeline lineno="269"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_function(bubble_a_r,<sp/>Gamma_0,<sp/>state_in.vertex,<sp/>G,<sp/>G,<sp/>&apos;a&apos;,<sp/>false,<sp/>config);<sp/><sp/>//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight></codeline>
<codeline lineno="270"><highlight class="comment"></highlight></codeline>
<codeline lineno="271"><highlight class="comment"><sp/><sp/><sp/><sp/>//<sp/>compute<sp/>the<sp/>a<sp/>bubble<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight></codeline>
<codeline lineno="272"><highlight class="comment"><sp/><sp/><sp/><sp/>GeneralVertex&lt;Q,symmetric_r_irred,false&gt;<sp/>bubble_a_l<sp/>(Lambda);</highlight></codeline>
<codeline lineno="273"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_a_l.set_Ir(true);</highlight></codeline>
<codeline lineno="274"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_a_l.set_frequency_grid(state_in.vertex);</highlight></codeline>
<codeline lineno="275"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_function(bubble_a_l,<sp/>state_in.vertex,<sp/>Gamma_0,<sp/>G,<sp/>G,<sp/>&apos;a&apos;,<sp/>false,<sp/>config);<sp/><sp/>//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight></codeline>
<codeline lineno="276"><highlight class="comment"></highlight></codeline>
<codeline lineno="277"><highlight class="comment"><sp/><sp/><sp/><sp/>GeneralVertex&lt;Q,symmetric_r_irred,false&gt;<sp/>bubble_a<sp/>=<sp/>(bubble_a_r<sp/>+<sp/>bubble_a_l)<sp/>*<sp/>0.5;<sp/><sp/>//<sp/>symmetrize<sp/>the<sp/>two<sp/>versions<sp/>of<sp/>the<sp/>a<sp/>bubble</highlight></codeline>
<codeline lineno="278"><highlight class="comment"></highlight></codeline>
<codeline lineno="279"><highlight class="comment"><sp/><sp/><sp/><sp/>//<sp/>compute<sp/>the<sp/>self-energy<sp/>via<sp/>SDE<sp/>using<sp/>the<sp/>a<sp/>bubble</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/><sp/><sp/><sp/>Sigma_SDE_a.initialize(config.U<sp/>/<sp/>2.,<sp/>0.);<sp/>///<sp/>Note:<sp/>Only<sp/>valid<sp/>for<sp/>the<sp/>particle-hole<sp/>symmetric_full<sp/>case</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/><sp/><sp/><sp/>//bubble_a.avertex().K2<sp/>*=<sp/>0.;</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/><sp/><sp/><sp/>loop&lt;false,0&gt;(Sigma_SDE_a,<sp/>bubble_a,<sp/>G);</highlight></codeline>
<codeline lineno="283"><highlight class="comment"><sp/><sp/><sp/><sp/>utils::print(&quot;Check<sp/>causality<sp/>of<sp/>Sigma_SDE_a:<sp/>\n&quot;);</highlight></codeline>
<codeline lineno="284"><highlight class="comment"><sp/><sp/><sp/><sp/>check_SE_causality(Sigma_SDE_a);</highlight></codeline>
<codeline lineno="285"><highlight class="comment"><sp/><sp/><sp/><sp/>compare_with_FDTs(bubble_a,<sp/>state_in.Lambda,<sp/>SDE_counter,<sp/>&quot;SDE_bubble_a_&quot;<sp/>+<sp/>std::to_string(SDE_counter));</highlight></codeline>
<codeline lineno="286"><highlight class="comment"></highlight></codeline>
<codeline lineno="287"><highlight class="comment"><sp/><sp/><sp/><sp/>//<sp/>compute<sp/>the<sp/>p<sp/>bubble<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight></codeline>
<codeline lineno="288"><highlight class="comment"><sp/><sp/><sp/><sp/>GeneralVertex&lt;Q,symmetric_r_irred,false&gt;<sp/>bubble_p_r<sp/>(Lambda);</highlight></codeline>
<codeline lineno="289"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_p_r.set_Ir(true);</highlight></codeline>
<codeline lineno="290"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_p_r.set_frequency_grid(state_in.vertex);</highlight></codeline>
<codeline lineno="291"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_function(bubble_p_r,<sp/>Gamma_0,<sp/>state_in.vertex,<sp/>G,<sp/>G,<sp/>&apos;p&apos;,<sp/>false,<sp/>config);<sp/><sp/>//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight></codeline>
<codeline lineno="292"><highlight class="comment"></highlight></codeline>
<codeline lineno="293"><highlight class="comment"><sp/><sp/><sp/><sp/>//<sp/>compute<sp/>the<sp/>p<sp/>bubble<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/><sp/><sp/><sp/>GeneralVertex&lt;Q,symmetric_r_irred,false&gt;<sp/>bubble_p_l<sp/>(Lambda);</highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_p_l.set_Ir(true);</highlight></codeline>
<codeline lineno="296"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_p_l.set_frequency_grid(state_in.vertex);</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/><sp/><sp/><sp/>bubble_function(bubble_p_l,<sp/>state_in.vertex,<sp/>Gamma_0,<sp/>G,<sp/>G,<sp/>&apos;p&apos;,<sp/>false,<sp/>config);<sp/><sp/>//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight></codeline>
<codeline lineno="298"><highlight class="comment"></highlight></codeline>
<codeline lineno="299"><highlight class="comment"><sp/><sp/><sp/><sp/>GeneralVertex&lt;Q,symmetric_r_irred,false&gt;<sp/>bubble_p<sp/>=<sp/>(bubble_p_r<sp/>+<sp/>bubble_p_l)<sp/>*<sp/>0.5;<sp/><sp/>//<sp/>symmetrize<sp/>the<sp/>two<sp/>versions<sp/>of<sp/>the<sp/>p<sp/>bubble</highlight></codeline>
<codeline lineno="300"><highlight class="comment"></highlight></codeline>
<codeline lineno="301"><highlight class="comment"><sp/><sp/><sp/><sp/>//<sp/>compute<sp/>the<sp/>self-energy<sp/>via<sp/>SDE<sp/>using<sp/>the<sp/>p<sp/>bubble</highlight></codeline>
<codeline lineno="302"><highlight class="comment"><sp/><sp/><sp/><sp/>Sigma_SDE_p.initialize(glb_U<sp/>/<sp/>2.,<sp/>0.);<sp/>///<sp/>Note:<sp/>Only<sp/>valid<sp/>for<sp/>the<sp/>particle-hole<sp/>symmetric_full<sp/>case</highlight></codeline>
<codeline lineno="303"><highlight class="comment"><sp/><sp/><sp/><sp/>//bubble_p.pvertex().K2<sp/>*=<sp/>0.;</highlight></codeline>
<codeline lineno="304"><highlight class="comment"><sp/><sp/><sp/><sp/>loop&lt;false,0&gt;(Sigma_SDE_p,<sp/>bubble_p,<sp/>G);</highlight></codeline>
<codeline lineno="305"><highlight class="comment"><sp/><sp/><sp/><sp/>utils::print(&quot;Check<sp/>causality<sp/>of<sp/>Sigma_SDE_p:<sp/>\n&quot;);</highlight></codeline>
<codeline lineno="306"><highlight class="comment"><sp/><sp/><sp/><sp/>check_SE_causality(Sigma_SDE_p);</highlight></codeline>
<codeline lineno="307"><highlight class="comment"><sp/><sp/><sp/><sp/>compare_with_FDTs(bubble_p,<sp/>state_in.Lambda,<sp/>SDE_counter,<sp/>&quot;SDE_bubble_p_&quot;<sp/>+<sp/>std::to_string(SDE_counter));</highlight></codeline>
<codeline lineno="308"><highlight class="comment"></highlight></codeline>
<codeline lineno="309"><highlight class="comment"></highlight></codeline>
<codeline lineno="310"><highlight class="comment"><sp/><sp/><sp/><sp/>//<sp/>symmetrize<sp/>the<sp/>contributions<sp/>computed<sp/>via<sp/>a/p<sp/>bubble</highlight></codeline>
<codeline lineno="311"><highlight class="comment"><sp/><sp/><sp/><sp/>Sigma_SDE<sp/>=<sp/>(Sigma_SDE_a<sp/>+<sp/>Sigma_SDE_p)<sp/>*<sp/>0.5;</highlight></codeline>
<codeline lineno="312"><highlight class="comment"><sp/><sp/><sp/><sp/>utils::print(&quot;Check<sp/>causality<sp/>of<sp/>Sigma_SDE:<sp/>\n&quot;);</highlight></codeline>
<codeline lineno="313"><highlight class="comment"><sp/><sp/><sp/><sp/>check_SE_causality(Sigma_SDE);</highlight></codeline>
<codeline lineno="314"><highlight class="comment"></highlight></codeline>
<codeline lineno="315"><highlight class="comment"><sp/><sp/><sp/><sp/>//utils::print(&quot;<sp/>---&gt;<sp/>difference<sp/>between<sp/>K1a-left<sp/>and<sp/>-right:<sp/>&quot;,<sp/>(bubble_a_l<sp/>-<sp/>bubble_a_r).avertex().K1.get_vec().max_norm(),<sp/>&quot;\n&quot;);</highlight></codeline>
<codeline lineno="316"><highlight class="comment"><sp/><sp/><sp/><sp/>//utils::print(&quot;<sp/>---&gt;<sp/>difference<sp/>between<sp/>K1p-left<sp/>and<sp/>-right:<sp/>&quot;,<sp/>(bubble_p_l<sp/>-<sp/>bubble_p_r).pvertex().K1.get_vec().max_norm(),<sp/>&quot;\n&quot;);</highlight></codeline>
<codeline lineno="317"><highlight class="comment"></highlight></codeline>
<codeline lineno="318"><highlight class="comment"><sp/><sp/><sp/><sp/>if<sp/>(write_state)<sp/>{</highlight></codeline>
<codeline lineno="319"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>filename<sp/>=<sp/>data_dir<sp/>+<sp/>&quot;SDE_iteration&quot;<sp/>+<sp/>std::to_string(SDE_counter);</highlight></codeline>
<codeline lineno="320"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H5::H5File<sp/>file_out<sp/>=<sp/>H5::H5File(filename,<sp/>H5F_ACC_TRUNC);</highlight></codeline>
<codeline lineno="321"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write_to_hdf(file_out,<sp/>&quot;Sigma_SDE_a&quot;,<sp/>Sigma_SDE_a.Sigma.get_vec(),<sp/>false);</highlight></codeline>
<codeline lineno="322"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write_to_hdf(file_out,<sp/>&quot;Sigma_SDE_p&quot;,<sp/>Sigma_SDE_p.Sigma.get_vec(),<sp/>false);</highlight></codeline>
<codeline lineno="323"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write_to_hdf(file_out,<sp/>&quot;Sigma_SDE&quot;,<sp/>Sigma_SDE.Sigma.get_vec(),<sp/>false);</highlight></codeline>
<codeline lineno="324"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file_out.close();</highlight></codeline>
<codeline lineno="325"><highlight class="comment"></highlight></codeline>
<codeline lineno="326"><highlight class="comment">#ifndef<sp/>NDEBUG</highlight></codeline>
<codeline lineno="327"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>State&lt;Q&gt;<sp/>Psi_a(Vertex&lt;Q,false&gt;(bubble_a.half1()),<sp/>Sigma_SDE_a,<sp/>Lambda);</highlight></codeline>
<codeline lineno="328"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>State&lt;Q&gt;<sp/>Psi_a_l(Vertex&lt;Q,false&gt;(bubble_a_l.half1()),<sp/>Sigma_SDE_a,<sp/>Lambda);</highlight></codeline>
<codeline lineno="329"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>State&lt;Q&gt;<sp/>Psi_a_r(Vertex&lt;Q,false&gt;(bubble_a_r.half1()),<sp/>Sigma_SDE_a,<sp/>Lambda);</highlight></codeline>
<codeline lineno="330"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>State&lt;Q&gt;<sp/>Psi_p(Vertex&lt;Q,false&gt;(bubble_p.half1()),<sp/>Sigma_SDE_p,<sp/>Lambda);</highlight></codeline>
<codeline lineno="331"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>State&lt;Q&gt;<sp/>Psi_p_l(Vertex&lt;Q,false&gt;(bubble_p_l.half1()),<sp/>Sigma_SDE_p,<sp/>Lambda);</highlight></codeline>
<codeline lineno="332"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>State&lt;Q&gt;<sp/>Psi_p_r(Vertex&lt;Q,false&gt;(bubble_p_r.half1()),<sp/>Sigma_SDE_p,<sp/>Lambda);</highlight></codeline>
<codeline lineno="333"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_a.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_a,<sp/>true);</highlight></codeline>
<codeline lineno="334"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_p.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_p,<sp/>true);</highlight></codeline>
<codeline lineno="335"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_a_l.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_a_l,<sp/>true);</highlight></codeline>
<codeline lineno="336"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_a_r.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_a_r,<sp/>true);</highlight></codeline>
<codeline lineno="337"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_p_l.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_p_l,<sp/>true);</highlight></codeline>
<codeline lineno="338"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_p_r.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_p_r,<sp/>true);</highlight></codeline>
<codeline lineno="339"><highlight class="comment">#endif</highlight></codeline>
<codeline lineno="340"><highlight class="comment"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="341"><highlight class="comment"><sp/><sp/><sp/><sp/>SDE_counter++;</highlight></codeline>
<codeline lineno="342"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal">}</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>channel,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="346" refid="dd/d0a/parquet__solver_8hpp_1a5ab14a76538cdb69001c01f9ebf492ca" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a5ab14a76538cdb69001c01f9ebf492ca" kindref="member">check_selfconsistency_of_K1K2</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref>&amp;<sp/>Gamma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref><sp/>(Lambda,<sp/>config);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>bare<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d1/df8/master__parameters_8hpp_1afab5195e3ffff420d211040e5672fcbe" kindref="member">KELDYSH</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">and</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">not</ref><sp/><ref refid="d1/df8/master__parameters_8hpp_1a209c004ba9b216412cae0ca89758f1a9" kindref="member">CONTOUR_BASIS</ref>)<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>.initialize(-config.<ref refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" kindref="member">U</ref><sp/>/<sp/>2.);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>bare<sp/>vertex<sp/>(Keldysh)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>.initialize(-config.<ref refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" kindref="member">U</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>bare<sp/>vertex<sp/>(Matsubara)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>r<sp/>bubble<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_r_irred,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref>.set_Ir(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/>channel,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gamma.<ref refid="d2/d4a/classGeneralVertex_1a5d8cc30ab164e0d65f110c36c64f8974" kindref="member">swap_vanishing_component_channel_a_and_t</ref>();</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_r_irred,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref><sp/>(Lambda);</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>.set_Ir(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_bubble</ref>,<sp/></highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l</ref><sp/>+=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">bubble_l_other</ref>;</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;For<sp/>channel<sp/>r<sp/>=<sp/>&quot;,<sp/>channel,<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;difference<sp/>in<sp/>bubble_l.K1r<sp/>and<sp/>Gamma.K1r:<sp/>\t&quot;,<sp/>(bubble_l.get_rvertex(channel).K1<sp/>-<sp/>Gamma.get_rvertex(channel).K1).get_vec().max_norm()<sp/>/<sp/>Gamma.get_rvertex(channel).K1.get_vec().max_norm(),<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;difference<sp/>in<sp/>bubble_l.K2r<sp/>and<sp/>Gamma.K2r:<sp/>\t&quot;,<sp/>(bubble_l.get_rvertex(channel).K2<sp/>-<sp/>Gamma.get_rvertex(channel).K2).get_vec().max_norm()<sp/>/<sp/>Gamma.get_rvertex(channel).K2.get_vec().max_norm(),<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal">}</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>version,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>is_differentiated_vertex,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>is_differentiated_SE,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="377" refid="dd/d0a/parquet__solver_8hpp_1a947824a1a735bc2e9db735348ac9dd2c" refkind="member"><highlight class="normal"><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a947824a1a735bc2e9db735348ac9dd2c" kindref="member">compute_SDE_impl_v3</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,is_differentiated_vertex&gt;</ref>&amp;<sp/>Gamma,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_loop</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">assert</ref>((<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref><sp/>==<sp/>0<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">and</ref><sp/>(channel<sp/>==<sp/></highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">or</ref><sp/>channel<sp/>==<sp/></highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">))<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">or</ref><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref><sp/>==<sp/>1<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">and</ref><sp/>(channel<sp/>==<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">or</ref><sp/>channel<sp/>==<sp/></highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">)));</highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//check_selfconsistency_of_K1K2&lt;&apos;a&apos;,Q&gt;(Gamma,<sp/>Lambda,<sp/>G_loop,<sp/>config);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//check_selfconsistency_of_K1K2&lt;&apos;p&apos;,Q&gt;(Gamma,<sp/>Lambda,<sp/>G_loop,<sp/>config);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,non_symmetric_diffleft,is_differentiated_vertex&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>(Gamma.<ref refid="d2/d4a/classGeneralVertex_1a914996279b86330de5331fb018eb3f60" kindref="member">half1</ref>(),<sp/>Gamma.<ref refid="d2/d4a/classGeneralVertex_1a914996279b86330de5331fb018eb3f60" kindref="member">half1</ref>(),<sp/>Gamma.<ref refid="d2/d4a/classGeneralVertex_1abb8396f63f5f6ea6c66371d9075bdc28" kindref="member">get_vertex_nondiff</ref>());</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>:<sp/>{</highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">})<sp/>{</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref><sp/>!=<sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e" kindref="member">k1</ref>);</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb" kindref="member">k2</ref>);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Gamma_temp_onlyK2.get_rvertex(r).K2<sp/>*=<sp/>0.5;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>constexpr<sp/>(is_differentiated_vertex)<sp/>{Gamma_temp_onlyK2.get_vertex_nondiff().get_rvertex(r).K2<sp/>*=<sp/>0.5;}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(<ref refid="d1/df8/master__parameters_8hpp_1a971bae9902862f2a2e1379520ee2d2bf" kindref="member">DEBUG_SYMMETRIES</ref>)<sp/>{</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>.get_rvertex(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>).K2b<sp/>*=<sp/>0.5;</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_differentiated_vertex</ref>)<sp/>{<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>.get_vertex_nondiff().get_rvertex(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>).K2b<sp/>*=<sp/>0.5;}</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021" kindref="member">k2b</ref>);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90" kindref="member">k3</ref>);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>.set_to_zero_in_integrand(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/><ref refid="d7/d59/data__structures_8hpp_1a82cbf94ae42de55eaaa115fc78dffbc6a2326000f2ce3b51e0f6cacb8378366f2" kindref="member">k3_sbe</ref>);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>self-energy<sp/>via<sp/>SDE<sp/>using<sp/>the<sp/>Gamma_temp_onlyK2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_loop</ref>.selfenergy.Sigma.frequencies);</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">loop&lt;false,version&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_temp_onlyK2</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">G_loop</ref>);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>;</highlight></codeline>
<codeline lineno="408"><highlight class="normal">}</highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="412" refid="dd/d0a/parquet__solver_8hpp_1ac50fa9495cb7f051e0b03aefd35993c4" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1ac50fa9495cb7f051e0b03aefd35993c4" kindref="member">compute_SDE_v3</ref>(<ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>G(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/></highlight><highlight class="charliteral">&apos;g&apos;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;0, false, false&gt;</ref>(</highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<sp/>G,<sp/>config);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;0, false, false&gt;</ref>(</highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<sp/>G,<sp/>config);</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_t</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;1, false, false&gt;</ref>(</highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<sp/>G,<sp/>config);</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref><sp/>=<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>)<sp/>*<sp/>0.5;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;difference<sp/>bw<sp/>SDE_a<sp/>and<sp/>SDE_p:<sp/>\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;\t&quot;</highlight><highlight class="normal">,<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref><sp/>-<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>).norm()<sp/>/<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>.norm(),<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;difference<sp/>bw<sp/>SDE_t<sp/>and<sp/>SDE_a:<sp/>\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;\t&quot;,<sp/>(Sigma_SDE_a<sp/>-<sp/>Sigma_SDE_t).norm()<sp/>/<sp/>Sigma_SDE_t.norm(),<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//State&lt;Q,false&gt;<sp/>Psi_a<sp/>=<sp/>state_in;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//State&lt;Q,false&gt;<sp/>Psi_p<sp/>=<sp/>state_in;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//State&lt;Q,false&gt;<sp/>Psi_t<sp/>=<sp/>state_in;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Psi_a.selfenergy<sp/>=<sp/>Sigma_SDE_a;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Psi_p.selfenergy<sp/>=<sp/>Sigma_SDE_p;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Psi_t.selfenergy<sp/>=<sp/>Sigma_SDE_t;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_a.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_a,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_p.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_p,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_t.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_t,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal">}</highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="444" refid="dd/d0a/parquet__solver_8hpp_1aa738db4c50d72d9475911cf0dfce2bad" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1aa738db4c50d72d9475911cf0dfce2bad" kindref="member">compute_SDE_v2</ref>(<ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy.Sigma.frequencies);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy.Sigma.frequencies);</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1afe5b9519474c166967ed13d6791538b9" kindref="member">compute_SDE_impl_v2</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;difference<sp/>bw<sp/>SDE_a<sp/>and<sp/>SDE_p:<sp/>\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;\t&quot;</highlight><highlight class="normal">,<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a</ref><sp/>-<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>).norm()<sp/>/<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p</ref>.norm(),<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//State&lt;Q,false&gt;<sp/>Psi_a<sp/>=<sp/>state_in;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//State&lt;Q,false&gt;<sp/>Psi_p<sp/>=<sp/>state_in;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Psi_a.selfenergy<sp/>=<sp/>Sigma_SDE_a;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Psi_p.selfenergy<sp/>=<sp/>Sigma_SDE_p;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_a.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_a,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//add_state_to_hdf(data_dir<sp/>+<sp/>&quot;Psi_SDE_p.h5&quot;,<sp/>SDE_counter<sp/>+<sp/>1,<sp/>Psi_p,<sp/>true);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal">}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="462" refid="dd/d0a/parquet__solver_8hpp_1a9ef507c1d49fff7991752cab04374824" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a9ef507c1d49fff7991752cab04374824" kindref="member">compute_SDE</ref>(<ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref>)<sp/>{</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref><sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_v1&lt;Q&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//SelfEnergy&lt;Q&gt;<sp/>Sigma_compare<sp/>=<sp/>Sigma_SDE;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//compute_SDE_v3&lt;Q&gt;(Sigma_compare,<sp/>state_in,<sp/>Lambda,<sp/>config);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//utils::print(&quot;rel.<sp/>dev.<sp/>bw.<sp/>v1<sp/>and<sp/>v3:<sp/>\t&quot;,<sp/>(Sigma_SDE<sp/>-<sp/>Sigma_compare).norm(),<sp/>&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref><sp/>==<sp/>2)<sp/>{</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_v2&lt;Q&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_v3&lt;Q&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">not</ref><sp/><ref refid="d1/df8/master__parameters_8hpp_1ac209459b6113297c093b5c50febc47ad" kindref="member">PARTICLE_HOLE_SYMMETRY</ref>){<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>In<sp/>this<sp/>case,<sp/>we<sp/>have<sp/>to<sp/>update<sp/>the<sp/>Hartree<sp/>term<sp/>as<sp/>well.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d75/classHartree__Solver" kindref="compound">Hartree_Solver</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">hartree_term</ref><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">hartree</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">hartree_term</ref>.compute_Hartree_term_oneshot();</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>.initialize(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">hartree</ref>,<sp/>0.);</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE</ref>.initialize(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config.U<sp/>/<sp/>2.,<sp/>0.);</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1ade72d4c0a25548ba8cb4c0dcd8950b65" kindref="member">SDE_counter</ref><sp/>++;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal">}</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="494" refid="dd/d0a/parquet__solver_8hpp_1ad9258c4214b31ccef74aad6764dc4db5" refkind="member"><highlight class="normal"><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1ad9258c4214b31ccef74aad6764dc4db5" kindref="member">compute_diff_SDE</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,true&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dGamma</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dSigma</ref>)<sp/>{</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.Lambda;</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>G(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/></highlight><highlight class="charliteral">&apos;g&apos;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dG</ref>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.selfenergy,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dSigma</ref>,<sp/></highlight><highlight class="charliteral">&apos;k&apos;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a_1</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;0, false, true&gt;</ref>(</highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dG</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_1</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;0, false, true&gt;</ref>(</highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dG</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a_2</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;0, true, true&gt;</ref>(</highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dGamma</ref>,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_2</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;0, true, true&gt;</ref>(</highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dGamma</ref>,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dSigma_SDE</ref><sp/>=<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a_1</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_1</ref></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a_2</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_2</ref></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>*<sp/>0.5;</highlight></codeline>
<codeline lineno="508"><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_1_v2</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;1, false, true&gt;</ref>(</highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dG</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_t_1</ref><sp/><sp/><sp/><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;1, false, true&gt;</ref>(</highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex,<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dG</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="512"><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_2_v2</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;1, true, true&gt;</ref>(</highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dGamma</ref>,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/df6/classSelfEnergy" kindref="compound">SelfEnergy&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_t_2</ref><sp/><sp/><sp/><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">compute_SDE_impl_v3&lt;1, true, true&gt;</ref>(</highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">,<sp/>Lambda,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dGamma</ref>,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config);</highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>filename<sp/>=<sp/><ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;diffSDE_in_different_channels.h5&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H5::H5File<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref><sp/>=<sp/>H5::H5File(filename,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">H5F_ACC_TRUNC</ref>);</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" kindref="member">write_to_hdf</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sigma_SDE_a_1&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a_1</ref>.Sigma.get_vec(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" kindref="member">write_to_hdf</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sigma_SDE_p_1&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_1</ref>.Sigma.get_vec(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" kindref="member">write_to_hdf</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sigma_SDE_p_1_v2&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_1_v2</ref>.Sigma.get_vec(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" kindref="member">write_to_hdf</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sigma_SDE_t_1&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_t_1</ref>.Sigma.get_vec(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" kindref="member">write_to_hdf</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sigma_SDE_a_2&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_a_2</ref>.Sigma.get_vec(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" kindref="member">write_to_hdf</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sigma_SDE_p_2&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_2</ref>.Sigma.get_vec(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" kindref="member">write_to_hdf</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sigma_SDE_p_2_v2&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_p_2_v2</ref>.Sigma.get_vec(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d22/r__vertex_8hpp_1a2337339bdea1a060b1205e7bcba3bb20" kindref="member">write_to_hdf</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sigma_SDE_t_2&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Sigma_SDE_t_2</ref>.Sigma.get_vec(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="528"><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>.close();</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//dSigma_SDE.check_symmetries();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">dSigma_SDE</ref>;</highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal">}</highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="549" refid="dd/d0a/parquet__solver_8hpp_1a997236aea73d9935839d4dc8c8fd06af" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a997236aea73d9935839d4dc8c8fd06af" kindref="member">susceptibilities_postprocessing</ref>(<ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi</ref>,<sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_diff</ref>,</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config)<sp/>{</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/>Gamma<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state</ref>.<ref refid="d2/d4a/classGeneralVertex_1a2b9b73449a3d78f260cb929b0be99977" kindref="member">vertex</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>vertex<sp/>(just<sp/>a<sp/>redefinition</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref><sp/>(Lambda,<sp/>config);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>bare<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>.initialize(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">not</ref><sp/><ref refid="d1/df8/master__parameters_8hpp_1a209c004ba9b216412cae0ca89758f1a9" kindref="member">CONTOUR_BASIS</ref><sp/>?<sp/>-config.<ref refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" kindref="member">U</ref><sp/>/<sp/>2.<sp/>:<sp/>-config.<ref refid="da/da0/structfRG__config_1ad9afaf64e087c69bc4f16e49c132b592" kindref="member">U</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>bare<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d2/d34/classPropagator" kindref="compound">Propagator&lt;Q&gt;</ref><sp/>G<sp/>(Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state</ref>.selfenergy,<sp/></highlight><highlight class="charliteral">&apos;g&apos;</highlight><highlight class="normal">,<sp/>config);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>full<sp/>propagator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>susceptibilities<sp/>in<sp/>all<sp/>three<sp/>channels</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;apt&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>contribution<sp/>from<sp/>the<sp/>bare<sp/>bubble</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_0</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_0</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/>G,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>temporary<sp/>vertex<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>right<sp/>(first:<sp/>compute<sp/>half1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma_half1</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma_half1</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma_half1</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/>Gamma,<sp/>G,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);</highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>temporary<sp/>vertex<sp/>with<sp/>full<sp/>vertex<sp/>on<sp/>the<sp/>left<sp/>(first:<sp/>compute<sp/>half1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0_half1</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0_half1</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0_half1</ref>,<sp/>Gamma,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/>G,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);</highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>construct<sp/>non-symmetric_full<sp/>vertices<sp/>out<sp/>of<sp/>the<sp/>two<sp/>half1<sp/>vertices<sp/>above</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q, non_symmetric_diffleft,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma</ref>.half1()<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma_half1</ref>.half1();</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma</ref>.half2()<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0_half1</ref>.half1();</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma</ref>.set_only_same_channel(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);<sp/><sp/></highlight><highlight class="comment">//<sp/>left/right<sp/>bubble<sp/>need<sp/>to<sp/>be<sp/>in<sp/>the<sp/>same<sp/>channel</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q, non_symmetric_diffright,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0</ref>.half1()<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0_half1</ref>.half1();</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0</ref>.half2()<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma_half1</ref>.half1();</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>contribution<sp/>from<sp/>the<sp/>full<sp/>vertex,<sp/>with<sp/>temporary<sp/>vertex<sp/>on<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_L</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_L</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_L</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma0_Gamma</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/>G,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);</highlight></codeline>
<codeline lineno="589"><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>contribution<sp/>from<sp/>the<sp/>full<sp/>vertex,<sp/>with<sp/>temporary<sp/>vertex<sp/>on<sp/>the<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_R</ref><sp/>(Lambda,<sp/>config);</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_R</ref>.set_frequency_grid(Gamma);</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/de8/bubble__function_8hpp_1af33e47ff22bc507b4226169779a87c95" kindref="member">bubble_function</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_R</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_0</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Gamma_Gamma0</ref>,<sp/>G,<sp/>G,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>config);</highlight></codeline>
<codeline lineno="594"><highlight class="normal"></highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>symmetrize<sp/>left/right<sp/>contributions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">Vertex&lt;Q,false&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_tot</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_0</ref><sp/>+<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_L</ref><sp/>+<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_R</ref>)<sp/>*<sp/>0.5;</highlight></codeline>
<codeline lineno="597"><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">r</ref>)<sp/>{</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;a&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi</ref>.<ref refid="d2/d4a/classGeneralVertex_1a791568d8a7b0cacf00079d69ec765bae" kindref="member">avertex</ref>().K1<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_tot</ref>.avertex().K1;</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>difference<sp/>between<sp/>K1<sp/>from<sp/>input<sp/>state<sp/>and<sp/>post-processed<sp/>susceptibility</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_diff</ref>.avertex().K1<sp/>=<sp/>Gamma.<ref refid="d2/d4a/classGeneralVertex_1a791568d8a7b0cacf00079d69ec765bae" kindref="member">avertex</ref>().K1<sp/>-<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi</ref>.avertex().K1;</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;p&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi</ref>.pvertex().K1<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_tot</ref>.pvertex().K1;</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>difference<sp/>between<sp/>K1<sp/>from<sp/>input<sp/>state<sp/>and<sp/>post-processed<sp/>susceptibility</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_diff</ref>.pvertex().K1<sp/>=<sp/>Gamma.<ref refid="d2/d4a/classGeneralVertex_1abec34975a70ef37a932b85ec566fc52b" kindref="member">pvertex</ref>().K1<sp/>-<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi</ref>.pvertex().K1;</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi</ref>.tvertex().K1<sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_tot</ref>.tvertex().K1;</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>difference<sp/>between<sp/>K1<sp/>from<sp/>input<sp/>state<sp/>and<sp/>post-processed<sp/>susceptibility</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi_diff</ref>.tvertex().K1<sp/>=<sp/>Gamma.<ref refid="d2/d4a/classGeneralVertex_1a80b79fecedc9c2fb3f7e115dfc658b78" kindref="member">tvertex</ref>().K1<sp/>-<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">chi</ref>.tvertex().K1;</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:;</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="617"><highlight class="normal">}</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight></codeline>
<codeline lineno="626" refid="dd/d0a/parquet__solver_8hpp_1a7f8b92dc55360683f0e90bad965195a8" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a7f8b92dc55360683f0e90bad965195a8" kindref="member">parquet_checks</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::string<sp/>filename);</highlight></codeline>
<codeline lineno="627"><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="635" refid="dd/d0a/parquet__solver_8hpp_1aad1680ae03adc0f566df945376e95234" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1aad1680ae03adc0f566df945376e95234" kindref="member">parquet_iteration</ref>(<ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">it_Lambda</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref>)<sp/>{</highlight></codeline>
<codeline lineno="636"><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;Compute<sp/>BSE:\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a1541a0b7d193f70577c5fab1efc216e1" kindref="member">compute_BSE</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>.vertex,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">it_Lambda</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>gamma_r&apos;s<sp/>via<sp/>the<sp/>BSE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d1/df8/master__parameters_8hpp_1afab5195e3ffff420d211040e5672fcbe" kindref="member">KELDYSH</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">and</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">not</ref><sp/><ref refid="d1/df8/master__parameters_8hpp_1a209c004ba9b216412cae0ca89758f1a9" kindref="member">CONTOUR_BASIS</ref>)<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>.vertex.initialize(-<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config.U/2.);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>the<sp/>irreducible<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>.vertex.initialize(-<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.config.U);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>the<sp/>irreducible<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;Compute<sp/>SDE:\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a9ef507c1d49fff7991752cab04374824" kindref="member">compute_SDE</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>.selfenergy,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref>);<sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>self-energy<sp/>via<sp/>the<sp/>SDE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//state_out.selfenergy<sp/>=<sp/>state_in.selfenergy;<sp/>//<sp/>uncomment<sp/>if<sp/>you<sp/>don&apos;t<sp/>wanna<sp/>update<sp/>selfenergy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="645"><highlight class="normal">}</highlight></codeline>
<codeline lineno="646"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Q&gt;</highlight></codeline>
<codeline lineno="659" refid="dd/d0a/parquet__solver_8hpp_1a07f441b6693f6e2e8d958049ae06cb73" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1a07f441b6693f6e2e8d958049ae06cb73" kindref="member">parquet_solver</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::string<sp/>filename,<sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref>&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Lambda,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref>,</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">accuracy</ref>=1e-6,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>Nmax=6,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">overwrite_old_results</ref>=</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_ratio</ref>=1.0,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">use_last_state_anyway</ref>=</highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_minimum</ref><sp/>=<sp/>0.01;<sp/></highlight><highlight class="comment">//<sp/>minimal<sp/>mixing<sp/>factor;<sp/>tiny<sp/>mixing<sp/>factors<sp/>guarantee<sp/>&quot;convergence&quot;<sp/>for<sp/>anything<sp/>and<sp/>make<sp/>the<sp/>result<sp/>totally<sp/>useless.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">assert</ref>((<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_ratio</ref><sp/>&gt;=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_minimum</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">and</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_ratio</ref><sp/>&lt;=<sp/>0.5)<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">or</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_ratio</ref><sp/>==<sp/>1.0);</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1ade72d4c0a25548ba8cb4c0dcd8950b65" kindref="member">SDE_counter</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;\t<sp/>---<sp/>Start<sp/>parquet<sp/>solver<sp/>---\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;Results<sp/>get<sp/>stored<sp/>in<sp/>&quot;</highlight><highlight class="normal">,<sp/>filename,<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/>std::deque&lt;State&lt;Q&gt;&gt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">rhs_evals</ref>;</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/>std::deque&lt;State&lt;Q&gt;&gt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">iteration_steps</ref>;</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/>std::deque&lt;double&gt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_deviation_history</ref>;</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Nmax_history</ref><sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">n_States_for_AndersonAcceleration</ref><sp/>=<sp/>4;</highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">overwrite_old_results</ref>)<sp/>{</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;Start<sp/>from<sp/>scratch.\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambda_it</ref><sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_converged</ref><sp/>=<sp/><ref refid="d5/d4f/hdf5__routines_8c_09_09_1a0f3795e3b03f3c010cc3befa1c153054" kindref="member">check_convergence_hdf</ref>(filename,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambda_it</ref>);</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_converged</ref><sp/>||<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">use_last_state_anyway</ref><sp/>&amp;&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambda_it</ref>))<sp/>{<sp/></highlight><highlight class="comment">//<sp/>load<sp/>last<sp/>result<sp/>and<sp/>break<sp/>if<sp/>result<sp/>is<sp/>converged<sp/>already<sp/>or<sp/>if<sp/>we<sp/>are<sp/>happy<sp/>with<sp/>any<sp/>parquet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>&quot;</highlight><highlight class="normal">,<sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">use_last_state_anyway</ref>?<sp/></highlight><highlight class="stringliteral">&quot;un&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">),<sp/></highlight><highlight class="stringliteral">&quot;<sp/>converged<sp/>parquet<sp/>result<sp/>from<sp/>file<sp/>(Lambda_it<sp/>=<sp/>&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambda_it</ref>,<sp/></highlight><highlight class="stringliteral">&quot;)<sp/>\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref><sp/>=<sp/><ref refid="d5/d4f/hdf5__routines_8c_09_09_1aa0ab8d27e7ed5ce3762582c2416a9b45" kindref="member">read_state_from_hdf</ref>(filename,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambda_it</ref>);</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambda_it</ref><sp/>&gt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>non-converged<sp/>parquet<sp/>result<sp/>from<sp/>file<sp/>(Lambda_it<sp/>=<sp/>&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambda_it</ref>,<sp/></highlight><highlight class="stringliteral">&quot;)<sp/>\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref><sp/>=<sp/><ref refid="d5/d4f/hdf5__routines_8c_09_09_1aa0ab8d27e7ed5ce3762582c2416a9b45" kindref="member">read_state_from_hdf</ref>(filename,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambda_it</ref>);</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="688"><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_adaptive</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_ratio</ref>;</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">trigger_adaptation</ref><sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//write_state_to_hdf(filename,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,<sp/>state_in);<sp/>//<sp/>save<sp/>input<sp/>into<sp/>0-th<sp/>layer<sp/>of<sp/>hdf5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" kindref="member">write_state_to_hdf</ref>(filename,<sp/>Lambda,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">trigger_adaptation</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>);<sp/></highlight><highlight class="comment">//<sp/>save<sp/>input<sp/>into<sp/>0-th<sp/>layer<sp/>of<sp/>hdf5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d4/dda/mpi__setup_8c_09_09_1a191972e98e51a56d90e8e5f750496c7d" kindref="member">mpi_world_rank</ref>()<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H5::H5File<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref><sp/>=<sp/><ref refid="d5/d4f/hdf5__routines_8c_09_09_1a924110dbdaccbbc744def3ca0838cb4c" kindref="member">open_hdf_file_readWrite</ref>(filename);</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">write_to_hdf_LambdaLayer&lt;double&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;mixing_parameter&quot;</highlight><highlight class="normal">,<sp/>std::vector&lt;double&gt;({<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_ratio</ref>}),<sp/>0,<sp/>Nmax<sp/>+<sp/>1,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>.close();</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d9/d2a/classvec" kindref="compound">rvec</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Lambdas</ref><sp/>(Nmax<sp/>+<sp/>1);<sp/><sp/></highlight><highlight class="comment">//<sp/>auxiliary<sp/>vector<sp/>needed<sp/>for<sp/>hdf5<sp/>routines<sp/>(empty<sp/>since<sp/>Lambda<sp/>is<sp/>constant)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>NDEBUG</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">write_state</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">write_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//write_state_to_hdf(data_dir<sp/>+<sp/>&quot;Parquet_GammaL&quot;,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>state_in);<sp/>//<sp/>save<sp/>input<sp/>into<sp/>0-th<sp/>layer<sp/>of<sp/>hdf5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//write_state_to_hdf(data_dir<sp/>+<sp/>&quot;Parquet_GammaR&quot;,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>state_in);<sp/>//<sp/>save<sp/>input<sp/>into<sp/>0-th<sp/>layer<sp/>of<sp/>hdf5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" kindref="member">write_state_to_hdf</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Psi_SDE_a.h5&quot;</highlight><highlight class="normal">,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" kindref="member">write_state_to_hdf</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Psi_SDE_p.h5&quot;</highlight><highlight class="normal">,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" kindref="member">write_state_to_hdf</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Psi_SDE_a_l.h5&quot;</highlight><highlight class="normal">,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" kindref="member">write_state_to_hdf</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Psi_SDE_a_r.h5&quot;</highlight><highlight class="normal">,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" kindref="member">write_state_to_hdf</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Psi_SDE_p_l.h5&quot;</highlight><highlight class="normal">,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1ab7f115126010e4b017eb9e12cd1c29d9" kindref="member">write_state_to_hdf</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Psi_SDE_p_r.h5&quot;</highlight><highlight class="normal">,<sp/>Lambda,<sp/>Nmax<sp/>+<sp/>1,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="715"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>lhs<sp/>of<sp/>the<sp/>parquet<sp/>equations</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d97/classState" kindref="compound">State&lt;Q&gt;</ref><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_diff</ref><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda);<sp/><sp/></highlight><highlight class="comment">//<sp/>difference<sp/>between<sp/>input<sp/>and<sp/>output<sp/>of<sp/>the<sp/>parquet<sp/>equations</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="718"><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iteration<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>first<sp/>check<sp/>if<sp/>converged,<sp/>and<sp/>also<sp/>stop<sp/>if<sp/>maximal<sp/>number<sp/>of<sp/>iterations<sp/>is<sp/>reached</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_converged</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">unfinished</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">unfinished</ref>)<sp/>{</highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d4a/classGeneralVertex" kindref="compound">GeneralVertex&lt;Q,symmetric_r_irred,false&gt;</ref><sp/>Ir(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex.half1());<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>irreducible<sp/>vertex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"></highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex.template<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">symmetry_expand&lt;&apos;a&apos;,false,true&gt;</ref>();</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>.vertex.save_expanded(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Psi_&quot;</highlight><highlight class="normal">+<sp/>std::to_string(iteration)<sp/>+</highlight><highlight class="stringliteral">&quot;_symmetry_expanded_for_a_left_&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ir.template<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">symmetry_expand&lt;&apos;a&apos;,true,true&gt;</ref>();</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ir.<ref refid="d2/d4a/classGeneralVertex_1aed220e3c9849b53e245e7062568b1b72" kindref="member">save_expanded</ref>(<ref refid="d1/df8/master__parameters_8hpp_1a1b384aea75d8da97c90c700d40dc19d2" kindref="member">data_dir</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Ir_&quot;</highlight><highlight class="normal"><sp/>+<sp/>std::to_string(iteration)<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_symmetry_expanded_for_a_left_&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="734"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>state_in.vertex.template<sp/>symmetry_expand&lt;&apos;p&apos;,false,true&gt;();</highlight></codeline>
<codeline lineno="735"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>state_in.vertex.save_expanded(data_dir<sp/>+<sp/>&quot;Psi_&quot;<sp/>+<sp/>std::to_string(iteration)<sp/>+<sp/>&quot;_symmetry_expanded_for_p_left_&quot;);</highlight></codeline>
<codeline lineno="736"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ir.template<sp/>symmetry_expand&lt;&apos;p&apos;,true,true&gt;();</highlight></codeline>
<codeline lineno="737"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ir.save_expanded(data_dir<sp/>+<sp/>&quot;Ir_&quot;<sp/>+<sp/>std::to_string(iteration)<sp/>+<sp/>&quot;_symmetry_expanded_for_p_left_&quot;);</highlight></codeline>
<codeline lineno="738"><highlight class="comment"></highlight></codeline>
<codeline lineno="739"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>state_in.vertex.template<sp/>symmetry_expand&lt;&apos;t&apos;,false,true&gt;();</highlight></codeline>
<codeline lineno="740"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>state_in.vertex.save_expanded(data_dir<sp/>+<sp/>&quot;Psi_&quot;<sp/>+<sp/>std::to_string(iteration)<sp/>+<sp/>&quot;_symmetry_expanded_for_t_left_&quot;);</highlight></codeline>
<codeline lineno="741"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ir.template<sp/>symmetry_expand&lt;&apos;t&apos;,true,true&gt;();</highlight></codeline>
<codeline lineno="742"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ir.save_expanded(data_dir<sp/>+<sp/>&quot;Ir_&quot;<sp/>+<sp/>std::to_string(iteration)<sp/>+<sp/>&quot;_symmetry_expanded_for_t_left_&quot;);</highlight></codeline>
<codeline lineno="743"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="745"><highlight class="normal"></highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">t_start</ref><sp/>=<sp/><ref refid="d6/d84/namespaceutils_1a4ae6ae93d2caa1fda9be0ce8f6b339ee" kindref="member">utils::get_time</ref>();</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;iteration<sp/>&quot;</highlight><highlight class="normal">,<sp/>iteration,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="748"><highlight class="normal"></highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1aad1680ae03adc0f566df945376e95234" kindref="member">parquet_iteration</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>,<sp/>Lambda,<sp/>iteration,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref>);<sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>lhs<sp/>of<sp/>parquet<sp/>equations</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>(iteration<sp/>==<sp/>1)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>for<sp/>(char<sp/>r<sp/>:<sp/>{&apos;a&apos;,<sp/>&apos;p&apos;,<sp/>&apos;t&apos;})<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>state_out.vertex.get_rvertex(r).K1<sp/>=<sp/>state_in.vertex.get_rvertex(r).K1;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//}</highlight></codeline>
<codeline lineno="757"><highlight class="preprocessor">#if<sp/>USE_ANDERSON_ACCELERATION</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">rhs_evals</ref>.push_back(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>);</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">iteration_steps</ref>.push_back(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>);</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">rhs_evals</ref>.size()<sp/>&gt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">n_States_for_AndersonAcceleration</ref>)<sp/>{</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">rhs_evals</ref>.pop_front();</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">iteration_steps</ref>.pop_front();</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref><sp/>=<sp/><ref refid="d6/d7b/anderson__acceleration_8hpp_1a88e79b4550a392a79d60d8bf6557461c" kindref="member">anderson_update</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">rhs_evals</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">iteration_steps</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_adaptive</ref>);</highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_ratio</ref><sp/>*<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref><sp/>+<sp/>(1-<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_ratio</ref>)<sp/>*<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref>;</highlight></codeline>
<codeline lineno="767"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d3f/sanity__check_8hpp_1a884fca24faf1e006b285fcce3ddd0299" kindref="member">sanity_check</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>);</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_diff</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref><sp/>-<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>difference<sp/>between<sp/>lhs<sp/>and<sp/>input<sp/>to<sp/>rhs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="770"><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>relative<sp/>differences<sp/>between<sp/>input<sp/>and<sp/>output<sp/>w.r.t.<sp/>output</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference_vertex</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_diff</ref>.vertex.norm()<sp/>/<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>.vertex.norm();</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference_selfenergy</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_diff</ref>.selfenergy.rel_deviation_to(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>.selfenergy);</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference</ref><sp/>=<sp/>std::max(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference_selfenergy</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference_vertex</ref>);</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_deviation_history</ref>.push_back(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference</ref>);</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(std::size(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_deviation_history</ref>)<sp/>&gt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">Nmax_history</ref>)<sp/>{<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_deviation_history</ref>.pop_front();}</highlight></codeline>
<codeline lineno="777"><highlight class="normal"></highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>whether<sp/>there<sp/>is<sp/>a<sp/>tendency<sp/>to<sp/>convergence.<sp/>If<sp/>not:<sp/>shrink<sp/>mixing<sp/>factor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iteration<sp/>%<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">trigger_adaptation</ref><sp/>==<sp/>0<sp/>&amp;&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_adaptive</ref><sp/>&gt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_minimum</ref><sp/>&amp;&amp;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_deviation_history</ref>[0]<sp/>&lt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_deviation_history</ref>.back())<sp/>{</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;MIXING<sp/>NOT<sp/>CAREFUL<sp/>ENOUGH!\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_deviation_history</ref>[0],<sp/></highlight><highlight class="stringliteral">&quot;\t<sp/>&lt;<sp/>\t&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_deviation_history</ref>.back(),<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_adaptive</ref><sp/>=<sp/>std::max(0.6*<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_adaptive</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_minimum</ref>);</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;New<sp/>mixing<sp/>parameter:\t&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_adaptive</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="784"><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="786"><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;relative<sp/>difference<sp/>vertex:<sp/><sp/><sp/><sp/><sp/>&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference_vertex</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;relative<sp/>difference<sp/>selfenergy:<sp/>&quot;</highlight><highlight class="normal">,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference_selfenergy</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_converged</ref><sp/>=<sp/>!(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference_vertex</ref><sp/>&gt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">accuracy</ref><sp/>||<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">relative_difference_selfenergy</ref><sp/>&gt;<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">accuracy</ref>);</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">unfinished</ref><sp/>=<sp/>!<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_converged</ref><sp/>&amp;&amp;<sp/>iteration<sp/>&lt;<sp/>Nmax;</highlight></codeline>
<codeline lineno="791"><highlight class="normal"></highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/de4/hdf5__routines_8hpp_1afcbe2c8a768f64e576f593516262d476" kindref="member">add_state_to_hdf</ref>(filename,<sp/>iteration%<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">trigger_adaptation</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>,<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_converged</ref>);<sp/><sp/></highlight><highlight class="comment">//<sp/>store<sp/>result<sp/>into<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//write_state_to_hdf(filename,<sp/>Lambda,<sp/>1,<sp/>state_in,<sp/>false,<sp/>is_converged);<sp/>//<sp/>save<sp/>input<sp/>into<sp/>0-th<sp/>layer<sp/>of<sp/>hdf5<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d4/dda/mpi__setup_8c_09_09_1a191972e98e51a56d90e8e5f750496c7d" kindref="member">mpi_world_rank</ref>()<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>H5::H5File<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref><sp/>=<sp/><ref refid="d5/d4f/hdf5__routines_8c_09_09_1a924110dbdaccbbc744def3ca0838cb4c" kindref="member">open_hdf_file_readWrite</ref>(filename);</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">write_to_hdf_LambdaLayer&lt;double&gt;</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>,<sp/></highlight><highlight class="stringliteral">&quot;mixing_parameter&quot;</highlight><highlight class="normal">,<sp/>std::vector&lt;double&gt;({<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">mixing_adaptive</ref>}),<sp/>iteration%<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">trigger_adaptation</ref>,<sp/>Nmax<sp/>+<sp/>1,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">file_out</ref>.close();</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_in</ref><sp/>=<sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">state_out</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>use<sp/>output<sp/>as<sp/>input<sp/>for<sp/>next<sp/>iteration</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="801"><highlight class="normal"></highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1ad566cc1586ac4598d5823caa71620eb5" kindref="member">utils::print</ref>(</highlight><highlight class="stringliteral">&quot;Time<sp/>needed<sp/>for<sp/>parquet<sp/>iteration:<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d84/namespaceutils_1a4ae6ae93d2caa1fda9be0ce8f6b339ee" kindref="member">utils::get_time</ref>(<ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">t_start</ref>);</highlight></codeline>
<codeline lineno="804"><highlight class="normal"></highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++iteration;</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">is_converged</ref>;</highlight></codeline>
<codeline lineno="808"><highlight class="normal">}</highlight></codeline>
<codeline lineno="809"><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal"></highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dd/d0a/parquet__solver_8hpp_1aa85025687bc343bc18b36d929a335ef4" kindref="member">run_parquet</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="da/da0/structfRG__config" kindref="compound">fRG_config</ref>&amp;<sp/>config,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;double&gt;&amp;,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">version</ref>,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="dd/dea/bubble__corrections_8hpp_1aff27784f97591f505f77ff0065ab57af" kindref="member">overwrite_old_results</ref>);</highlight></codeline>
<codeline lineno="812"><highlight class="normal"></highlight></codeline>
<codeline lineno="813"><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">//KELDYSH_MFRG_TESTING_PARQUET_CHECKS_H</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="perturbation_theory_and_parquet/parquet_solver.hpp"/>
  </compounddef>
</doxygen>
